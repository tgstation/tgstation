<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/machinery - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/machinery.html#var">Var Details</a> - <a href="obj/machinery.html#proc">Proc Details</a></header><main><h1>machinery <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L87"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 87"></a></h1><p>Machines in the world, such as computers, pipes, and airlocks.</p>
<p>Overview:
Used to create objects that need a per step proc call.  Default definition of 'Initialize()'
stores a reference to src machine in global 'machines list'.  Default definition
of 'Destroy' removes reference to src machine in global 'machines list'.</p>
<p>Class Variables:
use_power (num)
current state of auto power use.
Possible Values:
NO_POWER_USE -- no auto power use
IDLE_POWER_USE -- machine is using power at its idle power level
ACTIVE_POWER_USE -- machine is using power at its active power level</p>
<p>active_power_usage (num)
Value for the amount of power to use when in active power mode</p>
<p>idle_power_usage (num)
Value for the amount of power to use when in idle power mode</p>
<p>power_channel (num)
What channel to draw from when drawing power for power mode
Possible Values:
AREA_USAGE_EQUIP:1 -- Equipment Channel
AREA_USAGE_LIGHT:2 -- Lighting Channel
AREA_USAGE_ENVIRON:3 -- Environment Channel</p>
<p>component_parts (list)
A list of component parts of machine used by frame based machines.</p>
<p>stat (bitflag)
Machine status bit flags.
Possible bit flags:
BROKEN -- Machine is broken
NOPOWER -- No power is being supplied to machine.
MAINT -- machine is currently under going maintenance.
EMPED -- temporary broken by EMP pulse</p>
<p>Class Procs:
Initialize()</p>
<p>Destroy()</p>
<pre><code>update_mode_power_usage()
	updates the static_power_usage var of this machine and makes its static power usage from its area accurate.
	called after the idle or active power usage has been changed.

update_power_channel()
	updates the static_power_usage var of this machine and makes its static power usage from its area accurate.
	called after the power_channel var has been changed or called to change the var itself.

unset_static_power()
	completely removes the current static power usage of this machine from its area.
	used in the other power updating procs to then readd the correct power usage.


 Default definition uses 'use_power', 'power_channel', 'active_power_usage',
 'idle_power_usage', 'powered()', and 'use_energy()' implement behavior.
</code></pre>
<p>powered(chan = -1)         'modules/power/power.dm'
Checks to see if area that contains the object has power available for power
channel given in 'chan'. -1 defaults to power_channel</p>
<p>use_energy(amount, chan=-1)   'modules/power/power.dm'
Deducts 'amount' from the power channel 'chan' of the area that contains the object.</p>
<p>power_change()               'modules/power/power.dm'
Called by the area that contains the object when ever that area under goes a
power state change (area runs out of power, or area channel is turned off).</p>
<p>RefreshParts()               'game/machinery/machine.dm'
Called to refresh the variables in the machine that are contributed to by parts
contained in the component_parts list. (example: glass and material amounts for
the autolathe)</p>
<pre><code> Default definition does nothing.
</code></pre>
<p>process()                  'game/machinery/machine.dm'
Called by the 'machinery subsystem' once per machinery tick for each machine that is listed in its 'machines' list.</p>
<p>process_atmos()
Called by the 'air subsystem' once per atmos tick for each machine that is listed in its 'atmos_machines' list.
Compiled by Aygar</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/machinery.html#var/active_power_usage">active_power_usage</a></th><td>the amount of static power load this machine adds to its area's power_usage list when use_power = ACTIVE_POWER_USE</td></tr><tr><th><a href="obj/machinery.html#var/always_area_sensitive">always_area_sensitive</a></th><td>Do we want to hook into on_enter_area and on_exit_area?
Disables some optimizations</td></tr><tr><th><a href="obj/machinery.html#var/appearance_power_state">appearance_power_state</a></th><td>What was our power state the last time we updated its appearance?
TRUE for on, FALSE for off, -1 for never checked</td></tr><tr><th><a href="obj/machinery.html#var/atmos_processing">atmos_processing</a></th><td>Is this machine currently in the atmos machinery queue?</td></tr><tr><th><a href="obj/machinery.html#var/circuit">circuit</a></th><td>Circuit to be created and inserted when the machinery is created</td></tr><tr><th><a href="obj/machinery.html#var/component_parts">component_parts</a></th><td>list of all the parts used to build it, if made from certain kinds of frames.</td></tr><tr><th><a href="obj/machinery.html#var/critical_machine">critical_machine</a></th><td>If this machine is critical to station operation and should have the area be excempted from power failures.</td></tr><tr><th><a href="obj/machinery.html#var/fair_market_price">fair_market_price</a></th><td>Used in NAP violation, pay fine</td></tr><tr><th><a href="obj/machinery.html#var/idle_power_usage">idle_power_usage</a></th><td>the amount of static power load this machine adds to its area's power_usage list when use_power = IDLE_POWER_USE</td></tr><tr><th><a href="obj/machinery.html#var/interaction_flags_machine">interaction_flags_machine</a></th><td>See code/DEFINES/interaction_flags.dm</td></tr><tr><th><a href="obj/machinery.html#var/is_operational">is_operational</a></th><td>A combination of factors such as having power, not being broken and so on. Boolean.</td></tr><tr><th><a href="obj/machinery.html#var/last_used_time">last_used_time</a></th><td>world.time of last use by <a href="mob/living.html" title="/mob/living">/mob/living</a></td></tr><tr><th><a href="obj/machinery.html#var/last_user_mobtype">last_user_mobtype</a></th><td>Mobtype of last user. Typecast to <a href="mob/living.html" title="/mob/living">/mob/living</a> for initial() usage</td></tr><tr><th><a href="obj/machinery.html#var/machine_stat">machine_stat</a></th><td>see code/__DEFINES/stat.dm</td></tr><tr><th><a href="obj/machinery.html#var/occupant">occupant</a></th><td>The mob that is sealed inside the machine</td></tr><tr><th><a href="obj/machinery.html#var/occupant_typecache">occupant_typecache</a></th><td>if set, turned into typecache in Initialize, other wise, defaults to mob/living typecache</td></tr><tr><th><a href="obj/machinery.html#var/panel_open">panel_open</a></th><td>Is the machines maintenance panel open.</td></tr><tr><th><a href="obj/machinery.html#var/payment_department">payment_department</a></th><td>The department we are paying to use this machine</td></tr><tr><th><a href="obj/machinery.html#var/processing_flags">processing_flags</a></th><td>Viable flags to go here are START_PROCESSING_ON_INIT, or START_PROCESSING_MANUALLY. See code__DEFINES\machines.dm for more information on these flags.</td></tr><tr><th><a href="obj/machinery.html#var/state_open">state_open</a></th><td>Is the machine open or closed</td></tr><tr><th><a href="obj/machinery.html#var/static_power_usage">static_power_usage</a></th><td>the current amount of static power usage this machine is taking from its area</td></tr><tr><th><a href="obj/machinery.html#var/subsystem_type">subsystem_type</a></th><td>What subsystem this machine will use, which is generally SSmachines or SSfastprocess. By default all machinery use SSmachines. This fires a machine's process() roughly every 2 seconds.</td></tr><tr><th><a href="obj/machinery.html#var/use_power">use_power</a></th><td>see code/__DEFINES/machines.dm</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/machinery.html#proc/AI_notify_hack">AI_notify_hack</a></th><td>Alerts the AI that a hack is in progress.</td></tr><tr><th><a href="obj/machinery.html#proc/New">New</a></th><td>Needed by machine frame &amp; flatpacker i.e the named arg board</td></tr><tr><th><a href="obj/machinery.html#proc/add_as_sabotage_target">add_as_sabotage_target</a></th><td>Called if this machine is supposed to be a sabotage machine objective.</td></tr><tr><th><a href="obj/machinery.html#proc/available_energy">available_energy</a></th><td>Returns the available energy from the apc's cell and grid that can be used.
Args:</td></tr><tr><th><a href="obj/machinery.html#proc/begin_processing">begin_processing</a></th><td>Helper proc for telling a machine to start processing</td></tr><tr><th><a href="obj/machinery.html#proc/charge_cell">charge_cell</a></th><td>Draws power from the apc's powernet and cell to charge a power cell.
Args:</td></tr><tr><th><a href="obj/machinery.html#proc/clear_components">clear_components</a></th><td>This should be called before mass qdeling components to make space for replacements.
If not done, things will go awry as Exited() destroys the machine when it detects
even a single component exiting the atom.</td></tr><tr><th><a href="obj/machinery.html#proc/directly_use_energy">directly_use_energy</a></th><td>An alternative to 'use_power', this proc directly costs the APC in direct charge, as opposed to prioritising the grid.
Args:</td></tr><tr><th><a href="obj/machinery.html#proc/dump_contents">dump_contents</a></th><td>Drop every movable atom in the machine's contents list, including any components and circuit.</td></tr><tr><th><a href="obj/machinery.html#proc/dump_inventory_contents">dump_inventory_contents</a></th><td>Drop every movable atom in the machine's contents list that is not a component_part.</td></tr><tr><th><a href="obj/machinery.html#proc/end_processing">end_processing</a></th><td>Helper proc for telling a machine to stop processing</td></tr><tr><th><a href="obj/machinery.html#proc/get_room_area">get_room_area</a></th><td>Get a valid powered area to reference for power use, mainly for wall-mounted machinery that isn't always mapped directly in a powered location.</td></tr><tr><th><a href="obj/machinery.html#proc/on_deconstruction">on_deconstruction</a></th><td>called on deconstruction before the final deletion
Arguments</td></tr><tr><th><a href="obj/machinery.html#proc/on_set_is_operational">on_set_is_operational</a></th><td>Called when the value of <code>is_operational</code> changes, so we can react to it.</td></tr><tr><th><a href="obj/machinery.html#proc/on_set_machine_stat">on_set_machine_stat</a></th><td>Called when the value of <code>machine_stat</code> changes, so we can react to it.</td></tr><tr><th><a href="obj/machinery.html#proc/on_set_panel_open">on_set_panel_open</a></th><td>Called when the value of <code>panel_open</code> changes, so we can react to it.</td></tr><tr><th><a href="obj/machinery.html#proc/open_machine">open_machine</a></th><td>Opens the machine.</td></tr><tr><th><a href="obj/machinery.html#proc/post_machine_initialize">post_machine_initialize</a></th><td>Called in LateInitialize meant to be the machine replacement to it
This sets up power for the machine and requires parent be called,
ensuring power works on all machines unless exempted with NO_POWER_USE.
This is the proc to override if you want to do anything in LateInitialize.</td></tr><tr><th><a href="obj/machinery.html#proc/power_change">power_change</a></th><td>Called whenever the power settings of the containing area change</td></tr><tr><th><a href="obj/machinery.html#proc/process_atmos">process_atmos</a></th><td>Process but for machines interacting with atmospherics.
Like process, anything sensitive to changes in the wait time between process ticks should account for seconds_per_tick.</td></tr><tr><th><a href="obj/machinery.html#proc/process_early">process_early</a></th><td>Early process for machines added to SSmachines.processing_early to prioritize power draw</td></tr><tr><th><a href="obj/machinery.html#proc/process_late">process_late</a></th><td>Late process for machines added to SSmachines.processing_late to gather accurate recordings</td></tr><tr><th><a href="obj/machinery.html#proc/remove_area_power_relationship">remove_area_power_relationship</a></th><td>proc to call when the machine stops requiring power after a duration of requiring power
saves memory by removing the power relationship with its area if it exists and loses area sensitivity
does not affect power usage itself</td></tr><tr><th><a href="obj/machinery.html#proc/set_is_operational">set_is_operational</a></th><td>Called when we want to change the value of the <code>is_operational</code> variable. Boolean.</td></tr><tr><th><a href="obj/machinery.html#proc/set_machine_stat">set_machine_stat</a></th><td>Called when we want to change the value of the machine_stat variable. Holds bitflags.</td></tr><tr><th><a href="obj/machinery.html#proc/set_panel_open">set_panel_open</a></th><td>Called when we want to change the value of the <code>panel_open</code> variable. Boolean.</td></tr><tr><th><a href="obj/machinery.html#proc/setup_area_power_relationship">setup_area_power_relationship</a></th><td>proc to call when the machine starts to require power after a duration of not requiring power
sets up power related connections to its area if it exists and becomes area sensitive
does not affect power usage itself</td></tr><tr><th><a href="obj/machinery.html#proc/spawn_frame">spawn_frame</a></th><td>Spawns a frame where this machine is. If the machine was not disassmbled, the
frame is spawned damaged. If the frame couldn't exist on this turf, it's smashed
down to metal sheets.</td></tr><tr><th><a href="obj/machinery.html#proc/toggle_panel_open">toggle_panel_open</a></th><td>Toggles the panel_open var. Defined for convienience</td></tr><tr><th><a href="obj/machinery.html#proc/try_put_in_hand">try_put_in_hand</a></th><td>Puts passed object in to user's hand</td></tr><tr><th><a href="obj/machinery.html#proc/unset_static_power">unset_static_power</a></th><td>internal proc that removes all static power usage from the current area</td></tr><tr><th><a href="obj/machinery.html#proc/update_current_power_usage">update_current_power_usage</a></th><td>makes this machine draw power from its area according to which use_power mode it is set to</td></tr><tr><th><a href="obj/machinery.html#proc/update_mode_power_usage">update_mode_power_usage</a></th><td>sets the power_usage linked to the specified use_power_mode to new_usage
e.g. update_mode_power_usage(ACTIVE_POWER_USE, 10) sets active_power_use = 10 and updates its power draw from the machines area if use_power == ACTIVE_POWER_USE</td></tr><tr><th><a href="obj/machinery.html#proc/update_power_channel">update_power_channel</a></th><td>updates the power channel this machine uses. removes the static power usage from the old channel and readds it to the new channel</td></tr><tr><th><a href="obj/machinery.html#proc/update_use_power">update_use_power</a></th><td>updates the use_power var for this machine and updates its static power usage from its area to reflect the new value</td></tr><tr><th><a href="obj/machinery.html#proc/use_energy">use_energy</a></th><td>Draws energy from the APC. Will use excess energy from the APC's connected grid,
then use energy from the APC's cell if there wasn't enough energy from the grid, unless ignore_apc is true.
Args:</td></tr><tr><th><a href="obj/machinery.html#proc/use_power_from_net">use_power_from_net</a></th><td>Attempts to draw power directly from the APC's Powernet rather than the APC's battery. For high-draw machines, like the cell charger</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active_power_usage"><aside class="declaration">var </aside>active_power_usage <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L113"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 113"></a></h3><p>the amount of static power load this machine adds to its area's power_usage list when use_power = ACTIVE_POWER_USE</p><h3 id="var/always_area_sensitive"><aside class="declaration">var </aside>always_area_sensitive <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L152"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 152"></a></h3><p>Do we want to hook into on_enter_area and on_exit_area?
Disables some optimizations</p><h3 id="var/appearance_power_state"><aside class="declaration">var </aside>appearance_power_state <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L155"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 155"></a></h3><p>What was our power state the last time we updated its appearance?
TRUE for on, FALSE for off, -1 for never checked</p><h3 id="var/atmos_processing"><aside class="declaration">var </aside>atmos_processing <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L145"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 145"></a></h3><p>Is this machine currently in the atmos machinery queue?</p><h3 id="var/circuit"><aside class="declaration">var </aside>circuit <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/circuitboard.html">circuitboard</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L137"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 137"></a></h3><p>Circuit to be created and inserted when the machinery is created</p><h3 id="var/component_parts"><aside class="declaration">var </aside>component_parts <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L121"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 121"></a></h3><p>list of all the parts used to build it, if made from certain kinds of frames.</p><h3 id="var/critical_machine"><aside class="declaration">var </aside>critical_machine <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L127"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 127"></a></h3><p>If this machine is critical to station operation and should have the area be excempted from power failures.</p><h3 id="var/fair_market_price"><aside class="declaration">var </aside>fair_market_price <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L143"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 143"></a></h3><p>Used in NAP violation, pay fine</p><h3 id="var/idle_power_usage"><aside class="declaration">var </aside>idle_power_usage <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L111"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 111"></a></h3><p>the amount of static power load this machine adds to its area's power_usage list when use_power = IDLE_POWER_USE</p><h3 id="var/interaction_flags_machine"><aside class="declaration">var </aside>interaction_flags_machine <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L139"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 139"></a></h3><p>See code/DEFINES/interaction_flags.dm</p><h3 id="var/is_operational"><aside class="declaration">var </aside>is_operational <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L119"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 119"></a></h3><p>A combination of factors such as having power, not being broken and so on. Boolean.</p><h3 id="var/last_used_time"><aside class="declaration">var </aside>last_used_time <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L147"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 147"></a></h3><p>world.time of last use by <a href="mob/living.html" title="/mob/living">/mob/living</a></p><h3 id="var/last_user_mobtype"><aside class="declaration">var </aside>last_user_mobtype <aside>– /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L149"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 149"></a></h3><p>Mobtype of last user. Typecast to <a href="mob/living.html" title="/mob/living">/mob/living</a> for initial() usage</p><h3 id="var/machine_stat"><aside class="declaration">var </aside>machine_stat <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L107"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 107"></a></h3><p>see code/__DEFINES/stat.dm</p><h3 id="var/occupant"><aside class="declaration">var </aside>occupant <aside>– /<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L131"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 131"></a></h3><p>The mob that is sealed inside the machine</p><h3 id="var/occupant_typecache"><aside class="declaration">var </aside>occupant_typecache <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L129"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 129"></a></h3><p>if set, turned into typecache in Initialize, other wise, defaults to mob/living typecache</p><h3 id="var/panel_open"><aside class="declaration">var </aside>panel_open <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L123"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 123"></a></h3><p>Is the machines maintenance panel open.</p><h3 id="var/payment_department"><aside class="declaration">var </aside>payment_department <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L141"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 141"></a></h3><p>The department we are paying to use this machine</p><h3 id="var/processing_flags"><aside class="declaration">var </aside>processing_flags <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L133"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 133"></a></h3><p>Viable flags to go here are START_PROCESSING_ON_INIT, or START_PROCESSING_MANUALLY. See code__DEFINES\machines.dm for more information on these flags.</p><h3 id="var/state_open"><aside class="declaration">var </aside>state_open <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L125"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 125"></a></h3><p>Is the machine open or closed</p><h3 id="var/static_power_usage"><aside class="declaration">var </aside>static_power_usage <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L115"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 115"></a></h3><p>the current amount of static power usage this machine is taking from its area</p><h3 id="var/subsystem_type"><aside class="declaration">var </aside>subsystem_type <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L135"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 135"></a></h3><p>What subsystem this machine will use, which is generally SSmachines or SSfastprocess. By default all machinery use SSmachines. This fires a machine's process() roughly every 2 seconds.</p><h3 id="var/use_power"><aside class="declaration">var </aside>use_power <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L109"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 109"></a></h3><p>see code/__DEFINES/machines.dm</p><h2 id="proc">Proc Details</h2><h3 id="proc/AI_notify_hack"><aside class="declaration">proc </aside>AI_notify_hack<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L1223"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 1223"></a></aside></h3><p>Alerts the AI that a hack is in progress.</p>
<p>Sends all AIs a message that a hack is occurring.  Specifically used for space ninja tampering as this proc was originally in the ninja files.
However, the proc may also be used elsewhere.</p><h3 id="proc/New"><aside class="parent"><a title="/atom" href="atom.html#proc/New">↑</a></aside>New<aside>(location, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/circuitboard.html">circuitboard</a>/board, ...)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L165"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 165"></a></aside></h3><p>Needed by machine frame &amp; flatpacker i.e the named arg board</p><h3 id="proc/add_as_sabotage_target"><aside class="declaration">proc </aside>add_as_sabotage_target<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L1234"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 1234"></a></aside></h3><p>Called if this machine is supposed to be a sabotage machine objective.</p><h3 id="proc/available_energy"><aside class="declaration">proc </aside>available_energy<aside>(consider_cell)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/power/power.dm#L135"><img src="git.png" width="16" height="16" title="code/modules/power/power.dm 135"></a></aside></h3><p>Returns the available energy from the apc's cell and grid that can be used.
Args:</p>
<ul>
<li>consider_cell: Whether to count the energy from the APC's cell or not.
Returns: The available energy the machine can access from the APC.</li>
</ul><h3 id="proc/begin_processing"><aside class="declaration">proc </aside>begin_processing<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L292"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 292"></a></aside></h3><p>Helper proc for telling a machine to start processing</p><h3 id="proc/charge_cell"><aside class="declaration">proc </aside>charge_cell<aside>(amount, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/stock_parts.html">stock_parts</a>/<a href="obj/item/stock_parts/power_store.html">power_store</a>/cell, grid_only, channel)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/power/power.dm#L253"><img src="git.png" width="16" height="16" title="code/modules/power/power.dm 253"></a></aside></h3><p>Draws power from the apc's powernet and cell to charge a power cell.
Args:</p>
<ul>
<li>amount: The amount of energy given to the cell.</li>
<li>cell: The cell to charge.</li>
<li>grid_only: If true, only draw from the grid and ignore the APC's cell.</li>
<li>channel: The power channel to use.
Returns: The amount of energy the cell received.</li>
</ul><h3 id="proc/clear_components"><aside class="declaration">proc </aside>clear_components<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L964"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 964"></a></aside></h3><p>This should be called before mass qdeling components to make space for replacements.
If not done, things will go awry as Exited() destroys the machine when it detects
even a single component exiting the atom.</p><h3 id="proc/directly_use_energy"><aside class="declaration">proc </aside>directly_use_energy<aside>(amount, force)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/power/power.dm#L196"><img src="git.png" width="16" height="16" title="code/modules/power/power.dm 196"></a></aside></h3><p>An alternative to 'use_power', this proc directly costs the APC in direct charge, as opposed to prioritising the grid.
Args:</p>
<ul>
<li>amount: How much energy the APC's cell is to be costed.</li>
<li>force: If true, consumes the remaining energy of the cell if there isn't enough energy to supply the demand.
Returns: The amount of energy that got used by the cell.</li>
</ul><h3 id="proc/dump_contents">dump_contents<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L378"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 378"></a></aside></h3><p>Drop every movable atom in the machine's contents list, including any components and circuit.</p><h3 id="proc/dump_inventory_contents"><aside class="declaration">proc </aside>dump_inventory_contents<aside>(/list/subset)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L401"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 401"></a></aside></h3><p>Drop every movable atom in the machine's contents list that is not a component_part.</p>
<p>Proc does not drop components and will skip over anything in the component_parts list.
Call dump_contents() to drop all contents including components.
Arguments:</p>
<ul>
<li>subset - If this is not null, only atoms that are also contained within the subset list will be dropped.</li>
</ul><h3 id="proc/end_processing"><aside class="declaration">proc </aside>end_processing<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L297"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 297"></a></aside></h3><p>Helper proc for telling a machine to stop processing</p><h3 id="proc/get_room_area"><aside class="declaration">proc </aside>get_room_area<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L559"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 559"></a></aside></h3><p>Get a valid powered area to reference for power use, mainly for wall-mounted machinery that isn't always mapped directly in a powered location.</p><h3 id="proc/on_deconstruction"><aside class="declaration">proc </aside>on_deconstruction<aside>(disassembled)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L1179"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 1179"></a></aside></h3><p>called on deconstruction before the final deletion
Arguments</p>
<ul>
<li>disassembled - if TRUE means we used tools to deconstruct it, FALSE means it got destroyed by other means</li>
</ul><h3 id="proc/on_set_is_operational"><aside class="declaration">proc </aside>on_set_is_operational<aside>(old_value)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L612"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 612"></a></aside></h3><p>Called when the value of <code>is_operational</code> changes, so we can react to it.</p><h3 id="proc/on_set_machine_stat"><aside class="declaration">proc </aside>on_set_machine_stat<aside>(old_value)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L334"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 334"></a></aside></h3><p>Called when the value of <code>machine_stat</code> changes, so we can react to it.</p><h3 id="proc/on_set_panel_open"><aside class="declaration">proc </aside>on_set_panel_open<aside>(old_value)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L628"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 628"></a></aside></h3><p>Called when the value of <code>panel_open</code> changes, so we can react to it.</p><h3 id="proc/open_machine"><aside class="declaration">proc </aside>open_machine<aside>(drop, density_to_set)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L368"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 368"></a></aside></h3><p>Opens the machine.</p>
<p>Will update the machine icon and any user interfaces currently open.
Arguments:</p>
<ul>
<li>drop - Boolean. Whether to drop any stored items in the machine. Does not include components.</li>
<li>density - Boolean. Whether to make the object dense when it's open.</li>
</ul><h3 id="proc/post_machine_initialize"><aside class="declaration">proc </aside>post_machine_initialize<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L208"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 208"></a></aside></h3><p>Called in LateInitialize meant to be the machine replacement to it
This sets up power for the machine and requires parent be called,
ensuring power works on all machines unless exempted with NO_POWER_USE.
This is the proc to override if you want to do anything in LateInitialize.</p><h3 id="proc/power_change"><aside class="declaration">proc </aside>power_change<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/power/power.dm#L273"><img src="git.png" width="16" height="16" title="code/modules/power/power.dm 273"></a></aside></h3><p>Called whenever the power settings of the containing area change</p>
<p>by default, check equipment channel &amp; set flag, can override if needed</p>
<p>Returns TRUE if the NOPOWER flag was toggled</p><h3 id="proc/process_atmos"><aside class="declaration">proc </aside>process_atmos<aside>(seconds_per_tick)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L318"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 318"></a></aside></h3><p>Process but for machines interacting with atmospherics.
Like process, anything sensitive to changes in the wait time between process ticks should account for seconds_per_tick.</p><h3 id="proc/process_early"><aside class="declaration">proc </aside>process_early<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L302"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 302"></a></aside></h3><p>Early process for machines added to SSmachines.processing_early to prioritize power draw</p><h3 id="proc/process_late"><aside class="declaration">proc </aside>process_late<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L310"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 310"></a></aside></h3><p>Late process for machines added to SSmachines.processing_late to gather accurate recordings</p><h3 id="proc/remove_area_power_relationship"><aside class="declaration">proc </aside>remove_area_power_relationship<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L256"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 256"></a></aside></h3><p>proc to call when the machine stops requiring power after a duration of requiring power
saves memory by removing the power relationship with its area if it exists and loses area sensitivity
does not affect power usage itself</p><h3 id="proc/set_is_operational"><aside class="declaration">proc </aside>set_is_operational<aside>(new_value)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L601"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 601"></a></aside></h3><p>Called when we want to change the value of the <code>is_operational</code> variable. Boolean.</p><h3 id="proc/set_machine_stat"><aside class="declaration">proc </aside>set_machine_stat<aside>(new_value)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L323"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 323"></a></aside></h3><p>Called when we want to change the value of the machine_stat variable. Holds bitflags.</p><h3 id="proc/set_panel_open"><aside class="declaration">proc </aside>set_panel_open<aside>(new_value)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L618"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 618"></a></aside></h3><p>Called when we want to change the value of the <code>panel_open</code> variable. Boolean.</p><h3 id="proc/setup_area_power_relationship"><aside class="declaration">proc </aside>setup_area_power_relationship<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L238"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 238"></a></aside></h3><p>proc to call when the machine starts to require power after a duration of not requiring power
sets up power related connections to its area if it exists and becomes area sensitive
does not affect power usage itself</p>
<p>Returns TRUE if it triggered a full registration, FALSE otherwise
We do this so machinery that want to sidestep the area sensitiveity optimization can</p><h3 id="proc/spawn_frame"><aside class="declaration">proc </aside>spawn_frame<aside>(disassembled)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L904"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 904"></a></aside></h3><p>Spawns a frame where this machine is. If the machine was not disassmbled, the
frame is spawned damaged. If the frame couldn't exist on this turf, it's smashed
down to metal sheets.</p>
<p>Arguments:</p>
<ul>
<li>disassembled - If FALSE, the machine was destroyed instead of disassembled and the frame spawns at reduced integrity.</li>
</ul><h3 id="proc/toggle_panel_open"><aside class="declaration">proc </aside>toggle_panel_open<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L634"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 634"></a></aside></h3><p>Toggles the panel_open var. Defined for convienience</p><h3 id="proc/try_put_in_hand"><aside class="declaration">proc </aside>try_put_in_hand<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/object, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L429"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 429"></a></aside></h3><p>Puts passed object in to user's hand</p>
<p>Puts the passed object in to the users hand if they are adjacent.
If the user is not adjacent then place the object on top of the machine.</p>
<p>Vars:</p>
<ul>
<li>object (obj) The object to be moved in to the users hand.</li>
<li>user (mob/living) The user to recive the object</li>
</ul><h3 id="proc/unset_static_power"><aside class="declaration">proc </aside>unset_static_power<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L513"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 513"></a></aside></h3><p>internal proc that removes all static power usage from the current area</p><h3 id="proc/update_current_power_usage"><aside class="declaration">proc </aside>update_current_power_usage<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L579"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 579"></a></aside></h3><p>makes this machine draw power from its area according to which use_power mode it is set to</p><h3 id="proc/update_mode_power_usage"><aside class="declaration">proc </aside>update_mode_power_usage<aside>(use_power_mode, new_usage)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L534"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 534"></a></aside></h3><p>sets the power_usage linked to the specified use_power_mode to new_usage
e.g. update_mode_power_usage(ACTIVE_POWER_USE, 10) sets active_power_use = 10 and updates its power draw from the machines area if use_power == ACTIVE_POWER_USE</p>
<p>Arguments:</p>
<ul>
<li>use_power_mode - the use_power power mode to change. if IDLE_POWER_USE changes idle_power_usage, ACTIVE_POWER_USE changes active_power_usage</li>
<li>new_usage - the new value to set the specified power mode var to</li>
</ul><h3 id="proc/update_power_channel"><aside class="declaration">proc </aside>update_power_channel<aside>(new_power_channel)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L496"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 496"></a></aside></h3><p>updates the power channel this machine uses. removes the static power usage from the old channel and readds it to the new channel</p><h3 id="proc/update_use_power"><aside class="declaration">proc </aside>update_use_power<aside>(new_use_power)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/machinery/_machinery.dm#L466"><img src="git.png" width="16" height="16" title="code/game/machinery/_machinery.dm 466"></a></aside></h3><p>updates the use_power var for this machine and updates its static power usage from its area to reflect the new value</p><h3 id="proc/use_energy"><aside class="declaration">proc </aside>use_energy<aside>(amount, channel, ignore_apc, force)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/power/power.dm#L159"><img src="git.png" width="16" height="16" title="code/modules/power/power.dm 159"></a></aside></h3><p>Draws energy from the APC. Will use excess energy from the APC's connected grid,
then use energy from the APC's cell if there wasn't enough energy from the grid, unless ignore_apc is true.
Args:</p>
<ul>
<li>amount: The amount of energy to use.</li>
<li>channel: The power channel to use.</li>
<li>ignore_apc: If true, do not consider the APC's cell when demanding energy.</li>
<li>force: If true and if there isn't enough energy, consume the remaining energy. Returns 0 if false and there isn't enough energy.
Returns: The amount of energy used.</li>
</ul><h3 id="proc/use_power_from_net"><aside class="declaration">proc </aside>use_power_from_net<aside>(amount, take_any)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/power/power.dm#L220"><img src="git.png" width="16" height="16" title="code/modules/power/power.dm 220"></a></aside></h3><p>Attempts to draw power directly from the APC's Powernet rather than the APC's battery. For high-draw machines, like the cell charger</p>
<p>Checks the surplus power on the APC's powernet, and compares to the requested amount. If the requested amount is available, this proc
will add the amount to the APC's usage and return that amount. Otherwise, this proc will return FALSE.
If the take_any var arg is set to true, this proc will use and return any surplus that is under the requested amount, assuming that
the surplus is above zero.
Args:</p>
<ul>
<li>amount, the amount of power requested from the powernet. In joules.</li>
<li>take_any, a bool of whether any amount of power is acceptable, instead of all or nothing. Defaults to FALSE</li>
</ul></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>