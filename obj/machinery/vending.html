<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/machinery/vending - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/machinery/vending.html#var">Var Details</a> - <a href="obj/machinery/vending.html#proc">Proc Details</a></header><main><h1>vending machines <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/vending.html">vending</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L36"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 36"></a></h1><p>Captalism in the year 2525, everything in a vending machine, even love</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/machinery/vending.html#var/ad_list">ad_list</a></th><td>List of ads built from product_ads upon Iniitialize()</td></tr><tr><th><a href="obj/machinery/vending.html#var/age_restrictions">age_restrictions</a></th><td>Whether our age check is currently functional</td></tr><tr><th><a href="obj/machinery/vending.html#var/all_products_free">all_products_free</a></th><td>If this is set to TRUE, all products sold by the vending machine are free (cost nothing).
If unset, this will get automatically set to TRUE during init if the machine originates from off-station during mapload.
Defaults to null, set it to TRUE or FALSE explicitly on a per-machine basis if you want to force it to be a certain value.</td></tr><tr><th><a href="obj/machinery/vending.html#var/allow_custom">allow_custom</a></th><td>Whether this vendor can be selected when building a custom vending machine</td></tr><tr><th><a href="obj/machinery/vending.html#var/coin_records">coin_records</a></th><td>List of premium product records</td></tr><tr><th><a href="obj/machinery/vending.html#var/contraband">contraband</a></th><td>List of products this machine sells when you hack it</td></tr><tr><th><a href="obj/machinery/vending.html#var/credits_contained">credits_contained</a></th><td>How many credits does this vending machine have? 20% of all sales go to this pool, and are given freely when the machine is restocked, or successfully tilted. Lost on deconstruction.</td></tr><tr><th><a href="obj/machinery/vending.html#var/crit_chance">crit_chance</a></th><td>The chance, in percent, of this vendor performing a critical hit on anything it crushes via [tilt].</td></tr><tr><th><a href="obj/machinery/vending.html#var/default_price">default_price</a></th><td>Default price of items if not overridden</td></tr><tr><th><a href="obj/machinery/vending.html#var/displayed_currency_icon">displayed_currency_icon</a></th><td>fontawesome icon name to use in to display the user's balance in the vendor UI</td></tr><tr><th><a href="obj/machinery/vending.html#var/displayed_currency_name">displayed_currency_name</a></th><td>String of the used currency to display in the vendor UI</td></tr><tr><th><a href="obj/machinery/vending.html#var/extended_inventory">extended_inventory</a></th><td>can we access the hidden inventory?</td></tr><tr><th><a href="obj/machinery/vending.html#var/extra_price">extra_price</a></th><td>Default price of premium items if not overridden</td></tr><tr><th><a href="obj/machinery/vending.html#var/hidden_records">hidden_records</a></th><td>List of contraband product records</td></tr><tr><th><a href="obj/machinery/vending.html#var/icon_deny">icon_deny</a></th><td>Icon to flash when user is denied a vend</td></tr><tr><th><a href="obj/machinery/vending.html#var/icon_vend">icon_vend</a></th><td>Icon when vending an item to the user</td></tr><tr><th><a href="obj/machinery/vending.html#var/last_reply">last_reply</a></th><td>Last world tick we sent a vent reply</td></tr><tr><th><a href="obj/machinery/vending.html#var/last_shopper">last_shopper</a></th><td>The ref of the last mob to shop with us</td></tr><tr><th><a href="obj/machinery/vending.html#var/last_slogan">last_slogan</a></th><td>Last world tick we sent a slogan message out</td></tr><tr><th><a href="obj/machinery/vending.html#var/light_mask">light_mask</a></th><td>Name of lighting mask for the vending machine</td></tr><tr><th><a href="obj/machinery/vending.html#var/onstation">onstation</a></th><td>Is this item on station or not</td></tr><tr><th><a href="obj/machinery/vending.html#var/onstation_override">onstation_override</a></th><td>DO NOT APPLY THIS GLOBALLY. For mapping var edits only.
A variable to change on a per instance basis that allows the instance to avoid having onstation set for them during mapload.
Setting this to TRUE means that the vending machine is treated as if it were still onstation if it spawns off-station during mapload.
Useful to specify an off-station machine that will be affected by machine-brand intelligence for whatever reason.</td></tr><tr><th><a href="obj/machinery/vending.html#var/panel_type">panel_type</a></th><td>Icon for the maintenance panel overlay</td></tr><tr><th><a href="obj/machinery/vending.html#var/pinned_mobs">pinned_mobs</a></th><td>List of mobs stuck under the vendor</td></tr><tr><th><a href="obj/machinery/vending.html#var/premium">premium</a></th><td>List of premium products this machine sells</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_ads">product_ads</a></th><td>String of small ad messages in the vending screen - random chance</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_categories">product_categories</a></th><td>List of products this machine sells, categorized.
Can only be used as an alternative to <code>products</code>, not alongside it.</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_records">product_records</a></th><td>List of standard product records</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_slogans">product_slogans</a></th><td>String of slogans separated by semicolons, optional</td></tr><tr><th><a href="obj/machinery/vending.html#var/products">products</a></th><td>List of products this machine sells</td></tr><tr><th><a href="obj/machinery/vending.html#var/purchase_message_cooldown">purchase_message_cooldown</a></th><td>Next world time to send a purchase message</td></tr><tr><th><a href="obj/machinery/vending.html#var/scan_id">scan_id</a></th><td>Are we checking the users ID</td></tr><tr><th><a href="obj/machinery/vending.html#var/seconds_electrified">seconds_electrified</a></th><td>World ticks the machine is electified for</td></tr><tr><th><a href="obj/machinery/vending.html#var/shoot_inventory">shoot_inventory</a></th><td>When this is TRUE, we fire items at customers! We're broken!</td></tr><tr><th><a href="obj/machinery/vending.html#var/shoot_inventory_chance">shoot_inventory_chance</a></th><td>How likely this is to happen (prob 100) per second</td></tr><tr><th><a href="obj/machinery/vending.html#var/slogan_delay">slogan_delay</a></th><td>How many ticks until we can send another</td></tr><tr><th><a href="obj/machinery/vending.html#var/slogan_list">slogan_list</a></th><td>List of slogans to scream at potential customers; built upon Iniitialize() of the vendor from product_slogans</td></tr><tr><th><a href="obj/machinery/vending.html#var/squish_damage">squish_damage</a></th><td>Damage this vendor does when tilting onto an atom</td></tr><tr><th><a href="obj/machinery/vending.html#var/tiltable">tiltable</a></th><td>Whether this vendor can be tilted over or not</td></tr><tr><th><a href="obj/machinery/vending.html#var/tilted">tilted</a></th><td>Whether the vendor is tilted or not</td></tr><tr><th><a href="obj/machinery/vending.html#var/tilted_rotation">tilted_rotation</a></th><td>If tilted, this variable should always be the rotation that was applied when we were tilted. Stored for the purposes of unapplying it.</td></tr><tr><th><a href="obj/machinery/vending.html#var/vend_reply">vend_reply</a></th><td>Message sent post vend (Thank you for shopping!)</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/machinery/vending.html#proc/Initialize">Initialize</a></th><td>Initialize the vending machine</td></tr><tr><th><a href="obj/machinery/vending.html#proc/_vend_greyscale">_vend_greyscale</a></th><td>Vends a greyscale modified item.
arguments:
menu - greyscale config menu that has been used to vend the item</td></tr><tr><th><a href="obj/machinery/vending.html#proc/build_inventories">build_inventories</a></th><td>Builds all available inventories for the vendor - standard, contraband and premium</td></tr><tr><th><a href="obj/machinery/vending.html#proc/build_inventory">build_inventory</a></th><td>Build the inventory of the vending machine from its product and record lists</td></tr><tr><th><a href="obj/machinery/vending.html#proc/canLoadItem">canLoadItem</a></th><td>Are we able to load the item passed in</td></tr><tr><th><a href="obj/machinery/vending.html#proc/collect_records_for_static_data">collect_records_for_static_data</a></th><td>Returns a list of given product records of the vendor to be used in UI.
arguments:
records - list of records available
categories - list of categories available
premium - bool of whether a record should be priced by a custom/premium price or not</td></tr><tr><th><a href="obj/machinery/vending.html#proc/compartmentLoadAccessCheck">compartmentLoadAccessCheck</a></th><td>Is the passed in user allowed to load this vending machines compartments? This only is ran if we are using a /obj/item/storage/bag to load the vending machine, and not a dedicated restocker.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/dispense">dispense</a></th><td>Common proc that dispenses an item. Called when the item is vended, or gotten some other way.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/fetch_balance_to_use">fetch_balance_to_use</a></th><td>Returns the balance that the vendor will use for proceeding payment. Most vendors would want to use the user's
card's account credits balance.
arguments:
passed_id - the id card that will be billed for the product</td></tr><tr><th><a href="obj/machinery/vending.html#proc/freebie">freebie</a></th><td>Dispenses free items from the standard stock.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/loadingAttempt">loadingAttempt</a></th><td>Tries to insert the item into the vendor, and depending on whether the product is a part of the vendor's
stock or not, increments an already present product entry's available amount or creates a new entry.
arguments:
inserted_item - the item we're trying to insert
user - mob who's trying to insert the item</td></tr><tr><th><a href="obj/machinery/vending.html#proc/on_dispense">on_dispense</a></th><td>A proc meant to perform custom behavior on newly dispensed items.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/post_restock">post_restock</a></th><td>After-effects of refilling a vending machine from a refill canister</td></tr><tr><th><a href="obj/machinery/vending.html#proc/pre_throw">pre_throw</a></th><td>A callback called before an item is tossed out</td></tr><tr><th><a href="obj/machinery/vending.html#proc/proceed_payment">proceed_payment</a></th><td>Handles payment processing: discounts, logging, balance change etc.
arguments:
paying_id_card - the id card that will be billed for the product.
mob_paying - the mob that is trying to purchase the item.
product_to_vend - the product record of the item we're trying to vend.
price_to_use - price of the item we're trying to vend.
discountless - whether or not to apply discounts</td></tr><tr><th><a href="obj/machinery/vending.html#proc/reset_prices">reset_prices</a></th><td>Reassign the prices of the vending machine as a result of the inflation value, as provided by SSeconomy</td></tr><tr><th><a href="obj/machinery/vending.html#proc/restock">restock</a></th><td>Refill a vending machine from a refill canister</td></tr><tr><th><a href="obj/machinery/vending.html#proc/shock">shock</a></th><td>Shock the passed in user</td></tr><tr><th><a href="obj/machinery/vending.html#proc/speak">speak</a></th><td>Speak the given message verbally
Checks if the machine is powered and the message exists</td></tr><tr><th><a href="obj/machinery/vending.html#proc/throw_impact">throw_impact</a></th><td>Crush the mob that the vending machine got thrown at</td></tr><tr><th><a href="obj/machinery/vending.html#proc/throw_item">throw_item</a></th><td>Throw an item from our internal inventory out in front of us</td></tr><tr><th><a href="obj/machinery/vending.html#proc/tilt">tilt</a></th><td>Tilts ontop of the atom supplied, if crit is true some extra shit can happen. See [fall_and_crush] for return values.
Arguments:
fatty - atom to tilt the vendor onto
local_crit_chance - percent chance of a critical hit
forced_crit - specific critical hit case to use, if any
range - the range of the machine when thrown if not adjacent</td></tr><tr><th><a href="obj/machinery/vending.html#proc/total_stock">total_stock</a></th><td>Returns the total loaded &amp; max amount of items i.e list(total_loaded, total_maximum) in the vending machine based on the product records and premium records</td></tr><tr><th><a href="obj/machinery/vending.html#proc/untilt">untilt</a></th><td>Rights the vendor up, unpinning mobs under it, if any.
Arguments:
user - mob that has untilted the vendor</td></tr><tr><th><a href="obj/machinery/vending.html#proc/vend">vend</a></th><td>The entire shebang of vending the picked item. Processes the vending and initiates the payment for the item.
arguments:
greyscale_colors - greyscale config for the item we're about to vend, if any</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/ad_list"><aside class="declaration">var </aside>ad_list <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L124"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 124"></a></h3><p>List of ads built from product_ads upon Iniitialize()</p><h3 id="var/age_restrictions"><aside class="declaration">var </aside>age_restrictions <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L158"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 158"></a></h3><p>Whether our age check is currently functional</p><h3 id="var/all_products_free"><aside class="declaration">var </aside>all_products_free <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L180"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 180"></a></h3><p>If this is set to TRUE, all products sold by the vending machine are free (cost nothing).
If unset, this will get automatically set to TRUE during init if the machine originates from off-station during mapload.
Defaults to null, set it to TRUE or FALSE explicitly on a per-machine basis if you want to force it to be a certain value.</p><h3 id="var/allow_custom"><aside class="declaration">var </aside>allow_custom <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L75"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 75"></a></h3><p>Whether this vendor can be selected when building a custom vending machine</p><h3 id="var/coin_records"><aside class="declaration">var </aside>coin_records <aside>– /list/<a href="datum.html">datum</a>/<a href="datum/data.html">data</a>/<a href="datum/data/vending_product.html">vending_product</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L120"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 120"></a></h3><p>List of premium product records</p><h3 id="var/contraband"><aside class="declaration">var </aside>contraband <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L101"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 101"></a></h3><p>List of products this machine sells when you hack it</p>
<p>form should be list(/type/path = amount, /type/path2 = amount2)</p><h3 id="var/credits_contained"><aside class="declaration">var </aside>credits_contained <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L160"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 160"></a></h3><p>How many credits does this vending machine have? 20% of all sales go to this pool, and are given freely when the machine is restocked, or successfully tilted. Lost on deconstruction.</p><h3 id="var/crit_chance"><aside class="declaration">var </aside>crit_chance <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L69"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 69"></a></h3><p>The chance, in percent, of this vendor performing a critical hit on anything it crushes via [tilt].</p><h3 id="var/default_price"><aside class="declaration">var </aside>default_price <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L150"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 150"></a></h3><p>Default price of items if not overridden</p><h3 id="var/displayed_currency_icon"><aside class="declaration">var </aside>displayed_currency_icon <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L154"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 154"></a></h3><p>fontawesome icon name to use in to display the user's balance in the vendor UI</p><h3 id="var/displayed_currency_name"><aside class="declaration">var </aside>displayed_currency_name <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L156"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 156"></a></h3><p>String of the used currency to display in the vendor UI</p><h3 id="var/extended_inventory"><aside class="declaration">var </aside>extended_inventory <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L146"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 146"></a></h3><p>can we access the hidden inventory?</p><h3 id="var/extra_price"><aside class="declaration">var </aside>extra_price <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L152"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 152"></a></h3><p>Default price of premium items if not overridden</p><h3 id="var/hidden_records"><aside class="declaration">var </aside>hidden_records <aside>– /list/<a href="datum.html">datum</a>/<a href="datum/data.html">data</a>/<a href="datum/data/vending_product.html">vending_product</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L118"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 118"></a></h3><p>List of contraband product records</p><h3 id="var/icon_deny"><aside class="declaration">var </aside>icon_deny <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L136"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 136"></a></h3><p>Icon to flash when user is denied a vend</p><h3 id="var/icon_vend"><aside class="declaration">var </aside>icon_vend <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L134"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 134"></a></h3><p>Icon when vending an item to the user</p><h3 id="var/last_reply"><aside class="declaration">var </aside>last_reply <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L128"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 128"></a></h3><p>Last world tick we sent a vent reply</p><h3 id="var/last_shopper"><aside class="declaration">var </aside>last_shopper <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L59"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 59"></a></h3><p>The ref of the last mob to shop with us</p><h3 id="var/last_slogan"><aside class="declaration">var </aside>last_slogan <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L130"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 130"></a></h3><p>Last world tick we sent a slogan message out</p><h3 id="var/light_mask"><aside class="declaration">var </aside>light_mask <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L186"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 186"></a></h3><p>Name of lighting mask for the vending machine</p><h3 id="var/onstation"><aside class="declaration">var </aside>onstation <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L167"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 167"></a></h3><p>Is this item on station or not</p>
<p>if it doesn't originate from off-station during mapload, all_products_free gets automatically set to TRUE if it was unset previously.
if it's off-station during mapload, it's also safe from the brand intelligence event</p><h3 id="var/onstation_override"><aside class="declaration">var </aside>onstation_override <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L174"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 174"></a></h3><p>DO NOT APPLY THIS GLOBALLY. For mapping var edits only.
A variable to change on a per instance basis that allows the instance to avoid having onstation set for them during mapload.
Setting this to TRUE means that the vending machine is treated as if it were still onstation if it spawns off-station during mapload.
Useful to specify an off-station machine that will be affected by machine-brand intelligence for whatever reason.</p><h3 id="var/panel_type"><aside class="declaration">var </aside>panel_type <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L73"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 73"></a></h3><p>Icon for the maintenance panel overlay</p><h3 id="var/pinned_mobs"><aside class="declaration">var </aside>pinned_mobs <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L71"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 71"></a></h3><p>List of mobs stuck under the vendor</p><h3 id="var/premium"><aside class="declaration">var </aside>premium <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L108"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 108"></a></h3><p>List of premium products this machine sells</p>
<p>form should be list(/type/path = amount, /type/path2 = amount2)</p><h3 id="var/product_ads"><aside class="declaration">var </aside>product_ads <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L113"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 113"></a></h3><p>String of small ad messages in the vending screen - random chance</p><h3 id="var/product_categories"><aside class="declaration">var </aside>product_categories <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L94"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 94"></a></h3><p>List of products this machine sells, categorized.
Can only be used as an alternative to <code>products</code>, not alongside it.</p>
<p>Form should be list(
&quot;name&quot; = &quot;Category Name&quot;,
&quot;icon&quot; = &quot;UI Icon (Font Awesome or tgfont)&quot;,
&quot;products&quot; = list(/type/path = amount, ...),
)</p><h3 id="var/product_records"><aside class="declaration">var </aside>product_records <aside>– /list/<a href="datum.html">datum</a>/<a href="datum/data.html">data</a>/<a href="datum/data/vending_product.html">vending_product</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L116"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 116"></a></h3><p>List of standard product records</p><h3 id="var/product_slogans"><aside class="declaration">var </aside>product_slogans <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L111"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 111"></a></h3><p>String of slogans separated by semicolons, optional</p><h3 id="var/products"><aside class="declaration">var </aside>products <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L82"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 82"></a></h3><p>List of products this machine sells</p>
<p>form should be list(/type/path = amount, /type/path2 = amount2)</p><h3 id="var/purchase_message_cooldown"><aside class="declaration">var </aside>purchase_message_cooldown <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L57"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 57"></a></h3><p>Next world time to send a purchase message</p><h3 id="var/scan_id"><aside class="declaration">var </aside>scan_id <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L148"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 148"></a></h3><p>Are we checking the users ID</p><h3 id="var/seconds_electrified"><aside class="declaration">var </aside>seconds_electrified <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L138"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 138"></a></h3><p>World ticks the machine is electified for</p><h3 id="var/shoot_inventory"><aside class="declaration">var </aside>shoot_inventory <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L140"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 140"></a></h3><p>When this is TRUE, we fire items at customers! We're broken!</p><h3 id="var/shoot_inventory_chance"><aside class="declaration">var </aside>shoot_inventory_chance <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L142"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 142"></a></h3><p>How likely this is to happen (prob 100) per second</p><h3 id="var/slogan_delay"><aside class="declaration">var </aside>slogan_delay <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L132"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 132"></a></h3><p>How many ticks until we can send another</p><h3 id="var/slogan_list"><aside class="declaration">var </aside>slogan_list <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L122"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 122"></a></h3><p>List of slogans to scream at potential customers; built upon Iniitialize() of the vendor from product_slogans</p><h3 id="var/squish_damage"><aside class="declaration">var </aside>squish_damage <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L67"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 67"></a></h3><p>Damage this vendor does when tilting onto an atom</p><h3 id="var/tiltable"><aside class="declaration">var </aside>tiltable <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L65"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 65"></a></h3><p>Whether this vendor can be tilted over or not</p><h3 id="var/tilted"><aside class="declaration">var </aside>tilted <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L61"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 61"></a></h3><p>Whether the vendor is tilted or not</p><h3 id="var/tilted_rotation"><aside class="declaration">var </aside>tilted_rotation <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L63"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 63"></a></h3><p>If tilted, this variable should always be the rotation that was applied when we were tilted. Stored for the purposes of unapplying it.</p><h3 id="var/vend_reply"><aside class="declaration">var </aside>vend_reply <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L126"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 126"></a></h3><p>Message sent post vend (Thank you for shopping!)</p><h2 id="proc">Proc Details</h2><h3 id="proc/Initialize"><aside class="parent"><a title="/atom" href="atom.html#proc/Initialize">↑</a></aside>Initialize<aside>(mapload)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L205"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 205"></a></aside></h3><p>Initialize the vending machine</p>
<p>Builds the vending machine inventory, sets up slogans and other such misc work</p>
<p>This also sets the onstation var to:</p>
<ul>
<li>FALSE - if the machine was maploaded on a zlevel that doesn't pass the is_station_level check</li>
<li>TRUE - all other cases</li>
</ul><h3 id="proc/_vend_greyscale"><aside class="declaration">proc </aside>_vend_greyscale<aside>(/list/params, /<a href="mob.html">mob</a>/user, /<a href="datum.html">datum</a>/<a href="datum/greyscale_modify_menu.html">greyscale_modify_menu</a>/menu)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/ui_data.dm#L172"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/ui_data.dm 172"></a></aside></h3><p>Vends a greyscale modified item.
arguments:
menu - greyscale config menu that has been used to vend the item</p><h3 id="proc/build_inventories"><aside class="declaration">proc </aside>build_inventories<aside>(start_empty)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L61"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 61"></a></aside></h3><p>Builds all available inventories for the vendor - standard, contraband and premium</p>
<p>Arguments
start_empty - bool to pass into build_inventory that determines whether a product entry starts with available stock or not</p><h3 id="proc/build_inventory"><aside class="declaration">proc </aside>build_inventory<aside>(/list/productlist, /list/recordlist, /list/categories, start_empty, premium)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L14"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 14"></a></aside></h3><p>Build the inventory of the vending machine from its product and record lists</p>
<p>This builds up a full set of /datum/data/vending_products from the product list of the vending machine type
Arguments:</p>
<ul>
<li>productlist - the list of products that need to be converted</li>
<li>recordlist - the list containing /datum/data/vending_product datums</li>
<li>categories - A list in the format of product_categories to source category from</li>
<li>startempty - should we set vending_product record amount from the product list (so it's prefilled at roundstart)</li>
<li>premium - Whether the ending products shall have premium or default prices</li>
</ul><h3 id="proc/canLoadItem"><aside class="declaration">proc </aside>canLoadItem<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/loaded_item, /<a href="mob.html">mob</a>/user, send_message)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/interaction.dm#L60"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/interaction.dm 60"></a></aside></h3><p>Are we able to load the item passed in</p>
<p>Arguments:</p>
<ul>
<li>loaded_item - the item being loaded</li>
<li>user - the user doing the loading</li>
</ul><h3 id="proc/collect_records_for_static_data"><aside class="declaration">proc </aside>collect_records_for_static_data<aside>(/list/records, /list/categories, premium)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/ui_data.dm#L22"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/ui_data.dm 22"></a></aside></h3><p>Returns a list of given product records of the vendor to be used in UI.
arguments:
records - list of records available
categories - list of categories available
premium - bool of whether a record should be priced by a custom/premium price or not</p><h3 id="proc/compartmentLoadAccessCheck"><aside class="declaration">proc </aside>compartmentLoadAccessCheck<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/interaction.dm#L48"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/interaction.dm 48"></a></aside></h3><p>Is the passed in user allowed to load this vending machines compartments? This only is ran if we are using a /obj/item/storage/bag to load the vending machine, and not a dedicated restocker.</p>
<p>Arguments:</p>
<ul>
<li>user - mob that is doing the loading of the vending machine</li>
</ul><h3 id="proc/dispense"><aside class="declaration">proc </aside>dispense<aside>(/<a href="datum.html">datum</a>/<a href="datum/data.html">data</a>/<a href="datum/data/vending_product.html">vending_product</a>/item_record, /<a href="atom.html">atom</a>/spawn_location, silent, dispense_returned)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L223"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 223"></a></aside></h3><p>Common proc that dispenses an item. Called when the item is vended, or gotten some other way.</p>
<p>Arguments</p>
<ul>
<li>datum/data/vending_product/item_record - the vending record which contains the information of the item to dispense</li>
<li>atom/spawn_location - location to dispense the item to</li>
<li>silent - should we play the vending sound</li>
<li>dispense_returned - are we vending out an returned item</li>
</ul><h3 id="proc/fetch_balance_to_use"><aside class="declaration">proc </aside>fetch_balance_to_use<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/card.html">card</a>/<a href="obj/item/card/id.html">id</a>/passed_id)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/ui_data.dm#L92"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/ui_data.dm 92"></a></aside></h3><p>Returns the balance that the vendor will use for proceeding payment. Most vendors would want to use the user's
card's account credits balance.
arguments:
passed_id - the id card that will be billed for the product</p><h3 id="proc/freebie"><aside class="declaration">proc </aside>freebie<aside>(freebies)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/interaction.dm#L197"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/interaction.dm 197"></a></aside></h3><p>Dispenses free items from the standard stock.</p>
<p>Arguments:
freebies - number of free items to vend</p><h3 id="proc/loadingAttempt"><aside class="declaration">proc </aside>loadingAttempt<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/inserted_item, /<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/interaction.dm#L77"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/interaction.dm 77"></a></aside></h3><p>Tries to insert the item into the vendor, and depending on whether the product is a part of the vendor's
stock or not, increments an already present product entry's available amount or creates a new entry.
arguments:
inserted_item - the item we're trying to insert
user - mob who's trying to insert the item</p><h3 id="proc/on_dispense"><aside class="declaration">proc </aside>on_dispense<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/vended_item, dispense_returned)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L251"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 251"></a></aside></h3><p>A proc meant to perform custom behavior on newly dispensed items.</p>
<p>Arguments</p>
<ul>
<li>obj/item/vended_item - the item that has just been dispensed</li>
<li>dispense_returned - is this item an returned product</li>
</ul><h3 id="proc/post_restock"><aside class="declaration">proc </aside>post_restock<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, restocked)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/interaction.dm#L155"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/interaction.dm 155"></a></aside></h3><p>After-effects of refilling a vending machine from a refill canister</p>
<p>This takes the amount of products restocked and gives the user our contained credits if needed,
sending the user a fitting message.</p>
<p>Arguments:</p>
<ul>
<li>user - the user restocking us</li>
<li>restocked - the amount of items we've been refilled with</li>
</ul><h3 id="proc/pre_throw"><aside class="declaration">proc </aside>pre_throw<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/thrown_item)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/throwing.dm#L41"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/throwing.dm 41"></a></aside></h3><p>A callback called before an item is tossed out</p>
<p>Override this if you need to do any special case handling</p>
<p>Arguments:</p>
<ul>
<li>thrown_item - obj/item being thrown</li>
</ul><h3 id="proc/proceed_payment"><aside class="declaration">proc </aside>proceed_payment<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/card.html">card</a>/<a href="obj/item/card/id.html">id</a>/paying_id_card, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/mob_paying, /<a href="datum.html">datum</a>/<a href="datum/data.html">data</a>/<a href="datum/data/vending_product.html">vending_product</a>/product_to_vend, price_to_use, discountless)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L265"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 265"></a></aside></h3><p>Handles payment processing: discounts, logging, balance change etc.
arguments:
paying_id_card - the id card that will be billed for the product.
mob_paying - the mob that is trying to purchase the item.
product_to_vend - the product record of the item we're trying to vend.
price_to_use - price of the item we're trying to vend.
discountless - whether or not to apply discounts</p><h3 id="proc/reset_prices"><aside class="declaration">proc </aside>reset_prices<aside>(/list/recordlist, /list/premiumlist)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/economy.dm#L254"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/economy.dm 254"></a></aside></h3><p>Reassign the prices of the vending machine as a result of the inflation value, as provided by SSeconomy</p>
<p>This rebuilds both /datum/data/vending_products lists for premium and standard products based on their most relevant pricing values.
Arguments:</p>
<ul>
<li>recordlist - the list of standard product datums in the vendor to refresh their prices.</li>
<li>premiumlist - the list of premium product datums in the vendor to refresh their prices.</li>
</ul><h3 id="proc/restock"><aside class="declaration">proc </aside>restock<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/vending_refill.html">vending_refill</a>/canister)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L94"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 94"></a></aside></h3><p>Refill a vending machine from a refill canister</p>
<p>This takes the products from the refill canister and then fills the products, contraband and premium product categories</p>
<p>Arguments:</p>
<ul>
<li>canister - the vending canister we are refilling from</li>
</ul><h3 id="proc/shock"><aside class="declaration">proc </aside>shock<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, shock_chance)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/wires/vending.dm#L108"><img src="git.png" width="16" height="16" title="code/datums/wires/vending.dm 108"></a></aside></h3><p>Shock the passed in user</p>
<p>This checks we have power and that the passed in prob is passed, then generates some sparks
and calls electrocute_mob on the user</p>
<p>Arguments:</p>
<ul>
<li>user - the user to shock</li>
<li>shock_chance - probability the shock happens</li>
</ul><h3 id="proc/speak"><aside class="declaration">proc </aside>speak<aside>(message)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L461"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 461"></a></aside></h3><p>Speak the given message verbally
Checks if the machine is powered and the message exists</p>
<p>Arguments:</p>
<ul>
<li>message - the message to speak</li>
</ul><h3 id="proc/throw_impact">throw_impact<aside>(/<a href="atom.html">atom</a>/hit_atom, /<a href="datum.html">datum</a>/<a href="datum/thrownthing.html">thrownthing</a>/throwingdatum)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/throwing.dm#L46"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/throwing.dm 46"></a></aside></h3><p>Crush the mob that the vending machine got thrown at</p><h3 id="proc/throw_item"><aside class="declaration">proc </aside>throw_item<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/throwing.dm#L8"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/throwing.dm 8"></a></aside></h3><p>Throw an item from our internal inventory out in front of us</p>
<p>This is called when we are hacked, it selects a random product from the records that has an amount &gt; 0
This item is then created and tossed out in front of us with a visible message</p><h3 id="proc/tilt"><aside class="declaration">proc </aside>tilt<aside>(/<a href="atom.html">atom</a>/fatty, local_crit_chance, forced_crit, range)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/tilting.dm#L212"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/tilting.dm 212"></a></aside></h3><p>Tilts ontop of the atom supplied, if crit is true some extra shit can happen. See [fall_and_crush] for return values.
Arguments:
fatty - atom to tilt the vendor onto
local_crit_chance - percent chance of a critical hit
forced_crit - specific critical hit case to use, if any
range - the range of the machine when thrown if not adjacent</p><h3 id="proc/total_stock"><aside class="declaration">proc </aside>total_stock<aside>(contrabrand) <span class="as"> as </span>/list <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/_vending.dm#L343"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/_vending.dm 343"></a></aside></h3><p>Returns the total loaded &amp; max amount of items i.e list(total_loaded, total_maximum) in the vending machine based on the product records and premium records</p>
<p>Arguments</p>
<ul>
<li>contraband - should we count contrabrand as well</li>
</ul><h3 id="proc/untilt"><aside class="declaration">proc </aside>untilt<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/tilting.dm#L300"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/tilting.dm 300"></a></aside></h3><p>Rights the vendor up, unpinning mobs under it, if any.
Arguments:
user - mob that has untilted the vendor</p><h3 id="proc/vend"><aside class="declaration">proc </aside>vend<aside>(/list/params, /<a href="mob.html">mob</a>/user, /list/greyscale_colors)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/vending/vendor/inventory.dm#L143"><img src="git.png" width="16" height="16" title="code/modules/vending/vendor/inventory.dm 143"></a></aside></h3><p>The entire shebang of vending the picked item. Processes the vending and initiates the payment for the item.
arguments:
greyscale_colors - greyscale config for the item we're about to vend, if any</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>