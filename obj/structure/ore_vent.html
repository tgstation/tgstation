<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/structure/ore_vent - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/structure/ore_vent.html#var">Var Details</a> - <a href="obj/structure/ore_vent.html#proc">Proc Details</a></header><main><h1>ore_vent <aside>/<a href="obj.html">obj</a>/<a href="obj/structure.html">structure</a>/<a href="obj/structure/ore_vent.html">ore_vent</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L8"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 8"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/structure/ore_vent.html#var/artifact_chance">artifact_chance</a></th><td>Percent chance that this vent will produce an artifact boulder.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/boulder_icon_state">boulder_icon_state</a></th><td>What base icon_state do we use for this vent's boulders?</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/boulder_size">boulder_size</a></th><td>What size boulders does this vent produce?</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/defending_mobs">defending_mobs</a></th><td>A list of mobs that can be spawned by this vent during a wave defense event.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/discovered">discovered</a></th><td>Has this vent been scanned by a mining scanner? Cannot be scanned again. Adds ores to the vent's description.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/excavation_warning">excavation_warning</a></th><td>What string do we use to warn the player about the excavation event?</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/icon_state_tapped">icon_state_tapped</a></th><td>What icon_state do we use when the ore vent has been tapped?</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/manual_vent_cooldown">manual_vent_cooldown</a></th><td>We use a cooldown to prevent players from tapping boulders rapidly from vents.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/mineral_breakdown">mineral_breakdown</a></th><td>A weighted list of what minerals are contained in this vent, with weight determining how likely each mineral is to be picked in produced boulders.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/node">node</a></th><td>Reference to this ore vent's NODE drone, to track wave success.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/ore_string">ore_string</a></th><td>String containing the formatted list of ores that this vent can produce, and who first discovered this vent.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/ore_vent_options">ore_vent_options</a></th><td>Associated list of vent size weights to pick from.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/scanning_equipment">scanning_equipment</a></th><td>What items can be used to scan a vent?</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/spawn_drone_on_tap">spawn_drone_on_tap</a></th><td>Does this vent spawn a node drone when tapped? Currently unique to boss vents so try not to VV it.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/tapped">tapped</a></th><td>Has this vent been tapped to produce boulders? Cannot be untapped.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/unique_vent">unique_vent</a></th><td>Is this type of vent exempt from the map's vent budget/limit? Think the free iron/glass vent or boss vents. This also causes it to not roll for random mineral breakdown.</td></tr><tr><th><a href="obj/structure/ore_vent.html#var/wave_cooldown">wave_cooldown</a></th><td>We use a cooldown to prevent the wave defense from being started multiple times.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/add_mineral_overlays">add_mineral_overlays</a></th><td>Adds floating temp_visual overlays to the vent, showcasing what minerals are contained within it.
If undiscovered, adds a single overlay with the icon_state &quot;unknown&quot;.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/anti_cheese">anti_cheese</a></th><td>When the ore vent cannot spawn a mob due to being blocked from all sides, we cause some MILD, MILD explosions.
Explosion matches a gibtonite light explosion, as a way to clear nearby solid structures, with a high likelihood of breaking the NODE drone.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/generate_description">generate_description</a></th><td>Generates a description of the ore vent to ore_string, based on the minerals contained within it.
Ore_string is passed to examine().</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/generate_mineral_breakdown">generate_mineral_breakdown</a></th><td>This proc is called when the ore vent is initialized, in order to determine what minerals boulders it spawns can contain.
The materials available are determined by SSore_generation.ore_vent_minerals, which is a list of all minerals that can be contained in ore vents for a given cave generation.
As a result, minerals use a weighted list as seen by ore_vent_minerals_lavaland, which is then copied to ore_vent_minerals.
Once a material is picked from the weighted list, it's removed from ore_vent_minerals, so that it can't be picked again and provided its own internal weight used when assigning minerals to boulders spawned by this vent.
May also be called after the fact, as seen in SSore_generation's initialize, to add more minerals to an existing vent.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/handle_wave_conclusion">handle_wave_conclusion</a></th><td>Called when the wave defense event ends, after a variable amount of time in start_wave_defense.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/initiate_wave_loss">initiate_wave_loss</a></th><td>Handles reseting our ore vent to its original state so we can start over</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/initiate_wave_win">initiate_wave_win</a></th><td>Handles winning the event, gives everyone a payout and start boulder production</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/log_mob_killed">log_mob_killed</a></th><td>Handle logging for mobs killed</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/log_mob_spawned">log_mob_spawned</a></th><td>Handle logging for mobs spawned</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/ore_quantity_function">ore_quantity_function</a></th><td>Returns the quantity of mineral sheets in each ore vent's boulder contents roll.
First roll can produce the most ore, with subsequent rolls scaling lower logarithmically.
Inversely scales with ore_floor, so that the first roll is the largest, and subsequent rolls are smaller.
(1 -&gt; from 16 to 7 sheets of materials, and 3 -&gt; from 8 to 6 sheets of materials on a small vent)
This also means a large boulder can highroll a boulder with a full stack of 50 sheets of material.
@params ore_floor The number of minerals already rolled. Used to scale the logarithmic function.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/pre_wave_defense">pre_wave_defense</a></th><td>This confirms that the user wants to start the wave defense event, and that they can start it.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/produce_boulder">produce_boulder</a></th><td>Here is where we handle producing a new boulder, based on the qualities of this ore vent.
Returns the boulder produced.
@params apply_cooldown Should we apply a cooldown to producing boulders? Default's false, used by manual boulder production (goldgrubs, golems, etc).</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/reset_drone">reset_drone</a></th><td>Sends our node back to base and cleans up after the reference</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/scan_and_confirm">scan_and_confirm</a></th><td>Called when the ore vent is tapped by a scanning device.
Gives a readout of the ores available in the vent that gets added to the description,
then asks the user if they want to start wave defense if it's already been discovered.
@params user The user who tapped the vent.
@params mech_scan If TRUE, will bypass interaction checks to allow mechs to be able to begin the wave defense.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/start_wave_defense">start_wave_defense</a></th><td>Starts the wave defense event, which will spawn a number of lavaland mobs based on the size of the ore vent.
Called after the vent has been tapped by a scanning device.
Will summon a number of waves of mobs, ending in the vent being tapped after the final wave.</td></tr><tr><th><a href="obj/structure/ore_vent.html#proc/vent_size_setup">vent_size_setup</a></th><td>The part of initialization and the ore_generation subsystem's setup that assigns the size of an ore_vent and it's boulders.
@param random: Used for random sized boulders, and the standard (pre 9-6-2025) behavior.
@param force_size: An override we use for map_generation, when we know what size boulder we need from this ore vent already. Use the standard ore_vent size defines.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/artifact_chance"><aside class="declaration">var </aside>artifact_chance <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L66"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 66"></a></h3><p>Percent chance that this vent will produce an artifact boulder.</p><h3 id="var/boulder_icon_state"><aside class="declaration">var </aside>boulder_icon_state <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L64"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 64"></a></h3><p>What base icon_state do we use for this vent's boulders?</p><h3 id="var/boulder_size"><aside class="declaration">var </aside>boulder_size <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L33"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 33"></a></h3><p>What size boulders does this vent produce?</p><h3 id="var/defending_mobs"><aside class="declaration">var </aside>defending_mobs <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L49"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 49"></a></h3><p>A list of mobs that can be spawned by this vent during a wave defense event.</p><h3 id="var/discovered"><aside class="declaration">var </aside>discovered <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L23"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 23"></a></h3><p>Has this vent been scanned by a mining scanner? Cannot be scanned again. Adds ores to the vent's description.</p><h3 id="var/excavation_warning"><aside class="declaration">var </aside>excavation_warning <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L47"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 47"></a></h3><p>What string do we use to warn the player about the excavation event?</p><h3 id="var/icon_state_tapped"><aside class="declaration">var </aside>icon_state_tapped <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L29"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 29"></a></h3><p>What icon_state do we use when the ore vent has been tapped?</p><h3 id="var/manual_vent_cooldown"><aside class="declaration">var </aside>manual_vent_cooldown <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L70"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 70"></a></h3><p>We use a cooldown to prevent players from tapping boulders rapidly from vents.</p><h3 id="var/mineral_breakdown"><aside class="declaration">var </aside>mineral_breakdown <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L31"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 31"></a></h3><p>A weighted list of what minerals are contained in this vent, with weight determining how likely each mineral is to be picked in produced boulders.</p><h3 id="var/node"><aside class="declaration">var </aside>node <aside>– /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/basic.html">basic</a>/<a href="mob/living/basic/node_drone.html">node_drone</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L35"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 35"></a></h3><p>Reference to this ore vent's NODE drone, to track wave success.</p><h3 id="var/ore_string"><aside class="declaration">var </aside>ore_string <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L37"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 37"></a></h3><p>String containing the formatted list of ores that this vent can produce, and who first discovered this vent.</p><h3 id="var/ore_vent_options"><aside class="declaration">var </aside>ore_vent_options <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L39"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 39"></a></h3><p>Associated list of vent size weights to pick from.</p><h3 id="var/scanning_equipment"><aside class="declaration">var </aside>scanning_equipment <aside>– /static/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L58"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 58"></a></h3><p>What items can be used to scan a vent?</p><h3 id="var/spawn_drone_on_tap"><aside class="declaration">var </aside>spawn_drone_on_tap <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L27"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 27"></a></h3><p>Does this vent spawn a node drone when tapped? Currently unique to boss vents so try not to VV it.</p><h3 id="var/tapped"><aside class="declaration">var </aside>tapped <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L21"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 21"></a></h3><p>Has this vent been tapped to produce boulders? Cannot be untapped.</p><h3 id="var/unique_vent"><aside class="declaration">var </aside>unique_vent <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L25"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 25"></a></h3><p>Is this type of vent exempt from the map's vent budget/limit? Think the free iron/glass vent or boss vents. This also causes it to not roll for random mineral breakdown.</p><h3 id="var/wave_cooldown"><aside class="declaration">var </aside>wave_cooldown <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L68"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 68"></a></h3><p>We use a cooldown to prevent the wave defense from being started multiple times.</p><h2 id="proc">Proc Details</h2><h3 id="proc/add_mineral_overlays"><aside class="declaration">proc </aside>add_mineral_overlays<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L419"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 419"></a></aside></h3><p>Adds floating temp_visual overlays to the vent, showcasing what minerals are contained within it.
If undiscovered, adds a single overlay with the icon_state &quot;unknown&quot;.</p><h3 id="proc/anti_cheese"><aside class="declaration">proc </aside>anti_cheese<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L479"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 479"></a></aside></h3><p>When the ore vent cannot spawn a mob due to being blocked from all sides, we cause some MILD, MILD explosions.
Explosion matches a gibtonite light explosion, as a way to clear nearby solid structures, with a high likelihood of breaking the NODE drone.</p><h3 id="proc/generate_description"><aside class="declaration">proc </aside>generate_description<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L406"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 406"></a></aside></h3><p>Generates a description of the ore vent to ore_string, based on the minerals contained within it.
Ore_string is passed to examine().</p><h3 id="proc/generate_mineral_breakdown"><aside class="declaration">proc </aside>generate_mineral_breakdown<aside>(new_minerals, map_loading)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L172"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 172"></a></aside></h3><p>This proc is called when the ore vent is initialized, in order to determine what minerals boulders it spawns can contain.
The materials available are determined by SSore_generation.ore_vent_minerals, which is a list of all minerals that can be contained in ore vents for a given cave generation.
As a result, minerals use a weighted list as seen by ore_vent_minerals_lavaland, which is then copied to ore_vent_minerals.
Once a material is picked from the weighted list, it's removed from ore_vent_minerals, so that it can't be picked again and provided its own internal weight used when assigning minerals to boulders spawned by this vent.
May also be called after the fact, as seen in SSore_generation's initialize, to add more minerals to an existing vent.</p>
<p>The above applies only when spawning in at mapload, otherwise we pick randomly from ore_vent_minerals_lavaland.</p>
<p>@params new_minerals How many minerals should be added to this vent? Defaults to MINERAL_TYPE_OPTIONS_RANDOM, which is 4.
@params map_loading Is this vent being spawned in at mapload? If so, we use the ore_generation subsystem's ore_vent_minerals list to pick minerals. Otherwise, we pick randomly from ore_vent_minerals_lavaland.</p><h3 id="proc/handle_wave_conclusion"><aside class="declaration">proc </aside>handle_wave_conclusion<aside>(/<a href="datum.html">datum</a>/source)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L300"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 300"></a></aside></h3><p>Called when the wave defense event ends, after a variable amount of time in start_wave_defense.</p>
<p>If the node drone is still alive, the ore vent is tapped and the ore vent will begin generating boulders.
If the node drone is dead, the ore vent is not tapped and the wave defense can be reattempted.</p>
<p>Also gives xp and mining points to all nearby miners in equal measure.</p><h3 id="proc/initiate_wave_loss"><aside class="declaration">proc </aside>initiate_wave_loss<aside>(loss_message)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L322"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 322"></a></aside></h3><p>Handles reseting our ore vent to its original state so we can start over</p><h3 id="proc/initiate_wave_win"><aside class="declaration">proc </aside>initiate_wave_win<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L331"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 331"></a></aside></h3><p>Handles winning the event, gives everyone a payout and start boulder production</p><h3 id="proc/log_mob_killed"><aside class="declaration">proc </aside>log_mob_killed<aside>(/<a href="datum.html">datum</a>/source, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/killed)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L494"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 494"></a></aside></h3><p>Handle logging for mobs killed</p><h3 id="proc/log_mob_spawned"><aside class="declaration">proc </aside>log_mob_spawned<aside>(/<a href="datum.html">datum</a>/source, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/created)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L485"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 485"></a></aside></h3><p>Handle logging for mobs spawned</p><h3 id="proc/ore_quantity_function"><aside class="declaration">proc </aside>ore_quantity_function<aside>(ore_floor)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L215"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 215"></a></aside></h3><p>Returns the quantity of mineral sheets in each ore vent's boulder contents roll.
First roll can produce the most ore, with subsequent rolls scaling lower logarithmically.
Inversely scales with ore_floor, so that the first roll is the largest, and subsequent rolls are smaller.
(1 -&gt; from 16 to 7 sheets of materials, and 3 -&gt; from 8 to 6 sheets of materials on a small vent)
This also means a large boulder can highroll a boulder with a full stack of 50 sheets of material.
@params ore_floor The number of minerals already rolled. Used to scale the logarithmic function.</p><h3 id="proc/pre_wave_defense"><aside class="declaration">proc </aside>pre_wave_defense<aside>(/<a href="mob.html">mob</a>/user, spawn_drone, mech_scan)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L221"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 221"></a></aside></h3><p>This confirms that the user wants to start the wave defense event, and that they can start it.</p><h3 id="proc/produce_boulder"><aside class="declaration">proc </aside>produce_boulder<aside>(apply_cooldown) <span class="as"> as </span>/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/boulder.html">boulder</a> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L433"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 433"></a></aside></h3><p>Here is where we handle producing a new boulder, based on the qualities of this ore vent.
Returns the boulder produced.
@params apply_cooldown Should we apply a cooldown to producing boulders? Default's false, used by manual boulder production (goldgrubs, golems, etc).</p><h3 id="proc/reset_drone"><aside class="declaration">proc </aside>reset_drone<aside>(success)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L357"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 357"></a></aside></h3><p>Sends our node back to base and cleans up after the reference</p><h3 id="proc/scan_and_confirm"><aside class="declaration">proc </aside>scan_and_confirm<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, mech_scan)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L370"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 370"></a></aside></h3><p>Called when the ore vent is tapped by a scanning device.
Gives a readout of the ores available in the vent that gets added to the description,
then asks the user if they want to start wave defense if it's already been discovered.
@params user The user who tapped the vent.
@params mech_scan If TRUE, will bypass interaction checks to allow mechs to be able to begin the wave defense.</p><h3 id="proc/start_wave_defense"><aside class="declaration">proc </aside>start_wave_defense<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L276"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 276"></a></aside></h3><p>Starts the wave defense event, which will spawn a number of lavaland mobs based on the size of the ore vent.
Called after the vent has been tapped by a scanning device.
Will summon a number of waves of mobs, ending in the vent being tapped after the final wave.</p><h3 id="proc/vent_size_setup"><aside class="declaration">proc </aside>vent_size_setup<aside>(random, force_size, map_loading)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/lavaland/ore_vent.dm#L504"><img src="git.png" width="16" height="16" title="code/game/objects/structures/lavaland/ore_vent.dm 504"></a></aside></h3><p>The part of initialization and the ore_generation subsystem's setup that assigns the size of an ore_vent and it's boulders.
@param random: Used for random sized boulders, and the standard (pre 9-6-2025) behavior.
@param force_size: An override we use for map_generation, when we know what size boulder we need from this ore vent already. Use the standard ore_vent size defines.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>