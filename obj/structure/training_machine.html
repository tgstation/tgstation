<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/structure/training_machine - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/structure/training_machine.html#var">Var Details</a> - <a href="obj/structure/training_machine.html#proc">Proc Details</a></header><main><h1>training_machine <aside>/<a href="obj.html">obj</a>/<a href="obj/structure.html">structure</a>/<a href="obj/structure/training_machine.html">training_machine</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L15"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 15"></a></h1><p>Machine that runs around wildly so people can practice clickin on things</p>
<p>Can have a mob buckled on or a obj/item/target attached. Movement controlled by SSFastProcess,
movespeed controlled by cooldown macros. Can attach obj/item/target, obj/item/training_toolbox, and can buckle mobs to this.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/structure/training_machine.html#var/attached_item">attached_item</a></th><td>Reference to a potentially attached object, either a target, trainer toolbox, or syndicate toolbox</td></tr><tr><th><a href="obj/structure/training_machine.html#var/attack_cooldown">attack_cooldown</a></th><td>Helper for timing attacks when emagged</td></tr><tr><th><a href="obj/structure/training_machine.html#var/move_cooldown">move_cooldown</a></th><td>Cooldown macro to control how fast this will move. Used in process()</td></tr><tr><th><a href="obj/structure/training_machine.html#var/move_speed">move_speed</a></th><td>Delay between process() calls. Cannot be higher than MAX_SPEED. Smaller value represents faster movement.</td></tr><tr><th><a href="obj/structure/training_machine.html#var/moving">moving</a></th><td>Is the machine moving? Setting this to FALSE will automatically call stop_moving()</td></tr><tr><th><a href="obj/structure/training_machine.html#var/range">range</a></th><td>The distance the machine is allowed to roam from its starting point</td></tr><tr><th><a href="obj/structure/training_machine.html#var/starting_turf">starting_turf</a></th><td>The turf the machine was on when it was activated</td></tr><tr><th><a href="obj/structure/training_machine.html#var/target_position">target_position</a></th><td>A random spot within range that the trainer is trying to reach</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/structure/training_machine.html#proc/Destroy">Destroy</a></th><td>Called on qdel(), so we don't want a cool explosion to happen</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/atom_destruction">atom_destruction</a></th><td>Called on a normal destruction, so we have a cool explosion and toss whatever's attached</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/attach_item">attach_item</a></th><td>Attach an item to the machine</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/attackby">attackby</a></th><td>Called when the machien is attacked by something</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/emag_act">emag_act</a></th><td>Emagging causes a deadly, unremovable syndicate toolbox to be attached to the machine</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/find_target_position">find_target_position</a></th><td>Find a suitable turf to move towards</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/handle_density">handle_density</a></th><td>Make sure the machine can't be walked through if something is attached</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/on_attached_delete">on_attached_delete</a></th><td>Called when the attached item is deleted.</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/process">process</a></th><td>Main movement method for the machine</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/remove_attached_item">remove_attached_item</a></th><td>Remove the attached item from the machine</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/start_moving">start_moving</a></th><td>Start the machine's movement</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/stop_moving">stop_moving</a></th><td>Stop the machine's movement</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/toggle">toggle</a></th><td>Toggle the machine's movement</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/try_attack">try_attack</a></th><td>Try to attack a nearby mob</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/ui_act">ui_act</a></th><td>Control the attached variables.</td></tr><tr><th><a href="obj/structure/training_machine.html#proc/ui_data">ui_data</a></th><td>Send data to the UI</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/attached_item"><aside class="declaration">var </aside>attached_item <aside>– /<a href="obj.html">obj</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L35"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 35"></a></h3><p>Reference to a potentially attached object, either a target, trainer toolbox, or syndicate toolbox</p><h3 id="var/attack_cooldown"><aside class="declaration">var </aside>attack_cooldown <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L37"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 37"></a></h3><p>Helper for timing attacks when emagged</p><h3 id="var/move_cooldown"><aside class="declaration">var </aside>move_cooldown <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L39"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 39"></a></h3><p>Cooldown macro to control how fast this will move. Used in process()</p><h3 id="var/move_speed"><aside class="declaration">var </aside>move_speed <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L33"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 33"></a></h3><p>Delay between process() calls. Cannot be higher than MAX_SPEED. Smaller value represents faster movement.</p><h3 id="var/moving"><aside class="declaration">var </aside>moving <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L25"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 25"></a></h3><p>Is the machine moving? Setting this to FALSE will automatically call stop_moving()</p><h3 id="var/range"><aside class="declaration">var </aside>range <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L27"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 27"></a></h3><p>The distance the machine is allowed to roam from its starting point</p><h3 id="var/starting_turf"><aside class="declaration">var </aside>starting_turf <aside>– /<a href="turf.html">turf</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L31"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 31"></a></h3><p>The turf the machine was on when it was activated</p><h3 id="var/target_position"><aside class="declaration">var </aside>target_position <aside>– /<a href="turf.html">turf</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L29"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 29"></a></h3><p>A random spot within range that the trainer is trying to reach</p><h2 id="proc">Proc Details</h2><h3 id="proc/Destroy"><aside class="parent"><a title="/atom" href="atom.html#proc/Destroy">↑</a></aside>Destroy<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L44"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 44"></a></aside></h3><p>Called on qdel(), so we don't want a cool explosion to happen</p><h3 id="proc/atom_destruction"><aside class="parent"><a title="/obj" href="obj.html#proc/atom_destruction">↑</a></aside>atom_destruction<aside>(damage_flag)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L51"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 51"></a></aside></h3><p>Called on a normal destruction, so we have a cool explosion and toss whatever's attached</p><h3 id="proc/attach_item"><aside class="declaration">proc </aside>attach_item<aside>(/<a href="obj.html">obj</a>/target)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L131"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 131"></a></aside></h3><p>Attach an item to the machine</p>
<p>This proc technically works with any obj. Currently is only used for objects of type item/target and item/training_toolbox
Will make the attached item appear visually on the machine
Arguments</p>
<ul>
<li>target - The object to attach</li>
</ul><h3 id="proc/attackby"><aside class="parent"><a title="/atom" href="atom.html#proc/attackby">↑</a></aside>attackby<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/target, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L111"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 111"></a></aside></h3><p>Called when the machien is attacked by something</p>
<p>Meant for attaching an item to the machine, should only be a training toolbox or target. If emagged, the
machine will gain an auto-attached syndicate toolbox, so in that case we shouldn't be able to swap it out</p><h3 id="proc/emag_act"><aside class="parent"><a title="/atom" href="atom.html#proc/emag_act">↑</a></aside>emag_act<aside>(/<a href="mob.html">mob</a>/user, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/card.html">card</a>/emag/emag_card)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L316"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 316"></a></aside></h3><p>Emagging causes a deadly, unremovable syndicate toolbox to be attached to the machine</p><h3 id="proc/find_target_position"><aside class="declaration">proc </aside>find_target_position<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L256"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 256"></a></aside></h3><p>Find a suitable turf to move towards</p><h3 id="proc/handle_density"><aside class="declaration">proc </aside>handle_density<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L294"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 294"></a></aside></h3><p>Make sure the machine can't be walked through if something is attached</p><h3 id="proc/on_attached_delete"><aside class="declaration">proc </aside>on_attached_delete<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L145"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 145"></a></aside></h3><p>Called when the attached item is deleted.</p>
<p>Cleans up behavior for when the attached item is deleted or removed.</p><h3 id="proc/process"><aside class="parent"><a title="/datum" href="datum.html#proc/process">↑</a></aside>process<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L234"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 234"></a></aside></h3><p>Main movement method for the machine</p>
<p>Handles movement using SSFastProcess. Moves randomly, point-to-point, in an area centered around wherever it started.
Will only move if the move_cooldown cooldown macro is finished.
If it can't find a place to go, it will stop moving.</p><h3 id="proc/remove_attached_item"><aside class="declaration">proc </aside>remove_attached_item<aside>(/<a href="mob.html">mob</a>/user, throwing)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L162"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 162"></a></aside></h3><p>Remove the attached item from the machine</p>
<p>Called when a user removes the item by hand or by swapping it out with another, when the machine breaks, or
when the machine is emagged.
Arguments</p>
<ul>
<li>user - The peson , if any, removing the attached item</li>
<li>throwing - If we should make the item fly off the machine</li>
</ul><h3 id="proc/start_moving"><aside class="declaration">proc </aside>start_moving<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L220"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 220"></a></aside></h3><p>Start the machine's movement</p>
<p>Says a message, plays a sound, then starts processing</p><h3 id="proc/stop_moving"><aside class="declaration">proc </aside>stop_moving<aside>(message)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L208"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 208"></a></aside></h3><p>Stop the machine's movement</p>
<p>Will call STOP_PROCESSING, play a sound, and say an appropriate message
Arguments</p>
<ul>
<li>Message - the message the machine says when stopping</li>
</ul><h3 id="proc/toggle"><aside class="declaration">proc </aside>toggle<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L195"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 195"></a></aside></h3><p>Toggle the machine's movement</p><h3 id="proc/try_attack"><aside class="declaration">proc </aside>try_attack<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L273"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 273"></a></aside></h3><p>Try to attack a nearby mob</p>
<p>Called whenever the machine moves, this will look for mobs adjacent to the machine to attack.
Will attack with either a training toolbox (if attached), or a much more deadly syndicate toolbox (if emagged).
A cooldown macro (attack_cooldown) ensures it doesn't attack too quickly</p><h3 id="proc/ui_act"><aside class="parent"><a title="/datum" href="datum.html#proc/ui_act">↑</a></aside>ui_act<aside>(action, /list/params, /<a href="datum.html">datum</a>/<a href="datum/tgui.html">tgui</a>/ui, /<a href="datum.html">datum</a>/<a href="datum/ui_state.html">ui_state</a>/state)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L82"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 82"></a></aside></h3><p>Control the attached variables.</p>
<p>Will not respond if moving and emagged, so once you set it to go it can't be stopped!</p><h3 id="proc/ui_data"><aside class="parent"><a title="/datum" href="datum.html#proc/ui_data">↑</a></aside>ui_data<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/game/objects/structures/training_machine.dm#L70"><img src="git.png" width="16" height="16" title="code/game/objects/structures/training_machine.dm 70"></a></aside></h3><p>Send data to the UI</p>
<p>Include's the machine's movement range, speed, and whether or not it's active</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>