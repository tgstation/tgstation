<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/camerachunk - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/camerachunk.html#var">Var Details</a> - <a href="datum/camerachunk.html#proc">Proc Details</a></header><main><h1>camerachunk <aside>/<a href="datum.html">datum</a>/<a href="datum/camerachunk.html">camerachunk</a></aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L8"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 8"></a></h1><p>A 16x16 grid of the map with a list of turfs that can be seen, are visible and are dimmed. <br />
Allows Camera Eyes to stream these chunks and know what it can and cannot see.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/camerachunk.html#var/active_static_images">active_static_images</a></th><td>images currently in use on obscured turfs.</td></tr><tr><th><a href="datum/camerachunk.html#var/cameras">cameras</a></th><td>cameras that can see into our grid
indexed by the z level of the camera</td></tr><tr><th><a href="datum/camerachunk.html#var/obscuredTurfs">obscuredTurfs</a></th><td>turfs our cameras cant see but are inside our grid. associative list of the form: list(obscured turf = static image on that turf)</td></tr><tr><th><a href="datum/camerachunk.html#var/seenby">seenby</a></th><td>Camera mobs that can see turfs in our grid</td></tr><tr><th><a href="datum/camerachunk.html#var/turfs">turfs</a></th><td>list of all turfs, associative with that turf's static image
turf -&gt; /image</td></tr><tr><th><a href="datum/camerachunk.html#var/visibleTurfs">visibleTurfs</a></th><td>turfs our cameras can see inside our grid</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/camerachunk.html#proc/New">New</a></th><td>Create a new camera chunk, since the chunks are made as they are needed.</td></tr><tr><th><a href="datum/camerachunk.html#proc/add">add</a></th><td>Add a camera eye to the chunk, then update if changed.</td></tr><tr><th><a href="datum/camerachunk.html#proc/hasChanged">hasChanged</a></th><td>Updates the chunk, makes sure that it doesn't update too much. If the chunk isn't being watched it will
instead be flagged to update the next time an AI Eye moves near it.</td></tr><tr><th><a href="datum/camerachunk.html#proc/remove">remove</a></th><td>Remove a camera eye from the chunk</td></tr><tr><th><a href="datum/camerachunk.html#proc/update">update</a></th><td>The actual updating. It gathers the visible turfs from cameras and puts them into the appropiate lists.
Accepts an optional partial_update argument, that blocks any calls out to chunks that could affect us, like above or below</td></tr><tr><th><a href="datum/camerachunk.html#proc/visibilityChanged">visibilityChanged</a></th><td>Called when a chunk has changed. I.E: A wall was deleted.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active_static_images"><aside class="declaration">var </aside>active_static_images <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L22"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 22"></a></h3><p>images currently in use on obscured turfs.</p><h3 id="var/cameras"><aside class="declaration">var </aside>cameras <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L15"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 15"></a></h3><p>cameras that can see into our grid
indexed by the z level of the camera</p><h3 id="var/obscuredTurfs"><aside class="declaration">var </aside>obscuredTurfs <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L10"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 10"></a></h3><p>turfs our cameras cant see but are inside our grid. associative list of the form: list(obscured turf = static image on that turf)</p><h3 id="var/seenby"><aside class="declaration">var </aside>seenby <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L20"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 20"></a></h3><p>Camera mobs that can see turfs in our grid</p><h3 id="var/turfs"><aside class="declaration">var </aside>turfs <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L18"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 18"></a></h3><p>list of all turfs, associative with that turf's static image
turf -&gt; /image</p><h3 id="var/visibleTurfs"><aside class="declaration">var </aside>visibleTurfs <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L12"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 12"></a></h3><p>turfs our cameras can see inside our grid</p><h2 id="proc">Proc Details</h2><h3 id="proc/New">New<aside>(x, y, lower_z)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L135"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 135"></a></aside></h3><p>Create a new camera chunk, since the chunks are made as they are needed.</p><h3 id="proc/add"><aside class="declaration">proc </aside>add<aside>(/<a href="mob.html">mob</a>/<a href="mob/eye.html">eye</a>/<a href="mob/eye/camera.html">camera</a>/eye)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L31"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 31"></a></aside></h3><p>Add a camera eye to the chunk, then update if changed.</p><h3 id="proc/hasChanged"><aside class="declaration">proc </aside>hasChanged<aside>(update_now, update_delay_buffer)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L64"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 64"></a></aside></h3><p>Updates the chunk, makes sure that it doesn't update too much. If the chunk isn't being watched it will
instead be flagged to update the next time an AI Eye moves near it.</p>
<p>update_delay_buffer is used for cameras that are moving around, which are cyborg inbuilt cameras and
mecha onboard cameras. This buffer should be usually lower than UPDATE_BUFFER_TIME because
otherwise a moving camera can run out of its own view before updating static.</p><h3 id="proc/remove"><aside class="declaration">proc </aside>remove<aside>(/<a href="mob.html">mob</a>/<a href="mob/eye.html">eye</a>/<a href="mob/eye/camera.html">camera</a>/<a href="mob/eye/camera/ai.html">ai</a>/eye)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L42"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 42"></a></aside></h3><p>Remove a camera eye from the chunk</p><h3 id="proc/update"><aside class="declaration">proc </aside>update<aside>(partial_update)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L72"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 72"></a></aside></h3><p>The actual updating. It gathers the visible turfs from cameras and puts them into the appropiate lists.
Accepts an optional partial_update argument, that blocks any calls out to chunks that could affect us, like above or below</p><h3 id="proc/visibilityChanged"><aside class="declaration">proc </aside>visibilityChanged<aside>(/<a href="turf.html">turf</a>/loc)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mob/living/silicon/ai/freelook/chunk.dm#L51"><img src="git.png" width="16" height="16" title="code/modules/mob/living/silicon/ai/freelook/chunk.dm 51"></a></aside></h3><p>Called when a chunk has changed. I.E: A wall was deleted.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/c41b333c9bc46606d2c5d5b517f7836d5953fbfd">c41b333</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>