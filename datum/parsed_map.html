<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/parsed_map - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/parsed_map.html#var">Var Details</a> - <a href="datum/parsed_map.html#proc">Proc Details</a></header><main><h1>parsed_map <aside>/<a href="datum.html">datum</a>/<a href="datum/parsed_map.html">parsed_map</a></aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L72"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 72"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/parsed_map.html#var/bounds">bounds</a></th><td>Offset bounds. Same as parsed_bounds until load().</td></tr><tr><th><a href="datum/parsed_map.html#var/expanded_x">expanded_x</a></th><td>If we've expanded world.maxy</td></tr><tr><th><a href="datum/parsed_map.html#var/expanded_y">expanded_y</a></th><td>If we've expanded world.maxx</td></tr><tr><th><a href="datum/parsed_map.html#var/key_len">key_len</a></th><td>The length of a key in this file. This is promised by the standard to be static</td></tr><tr><th><a href="datum/parsed_map.html#var/line_len">line_len</a></th><td>The length of a line in this file. Not promised by dmm but standard dmm uses it, so we can trust it</td></tr><tr><th><a href="datum/parsed_map.html#var/loaded_areas">loaded_areas</a></th><td>List of area types we've loaded AS A PART OF THIS MAP
We do this to allow non unique areas, so we'll only load one per map</td></tr><tr><th><a href="datum/parsed_map.html#var/loading">loading</a></th><td>If we are currently loading this map</td></tr><tr><th><a href="datum/parsed_map.html#var/matches_tgm">matches_tgm</a></th><td>Matches key formats in TMG (IE: newline after the ()</td></tr><tr><th><a href="datum/parsed_map.html#var/model_path">model_path</a></th><td>Pulls out model paths for DMM</td></tr><tr><th><a href="datum/parsed_map.html#var/parsed_bounds">parsed_bounds</a></th><td>Unoffset bounds. Null on parse failure.</td></tr><tr><th><a href="datum/parsed_map.html#var/turf_blacklist">turf_blacklist</a></th><td>any turf in this list is skipped inside of build_coordinate. Lazy assoc list</td></tr><tr><th><a href="datum/parsed_map.html#var/var_edits_tgm">var_edits_tgm</a></th><td>Pulls out key value pairs for TGM</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/parsed_map.html#proc/New">New</a></th><td>Parse a map, possibly cropping it.</td></tr><tr><th><a href="datum/parsed_map.html#proc/_dmm_load">_dmm_load</a></th><td>Stanrdard loading, not used in production
Doesn't take advantage of any tgm optimizations, which makes it slower but also more general
Use this if for some reason your map format is messy</td></tr><tr><th><a href="datum/parsed_map.html#proc/check_for_errors">check_for_errors</a></th><td>Check a parsed but not yet loaded map for errors.</td></tr><tr><th><a href="datum/parsed_map.html#proc/dmm_build_cache">dmm_build_cache</a></th><td>Builds key caches for general formats
Slower then the proc above, tho it could still be optimized slightly. it's just not a priority
Since we don't run DMM maps, ever.</td></tr><tr><th><a href="datum/parsed_map.html#proc/filter_grid_sets_based_on_z_bounds">filter_grid_sets_based_on_z_bounds</a></th><td>Iterates over all grid sets and returns ones with z values within the given bounds. Inclusive</td></tr><tr><th><a href="datum/parsed_map.html#proc/load">load</a></th><td>Load the parsed map into the world. You probably want <a href="global.html#proc/load_map" title="/global">/proc/load_map</a>. Keep the signature the same.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/bounds"><aside class="declaration">var </aside>bounds <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L94"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 94"></a></h3><p>Offset bounds. Same as parsed_bounds until load().</p><h3 id="var/expanded_x"><aside class="declaration">var </aside>expanded_x <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L82"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 82"></a></h3><p>If we've expanded world.maxy</p><h3 id="var/expanded_y"><aside class="declaration">var </aside>expanded_y <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L80"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 80"></a></h3><p>If we've expanded world.maxx</p><h3 id="var/key_len"><aside class="declaration">var </aside>key_len <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L76"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 76"></a></h3><p>The length of a key in this file. This is promised by the standard to be static</p><h3 id="var/line_len"><aside class="declaration">var </aside>line_len <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L78"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 78"></a></h3><p>The length of a line in this file. Not promised by dmm but standard dmm uses it, so we can trust it</p><h3 id="var/loaded_areas"><aside class="declaration">var </aside>loaded_areas <aside>– /list/<a href="area.html">area</a></aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L87"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 87"></a></h3><p>List of area types we've loaded AS A PART OF THIS MAP
We do this to allow non unique areas, so we'll only load one per map</p><h3 id="var/loading"><aside class="declaration">var </aside>loading <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L110"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 110"></a></h3><p>If we are currently loading this map</p><h3 id="var/matches_tgm"><aside class="declaration">var </aside>matches_tgm <aside>– /static/regex</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L103"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 103"></a></h3><p>Matches key formats in TMG (IE: newline after the ()</p><h3 id="var/model_path"><aside class="declaration">var </aside>model_path <aside>– /static/regex</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L107"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 107"></a></h3><p>Pulls out model paths for DMM</p><h3 id="var/parsed_bounds"><aside class="declaration">var </aside>parsed_bounds <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L92"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 92"></a></h3><p>Unoffset bounds. Null on parse failure.</p><h3 id="var/turf_blacklist"><aside class="declaration">var </aside>turf_blacklist <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L97"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 97"></a></h3><p>any turf in this list is skipped inside of build_coordinate. Lazy assoc list</p><h3 id="var/var_edits_tgm"><aside class="declaration">var </aside>var_edits_tgm <aside>– /static/regex</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L105"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 105"></a></h3><p>Pulls out key value pairs for TGM</p><h2 id="proc">Proc Details</h2><h3 id="proc/New">New<aside>(tfile, x_lower, x_upper, y_lower, y_upper, z_lower, z_upper, measureOnly)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L178"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 178"></a></aside></h3><p>Parse a map, possibly cropping it.</p><h3 id="proc/_dmm_load"><aside class="declaration">proc </aside>_dmm_load<aside>(x_offset, y_offset, z_offset, crop_map, no_changeturf, x_lower, x_upper, y_lower, y_upper, z_lower, z_upper, place_on_top, new_z)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L526"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 526"></a></aside></h3><p>Stanrdard loading, not used in production
Doesn't take advantage of any tgm optimizations, which makes it slower but also more general
Use this if for some reason your map format is messy</p><h3 id="proc/check_for_errors"><aside class="declaration">proc </aside>check_for_errors<aside>()  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/verify.dm#L66"><img src="git.png" width="16" height="16" title="code/modules/mapping/verify.dm 66"></a></aside></h3><p>Check a parsed but not yet loaded map for errors.</p>
<p>Returns a <a href="datum/map_report.html" title="/datum/map_report">/datum/map_report</a> if there are errors or <code>FALSE</code> otherwise.</p><h3 id="proc/dmm_build_cache"><aside class="declaration">proc </aside>dmm_build_cache<aside>(no_changeturf, bad_paths)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L813"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 813"></a></aside></h3><p>Builds key caches for general formats
Slower then the proc above, tho it could still be optimized slightly. it's just not a priority
Since we don't run DMM maps, ever.</p><h3 id="proc/filter_grid_sets_based_on_z_bounds"><aside class="declaration">proc </aside>filter_grid_sets_based_on_z_bounds<aside>(lower_z, upper_z)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L297"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 297"></a></aside></h3><p>Iterates over all grid sets and returns ones with z values within the given bounds. Inclusive</p><h3 id="proc/load"><aside class="declaration">proc </aside>load<aside>(x_offset, y_offset, z_offset, crop_map, no_changeturf, x_lower, x_upper, y_lower, y_upper, z_lower, z_upper, place_on_top, new_z)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/modules/mapping/reader.dm#L308"><img src="git.png" width="16" height="16" title="code/modules/mapping/reader.dm 308"></a></aside></h3><p>Load the parsed map into the world. You probably want <a href="global.html#proc/load_map" title="/global">/proc/load_map</a>. Keep the signature the same.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/c41b333c9bc46606d2c5d5b517f7836d5953fbfd">c41b333</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>