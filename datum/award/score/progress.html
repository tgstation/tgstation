<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/award/score/progress - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/award/score/progress.html#var">Var Details</a> - <a href="datum/award/score/progress.html#proc">Proc Details</a></header><main><h1>progress <aside>/<a href="datum.html">datum</a>/<a href="datum/award.html">award</a>/<a href="datum/award/score/progress.html">score/progress</a></aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L242"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 242"></a></h1><p>A subtype of score linked to a schema table containing objects the player has caught, made, found or otherwise achieved.
The value of the score should equal to the length of objects that have been achieved.
It also has an unique tab in the UI that lets you review the progress.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/award/score/progress.html#var/changed_entries">changed_entries</a></th><td>When get_changed_rows is called, this list gets filled with the entries to be mass-inserted
in the table associated with this progress score.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/award/score/progress.html#proc/get_changed_rows">get_changed_rows</a></th><td>Along with the changed rows for the main table, this also populates changed_entries with the entries list</td></tr><tr><th><a href="datum/award/score/progress.html#proc/get_progress">get_progress</a></th><td>Returns a list of data that we can use to make an index of contents that progress this award/score.</td></tr><tr><th><a href="datum/award/score/progress.html#proc/get_raw_value">get_raw_value</a></th><td>We don't care much about the default value, which is only used for high scores. Instead, we get the entries string from the db.</td></tr><tr><th><a href="datum/award/score/progress.html#proc/get_table">get_table</a></th><td>Getter proc for the table used to save the entries - ckey association.
so we an be extra-safe that data won't be ever inserted in the wrong table.
Remember to set this</td></tr><tr><th><a href="datum/award/score/progress.html#proc/insert_entries">insert_entries</a></th><td>Called once the achievements are saved in the DB, since we also have to insert the entries in the associated table.</td></tr><tr><th><a href="datum/award/score/progress.html#proc/validate_entries">validate_entries</a></th><td>Validates the list of entries after it's parsed.
If TRUE is returned (entries list is valid), 'entries' will be stored in both
original_cached_data[type] and data[type] of the achievements holder.
Otherwise data[type] will be the new validated_entries list,
ensuring that the original data and the new data aren't the same, allowing the new data will be saved.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/changed_entries"><aside class="declaration">var </aside>changed_entries <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L247"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 247"></a></h3><p>When get_changed_rows is called, this list gets filled with the entries to be mass-inserted
in the table associated with this progress score.</p><h2 id="proc">Proc Details</h2><h3 id="proc/get_changed_rows"><aside class="parent"><a title="/datum/award" href="datum/award.html#proc/get_changed_rows">↑</a></aside>get_changed_rows<aside>(/<a href="datum.html">datum</a>/<a href="datum/achievement_data.html">achievement_data</a>/holder)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L301"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 301"></a></aside></h3><p>Along with the changed rows for the main table, this also populates changed_entries with the entries list</p><h3 id="proc/get_progress"><aside class="declaration">proc </aside>get_progress<aside>(/<a href="datum.html">datum</a>/<a href="datum/achievement_data.html">achievement_data</a>/holder)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L351"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 351"></a></aside></h3><p>Returns a list of data that we can use to make an index of contents that progress this award/score.</p><h3 id="proc/get_raw_value"><aside class="parent"><a title="/datum/award" href="datum/award.html#proc/get_raw_value">↑</a></aside>get_raw_value<aside>(key)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L318"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 318"></a></aside></h3><p>We don't care much about the default value, which is only used for high scores. Instead, we get the entries string from the db.</p><h3 id="proc/get_table"><aside class="declaration">proc </aside>get_table<aside>()  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L260"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 260"></a></aside></h3><p>Getter proc for the table used to save the entries - ckey association.
so we an be extra-safe that data won't be ever inserted in the wrong table.
Remember to set this</p><h3 id="proc/insert_entries"><aside class="declaration">proc </aside>insert_entries<aside>(/<a href="datum.html">datum</a>/source)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L355"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 355"></a></aside></h3><p>Called once the achievements are saved in the DB, since we also have to insert the entries in the associated table.</p><h3 id="proc/validate_entries"><aside class="declaration">proc </aside>validate_entries<aside>(/list/entries, /list/validated_entries)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/achievements/_awards.dm#L346"><img src="git.png" width="16" height="16" title="code/datums/achievements/_awards.dm 346"></a></aside></h3><p>Validates the list of entries after it's parsed.
If TRUE is returned (entries list is valid), 'entries' will be stored in both
original_cached_data[type] and data[type] of the achievements holder.
Otherwise data[type] will be the new validated_entries list,
ensuring that the original data and the new data aren't the same, allowing the new data will be saved.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/c41b333c9bc46606d2c5d5b517f7836d5953fbfd">c41b333</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>