<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/ctf_controller - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/ctf_controller.html#var">Var Details</a> - <a href="datum/ctf_controller.html#proc">Proc Details</a></header><main><h1>ctf_controller <aside>/<a href="datum.html">datum</a>/<a href="datum/ctf_controller.html">ctf_controller</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L5"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 5"></a></h1><p>The CTF controller acts as a manager for an individual CTF game, each CTF game should have its own, the controller should handle all game-wide functionality.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/ctf_controller.html#var/auto_restart">auto_restart</a></th><td>When this CTF match ends should it automatically restart.</td></tr><tr><th><a href="datum/ctf_controller.html#var/barricades">barricades</a></th><td>List of all barricades that have been destroyed during this CTF game.</td></tr><tr><th><a href="datum/ctf_controller.html#var/control_points">control_points</a></th><td>List of all control points used by the game, if they exist.</td></tr><tr><th><a href="datum/ctf_controller.html#var/ctf_enabled">ctf_enabled</a></th><td>Whether or not this CTF game is running.</td></tr><tr><th><a href="datum/ctf_controller.html#var/game_id">game_id</a></th><td>The ID associated with this CTF game.</td></tr><tr><th><a href="datum/ctf_controller.html#var/instagib_mode">instagib_mode</a></th><td>Weather or not instagib mode has been enabled.</td></tr><tr><th><a href="datum/ctf_controller.html#var/points_to_win">points_to_win</a></th><td>How many points a team needs to win.</td></tr><tr><th><a href="datum/ctf_controller.html#var/respawn_cooldown">respawn_cooldown</a></th><td>How long till players who die can respawn.</td></tr><tr><th><a href="datum/ctf_controller.html#var/teams">teams</a></th><td>List of all team_datums participating in this game.</td></tr><tr><th><a href="datum/ctf_controller.html#var/victory_rejoin_text">victory_rejoin_text</a></th><td>The text shown once this CTF match ends.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/ctf_controller.html#proc/add_player">add_player</a></th><td>Adds a player and a reference to their player component to the corresponding team.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/add_team">add_team</a></th><td>Add an additional team to the current CTF game.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/capture_flag">capture_flag</a></th><td>Called when a flag is captured by the provided team. Messages players telling them who scored a point and if points are high enough declares victory.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/clear_control_points">clear_control_points</a></th><td>Marks all control points as neutral, called when a CTF match ends.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/control_point_scoring">control_point_scoring</a></th><td>Called when points are scored at a control point. Messages players telling them when a team is half way to winning and if points are high enough declares victory.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/get_all_players">get_all_players</a></th><td>Returns a list of all players in all teams.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/get_player_component">get_player_component</a></th><td>Returns a reference to a players component (if it exists) when provided with a player's ckey</td></tr><tr><th><a href="datum/ctf_controller.html#proc/get_players">get_players</a></th><td>Returns a list of all players in the provided team.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/get_points">get_points</a></th><td>Returns the current amount of points the provided team has.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/message_all_teams">message_all_teams</a></th><td>Sends a message to all players in all CTF teams in this game.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/remove_team">remove_team</a></th><td>Called when a spawner is deleted, removes the team from this datum.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/respawn_barricades">respawn_barricades</a></th><td>Respawns all barricades destroyed during the current CTF game, called when the match ends.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/setup_rules">setup_rules</a></th><td>Some CTF maps may require alternate rulesets, this proc is called by the medisim spawners and CTF maploading.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/team_valid_to_join">team_valid_to_join</a></th><td>Identifies if the provided team is a valid team to join for the provided player.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/toggle_instagib_mode">toggle_instagib_mode</a></th><td>Enables and disables instagib mode in this game. During instagib mode respawns are faster, players are faster and people die faster (instant).</td></tr><tr><th><a href="datum/ctf_controller.html#proc/unload_ctf">unload_ctf</a></th><td>Unloading CTF removes the map entirely and allows for a new map to be loaded in its place.</td></tr><tr><th><a href="datum/ctf_controller.html#proc/victory">victory</a></th><td>Ends the current CTF game and informs all players which team won. Restarts CTF if auto_restart is enabled.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/auto_restart"><aside class="declaration">var </aside>auto_restart <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L23"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 23"></a></h3><p>When this CTF match ends should it automatically restart.</p><h3 id="var/barricades"><aside class="declaration">var </aside>barricades <aside>– /list/<a href="obj.html">obj</a>/effect/ctf/dead_barricade</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L15"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 15"></a></h3><p>List of all barricades that have been destroyed during this CTF game.</p><h3 id="var/control_points"><aside class="declaration">var </aside>control_points <aside>– /list/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/ctf.html">ctf</a>/<a href="obj/machinery/ctf/control_point.html">control_point</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L13"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 13"></a></h3><p>List of all control points used by the game, if they exist.</p><h3 id="var/ctf_enabled"><aside class="declaration">var </aside>ctf_enabled <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L9"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 9"></a></h3><p>Whether or not this CTF game is running.</p><h3 id="var/game_id"><aside class="declaration">var </aside>game_id <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L7"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 7"></a></h3><p>The ID associated with this CTF game.</p><h3 id="var/instagib_mode"><aside class="declaration">var </aside>instagib_mode <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L25"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 25"></a></h3><p>Weather or not instagib mode has been enabled.</p><h3 id="var/points_to_win"><aside class="declaration">var </aside>points_to_win <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L19"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 19"></a></h3><p>How many points a team needs to win.</p><h3 id="var/respawn_cooldown"><aside class="declaration">var </aside>respawn_cooldown <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L17"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 17"></a></h3><p>How long till players who die can respawn.</p><h3 id="var/teams"><aside class="declaration">var </aside>teams <aside>– /list/<a href="datum.html">datum</a>/<a href="datum/ctf_team.html">ctf_team</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L11"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 11"></a></h3><p>List of all team_datums participating in this game.</p><h3 id="var/victory_rejoin_text"><aside class="declaration">var </aside>victory_rejoin_text <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L21"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 21"></a></h3><p>The text shown once this CTF match ends.</p><h2 id="proc">Proc Details</h2><h3 id="proc/add_player"><aside class="declaration">proc </aside>add_player<aside>(team_color, ckey, /<a href="datum.html">datum</a>/<a href="datum/component.html">component</a>/<a href="datum/component/ctf_player.html">ctf_player</a>/new_team_member)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L94"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 94"></a></aside></h3><p>Adds a player and a reference to their player component to the corresponding team.</p><h3 id="proc/add_team"><aside class="declaration">proc </aside>add_team<aside>(/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/ctf.html">ctf</a>/<a href="obj/machinery/ctf/spawner.html">spawner</a>/spawner)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L81"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 81"></a></aside></h3><p>Add an additional team to the current CTF game.</p><h3 id="proc/capture_flag"><aside class="declaration">proc </aside>capture_flag<aside>(team_color, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, team_span, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/ctf_flag.html">ctf_flag</a>/flag)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L128"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 128"></a></aside></h3><p>Called when a flag is captured by the provided team. Messages players telling them who scored a point and if points are high enough declares victory.</p><h3 id="proc/clear_control_points"><aside class="declaration">proc </aside>clear_control_points<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L161"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 161"></a></aside></h3><p>Marks all control points as neutral, called when a CTF match ends.</p><h3 id="proc/control_point_scoring"><aside class="declaration">proc </aside>control_point_scoring<aside>(team_color, points)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L135"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 135"></a></aside></h3><p>Called when points are scored at a control point. Messages players telling them when a team is half way to winning and if points are high enough declares victory.</p><h3 id="proc/get_all_players"><aside class="declaration">proc </aside>get_all_players<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L106"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 106"></a></aside></h3><p>Returns a list of all players in all teams.</p><h3 id="proc/get_player_component"><aside class="declaration">proc </aside>get_player_component<aside>(team_color, ckey)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L98"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 98"></a></aside></h3><p>Returns a reference to a players component (if it exists) when provided with a player's ckey</p><h3 id="proc/get_players"><aside class="declaration">proc </aside>get_players<aside>(team_color)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L102"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 102"></a></aside></h3><p>Returns a list of all players in the provided team.</p><h3 id="proc/get_points"><aside class="declaration">proc </aside>get_points<aside>(team_color)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L143"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 143"></a></aside></h3><p>Returns the current amount of points the provided team has.</p><h3 id="proc/message_all_teams"><aside class="declaration">proc </aside>message_all_teams<aside>(message)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L172"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 172"></a></aside></h3><p>Sends a message to all players in all CTF teams in this game.</p><h3 id="proc/remove_team"><aside class="declaration">proc </aside>remove_team<aside>(team_color)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L87"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 87"></a></aside></h3><p>Called when a spawner is deleted, removes the team from this datum.</p><h3 id="proc/respawn_barricades"><aside class="declaration">proc </aside>respawn_barricades<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L166"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 166"></a></aside></h3><p>Respawns all barricades destroyed during the current CTF game, called when the match ends.</p><h3 id="proc/setup_rules"><aside class="declaration">proc </aside>setup_rules<aside>(points_to_win, victory_rejoin_text, auto_restart)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L71"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 71"></a></aside></h3><p>Some CTF maps may require alternate rulesets, this proc is called by the medisim spawners and CTF maploading.</p><h3 id="proc/team_valid_to_join"><aside class="declaration">proc </aside>team_valid_to_join<aside>(team_color, /<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L113"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 113"></a></aside></h3><p>Identifies if the provided team is a valid team to join for the provided player.</p><h3 id="proc/toggle_instagib_mode"><aside class="declaration">proc </aside>toggle_instagib_mode<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L177"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 177"></a></aside></h3><p>Enables and disables instagib mode in this game. During instagib mode respawns are faster, players are faster and people die faster (instant).</p><h3 id="proc/unload_ctf"><aside class="declaration">proc </aside>unload_ctf<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L64"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 64"></a></aside></h3><p>Unloading CTF removes the map entirely and allows for a new map to be loaded in its place.</p><h3 id="proc/victory"><aside class="declaration">proc </aside>victory<aside>(winning_team)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/capture_the_flag/ctf_controller.dm#L147"><img src="git.png" width="16" height="16" title="code/modules/capture_the_flag/ctf_controller.dm 147"></a></aside></h3><p>Ends the current CTF game and informs all players which team won. Restarts CTF if auto_restart is enabled.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>