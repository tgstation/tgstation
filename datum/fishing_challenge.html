<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/fishing_challenge - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/fishing_challenge.html#var">Var Details</a> - <a href="datum/fishing_challenge.html#proc">Proc Details</a></header><main><h1>fishing_challenge <aside>/<a href="datum.html">datum</a>/<a href="datum/fishing_challenge.html">fishing_challenge</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L37"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 37"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/fishing_challenge.html#var/active_effect_cd">active_effect_cd</a></th><td>The cooldown between switching active effects</td></tr><tr><th><a href="datum/fishing_challenge.html#var/active_effects">active_effects</a></th><td>A list of possible active minigame effects. If not empty, one will be picked from time to time.</td></tr><tr><th><a href="datum/fishing_challenge.html#var/background">background</a></th><td>Background icon state from fishing_hud.dmi</td></tr><tr><th><a href="datum/fishing_challenge.html#var/bait_bounce_mult">bait_bounce_mult</a></th><td>By how much the bait recoils back when hitting the bounds of the slider while idle. Should be never above 1</td></tr><tr><th><a href="datum/fishing_challenge.html#var/bait_height">bait_height</a></th><td>How much space the bait takes on the minigame slider</td></tr><tr><th><a href="datum/fishing_challenge.html#var/bait_pixel_height">bait_pixel_height</a></th><td>The height in pixels of the bait bar</td></tr><tr><th><a href="datum/fishing_challenge.html#var/bait_position">bait_position</a></th><td>The position of the bait on the minigame slider</td></tr><tr><th><a href="datum/fishing_challenge.html#var/bait_velocity">bait_velocity</a></th><td>The current speed the bait is moving at</td></tr><tr><th><a href="datum/fishing_challenge.html#var/completed">completed</a></th><td>Is it finished (either by win/lose or window closing)</td></tr><tr><th><a href="datum/fishing_challenge.html#var/completion">completion</a></th><td>The completion score. If it reaches 100, it's a win. If it reaches 0, it's a loss.</td></tr><tr><th><a href="datum/fishing_challenge.html#var/completion_gain">completion_gain</a></th><td>How much completion is gained per second when the bait area is intersecting with the fish's</td></tr><tr><th><a href="datum/fishing_challenge.html#var/completion_loss">completion_loss</a></th><td>How much completion is lost per second when the bait area is not intersecting with the fish's</td></tr><tr><th><a href="datum/fishing_challenge.html#var/current_active_effect">current_active_effect</a></th><td>The current active effect</td></tr><tr><th><a href="datum/fishing_challenge.html#var/deceleration_mult">deceleration_mult</a></th><td>The multiplier of deceleration of velocity that happens when the bait switches direction</td></tr><tr><th><a href="datum/fishing_challenge.html#var/difficulty">difficulty</a></th><td>Minigame difficulty</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fish_height">fish_height</a></th><td>How much space the fish takes on the minigame slider</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fish_icon">fish_icon</a></th><td>Fish icon state from fishing_hud.dmi</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fish_pixel_height">fish_pixel_height</a></th><td>The height in pixels of the fish</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fish_position">fish_position</a></th><td>The position of the fish on the minigame slider</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fish_source">fish_source</a></th><td>Keep track of the fish source from which we're pulling the reward</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fishing_hud">fishing_hud</a></th><td>The background as shown in the minigame, and the holder of the other visual overlays</td></tr><tr><th><a href="datum/fishing_challenge.html#var/fishing_line">fishing_line</a></th><td>Fishing line visual</td></tr><tr><th><a href="datum/fishing_challenge.html#var/float">float</a></th><td>float visual</td></tr><tr><th><a href="datum/fishing_challenge.html#var/gravity_velocity">gravity_velocity</a></th><td>The acceleration of the bait while not reeling</td></tr><tr><th><a href="datum/fishing_challenge.html#var/last_baiting_click">last_baiting_click</a></th><td>The last time we clicked during the baiting phase</td></tr><tr><th><a href="datum/fishing_challenge.html#var/location">location</a></th><td>The physical fishing spot our float is hovering</td></tr><tr><th><a href="datum/fishing_challenge.html#var/next_phase_timer">next_phase_timer</a></th><td>Timer for the next phase</td></tr><tr><th><a href="datum/fishing_challenge.html#var/overlap_velocity_mult">overlap_velocity_mult</a></th><td>Multiplier of the velocity applied when the bait is overlapping the fish</td></tr><tr><th><a href="datum/fishing_challenge.html#var/phase">phase</a></th><td>Current phase</td></tr><tr><th><a href="datum/fishing_challenge.html#var/reeling_state">reeling_state</a></th><td>Whether the bait is idle or reeling up or down (left and right click)</td></tr><tr><th><a href="datum/fishing_challenge.html#var/reeling_velocity">reeling_velocity</a></th><td>The acceleration of the bait while reeling</td></tr><tr><th><a href="datum/fishing_challenge.html#var/reward_path">reward_path</a></th><td>Result path</td></tr><tr><th><a href="datum/fishing_challenge.html#var/special_effects">special_effects</a></th><td>Rule modifiers (eg weighted bait)</td></tr><tr><th><a href="datum/fishing_challenge.html#var/start_time">start_time</a></th><td>When the ui minigame phase started</td></tr><tr><th><a href="datum/fishing_challenge.html#var/used_rod">used_rod</a></th><td>Rod that is used for the challenge</td></tr><tr><th><a href="datum/fishing_challenge.html#var/user">user</a></th><td>Fishing mob</td></tr><tr><th><a href="datum/fishing_challenge.html#var/wait_time_range">wait_time_range</a></th><td>The lower and upper bounds of the waiting phase timer</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/fishing_challenge.html#proc/get_stack_trace">get_stack_trace</a></th><td>Throws a stack with prefixed text.</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/interrupt">interrupt</a></th><td>Challenge interrupted by something external</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/move_bait">move_bait</a></th><td>The proc that moves the bait around, just like in the old TGUI, mostly.</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/on_user_logout">on_user_logout</a></th><td>The player is no longer around to play the minigame, so we interrupt it.</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/prepare_minigame_hud">prepare_minigame_hud</a></th><td>Initialize the minigame hud and register some signals to make it work.</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/process">process</a></th><td>Update the state of the fish, the bait and the hud</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/register_reward_signals">register_reward_signals</a></th><td>Proc responsible for registering the signals for difficulty, possible reward, and challenge completion.
Call this if you want to override the fish source from which we roll rewards (preferably before the minigame phase).</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/remove_minigame_hud">remove_minigame_hud</a></th><td>Stop processing and remove references to the minigame hud</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/select_active_effect">select_active_effect</a></th><td>The proc that handles fancy effects like flipping the hud or skewing movement</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/set_lure_timers">set_lure_timers</a></th><td>Set the timers for lure that need to be spun at intervals.</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/start_minigame_phase">start_minigame_phase</a></th><td>Get the difficulty and other variables, than start the minigame</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/start_reeling">start_reeling</a></th><td>While the mouse button is held down, the bait will be reeling up (or down on r-click if the bidirectional rule is enabled)</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/stop_reeling">stop_reeling</a></th><td>Reset the reeling state to idle once the mouse button is released</td></tr><tr><th><a href="datum/fishing_challenge.html#proc/update_visuals">update_visuals</a></th><td>update the vertical pixel position of both fish and bait, and the icon state of the completion bar</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active_effect_cd"><aside class="declaration">var </aside>active_effect_cd <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L47"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 47"></a></h3><p>The cooldown between switching active effects</p><h3 id="var/active_effects"><aside class="declaration">var </aside>active_effects <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L45"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 45"></a></h3><p>A list of possible active minigame effects. If not empty, one will be picked from time to time.</p><h3 id="var/background"><aside class="declaration">var </aside>background <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L71"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 71"></a></h3><p>Background icon state from fishing_hud.dmi</p><h3 id="var/bait_bounce_mult"><aside class="declaration">var </aside>bait_bounce_mult <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L111"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 111"></a></h3><p>By how much the bait recoils back when hitting the bounds of the slider while idle. Should be never above 1</p><h3 id="var/bait_height"><aside class="declaration">var </aside>bait_height <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L83"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 83"></a></h3><p>How much space the bait takes on the minigame slider</p><h3 id="var/bait_pixel_height"><aside class="declaration">var </aside>bait_pixel_height <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L85"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 85"></a></h3><p>The height in pixels of the bait bar</p><h3 id="var/bait_position"><aside class="declaration">var </aside>bait_position <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L91"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 91"></a></h3><p>The position of the bait on the minigame slider</p><h3 id="var/bait_velocity"><aside class="declaration">var </aside>bait_velocity <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L93"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 93"></a></h3><p>The current speed the bait is moving at</p><h3 id="var/completed"><aside class="declaration">var </aside>completed <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L41"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 41"></a></h3><p>Is it finished (either by win/lose or window closing)</p><h3 id="var/completion"><aside class="declaration">var </aside>completion <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L96"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 96"></a></h3><p>The completion score. If it reaches 100, it's a win. If it reaches 0, it's a loss.</p><h3 id="var/completion_gain"><aside class="declaration">var </aside>completion_gain <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L100"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 100"></a></h3><p>How much completion is gained per second when the bait area is intersecting with the fish's</p><h3 id="var/completion_loss"><aside class="declaration">var </aside>completion_loss <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L98"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 98"></a></h3><p>How much completion is lost per second when the bait area is not intersecting with the fish's</p><h3 id="var/current_active_effect"><aside class="declaration">var </aside>current_active_effect <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L49"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 49"></a></h3><p>The current active effect</p><h3 id="var/deceleration_mult"><aside class="declaration">var </aside>deceleration_mult <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L113"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 113"></a></h3><p>The multiplier of deceleration of velocity that happens when the bait switches direction</p><h3 id="var/difficulty"><aside class="declaration">var </aside>difficulty <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L53"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 53"></a></h3><p>Minigame difficulty</p><h3 id="var/fish_height"><aside class="declaration">var </aside>fish_height <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L81"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 81"></a></h3><p>How much space the fish takes on the minigame slider</p><h3 id="var/fish_icon"><aside class="declaration">var </aside>fish_icon <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L73"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 73"></a></h3><p>Fish icon state from fishing_hud.dmi</p><h3 id="var/fish_pixel_height"><aside class="declaration">var </aside>fish_pixel_height <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L87"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 87"></a></h3><p>The height in pixels of the fish</p><h3 id="var/fish_position"><aside class="declaration">var </aside>fish_position <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L89"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 89"></a></h3><p>The position of the fish on the minigame slider</p><h3 id="var/fish_source"><aside class="declaration">var </aside>fish_source <aside>– /<a href="datum.html">datum</a>/<a href="datum/fish_source.html">fish_source</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L121"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 121"></a></h3><p>Keep track of the fish source from which we're pulling the reward</p><h3 id="var/fishing_hud"><aside class="declaration">var </aside>fishing_hud <aside>– /<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/<a href="atom/movable/screen.html">screen</a>/<a href="atom/movable/screen/fishing_hud.html">fishing_hud</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L118"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 118"></a></h3><p>The background as shown in the minigame, and the holder of the other visual overlays</p><h3 id="var/fishing_line"><aside class="declaration">var </aside>fishing_line <aside>– /<a href="datum.html">datum</a>/<a href="datum/beam.html">beam</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L76"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 76"></a></h3><p>Fishing line visual</p><h3 id="var/float"><aside class="declaration">var </aside>float <aside>– /<a href="obj.html">obj</a>/<a href="obj/effect/fishing_float.html">effect/fishing_float</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L67"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 67"></a></h3><p>float visual</p><h3 id="var/gravity_velocity"><aside class="declaration">var </aside>gravity_velocity <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L107"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 107"></a></h3><p>The acceleration of the bait while not reeling</p><h3 id="var/last_baiting_click"><aside class="declaration">var </aside>last_baiting_click <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L61"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 61"></a></h3><p>The last time we clicked during the baiting phase</p><h3 id="var/location"><aside class="declaration">var </aside>location <aside>– /<a href="atom.html">atom</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L69"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 69"></a></h3><p>The physical fishing spot our float is hovering</p><h3 id="var/next_phase_timer"><aside class="declaration">var </aside>next_phase_timer <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L57"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 57"></a></h3><p>Timer for the next phase</p><h3 id="var/overlap_velocity_mult"><aside class="declaration">var </aside>overlap_velocity_mult <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L115"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 115"></a></h3><p>Multiplier of the velocity applied when the bait is overlapping the fish</p><h3 id="var/phase"><aside class="declaration">var </aside>phase <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L55"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 55"></a></h3><p>Current phase</p><h3 id="var/reeling_state"><aside class="declaration">var </aside>reeling_state <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L105"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 105"></a></h3><p>Whether the bait is idle or reeling up or down (left and right click)</p><h3 id="var/reeling_velocity"><aside class="declaration">var </aside>reeling_velocity <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L109"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 109"></a></h3><p>The acceleration of the bait while reeling</p><h3 id="var/reward_path"><aside class="declaration">var </aside>reward_path <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L51"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 51"></a></h3><p>Result path</p><h3 id="var/special_effects"><aside class="declaration">var </aside>special_effects <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L43"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 43"></a></h3><p>Rule modifiers (eg weighted bait)</p><h3 id="var/start_time"><aside class="declaration">var </aside>start_time <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L39"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 39"></a></h3><p>When the ui minigame phase started</p><h3 id="var/used_rod"><aside class="declaration">var </aside>used_rod <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/fishing_rod.html">fishing_rod</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L65"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 65"></a></h3><p>Rod that is used for the challenge</p><h3 id="var/user"><aside class="declaration">var </aside>user <aside>– /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L63"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 63"></a></h3><p>Fishing mob</p><h3 id="var/wait_time_range"><aside class="declaration">var </aside>wait_time_range <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L59"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 59"></a></h3><p>The lower and upper bounds of the waiting phase timer</p><h2 id="proc">Proc Details</h2><h3 id="proc/get_stack_trace"><aside class="declaration">proc </aside>get_stack_trace<aside>(init_text)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L612"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 612"></a></aside></h3><p>Throws a stack with prefixed text.</p><h3 id="proc/interrupt"><aside class="declaration">proc </aside>interrupt<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L333"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 333"></a></aside></h3><p>Challenge interrupted by something external</p><h3 id="proc/move_bait"><aside class="declaration">proc </aside>move_bait<aside>(seconds_per_tick)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L714"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 714"></a></aside></h3><p>The proc that moves the bait around, just like in the old TGUI, mostly.</p><h3 id="proc/on_user_logout"><aside class="declaration">proc </aside>on_user_logout<aside>(/<a href="datum.html">datum</a>/source)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L488"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 488"></a></aside></h3><p>The player is no longer around to play the minigame, so we interrupt it.</p><h3 id="proc/prepare_minigame_hud"><aside class="declaration">proc </aside>prepare_minigame_hud<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L630"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 630"></a></aside></h3><p>Initialize the minigame hud and register some signals to make it work.</p><h3 id="proc/process"><aside class="parent"><a title="/datum" href="datum.html#proc/process">↑</a></aside>process<aside>(seconds_per_tick)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L665"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 665"></a></aside></h3><p>Update the state of the fish, the bait and the hud</p><h3 id="proc/register_reward_signals"><aside class="declaration">proc </aside>register_reward_signals<aside>(/<a href="datum.html">datum</a>/<a href="datum/fish_source.html">fish_source</a>/new_fish_source)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L199"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 199"></a></aside></h3><p>Proc responsible for registering the signals for difficulty, possible reward, and challenge completion.
Call this if you want to override the fish source from which we roll rewards (preferably before the minigame phase).</p><h3 id="proc/remove_minigame_hud"><aside class="declaration">proc </aside>remove_minigame_hud<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L645"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 645"></a></aside></h3><p>Stop processing and remove references to the minigame hud</p><h3 id="proc/select_active_effect"><aside class="declaration">proc </aside>select_active_effect<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L674"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 674"></a></aside></h3><p>The proc that handles fancy effects like flipping the hud or skewing movement</p><h3 id="proc/set_lure_timers"><aside class="declaration">proc </aside>set_lure_timers<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L246"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 246"></a></aside></h3><p>Set the timers for lure that need to be spun at intervals.</p><h3 id="proc/start_minigame_phase"><aside class="declaration">proc </aside>start_minigame_phase<aside>(auto_reel)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L548"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 548"></a></aside></h3><p>Get the difficulty and other variables, than start the minigame</p><h3 id="proc/start_reeling"><aside class="declaration">proc </aside>start_reeling<aside>(/<a href="client.html">client</a>/source, /<a href="datum.html">datum</a>/object, location, control, params)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L650"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 650"></a></aside></h3><p>While the mouse button is held down, the bait will be reeling up (or down on r-click if the bidirectional rule is enabled)</p><h3 id="proc/stop_reeling"><aside class="declaration">proc </aside>stop_reeling<aside>(/<a href="client.html">client</a>/source, /<a href="datum.html">datum</a>/object, location, control, params)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L660"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 660"></a></aside></h3><p>Reset the reeling state to idle once the mouse button is released</p><h3 id="proc/update_visuals"><aside class="declaration">proc </aside>update_visuals<aside>(seconds_per_tick)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/fishing/fishing_minigame.dm#L794"><img src="git.png" width="16" height="16" title="code/modules/fishing/fishing_minigame.dm 794"></a></aside></h3><p>update the vertical pixel position of both fish and bait, and the icon state of the completion bar</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>