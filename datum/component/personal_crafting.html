<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/component/personal_crafting - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/component/personal_crafting.html#var">Var Details</a> - <a href="datum/component/personal_crafting.html#proc">Proc Details</a></header><main><h1>personal_crafting <aside>/<a href="datum.html">datum</a>/<a href="datum/component.html">component</a>/<a href="datum/component/personal_crafting.html">personal_crafting</a></aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L12"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 12"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/component/personal_crafting.html#var/ignored_flags">ignored_flags</a></th><td>crafting flags we ignore when considering a recipe</td></tr><tr><th><a href="datum/component/personal_crafting.html#var/screen_loc_override">screen_loc_override</a></th><td>Custom screen_loc for our element</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/component/personal_crafting.html#proc/check_contents">check_contents</a></th><td>Check that the contents of the recipe meet the requirements.</td></tr><tr><th><a href="datum/component/personal_crafting.html#proc/check_tools">check_tools</a></th><td>Returns a boolean on whether the tool requirements of the input recipe are satisfied by the input source and surroundings.</td></tr><tr><th><a href="datum/component/personal_crafting.html#proc/get_used_reqs">get_used_reqs</a></th><td>get_used_reqs works like this:
Loop over reqs var of the recipe
Set var amt to the value current cycle req is pointing to, its amount of type we need to delete
Get var/surroundings list of things accessable to crafting by get_environment()
Check the type of the current cycle req</td></tr><tr><th><a href="datum/component/personal_crafting.html#proc/perform_all_checks">perform_all_checks</a></th><td>This proc performs all the necessary conditional control statement to ensure that the object is allowed to be crafted by the crafter.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/ignored_flags"><aside class="declaration">var </aside>ignored_flags <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L43"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 43"></a></h3><p>crafting flags we ignore when considering a recipe</p><h3 id="var/screen_loc_override"><aside class="declaration">var </aside>screen_loc_override <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L14"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 14"></a></h3><p>Custom screen_loc for our element</p><h2 id="proc">Proc Details</h2><h3 id="proc/check_contents"><aside class="declaration">proc </aside>check_contents<aside>(/<a href="atom.html">atom</a>/a, /<a href="datum.html">datum</a>/<a href="datum/crafting_recipe.html">crafting_recipe</a>/recipe, /list/contents)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L61"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 61"></a></aside></h3><p>Check that the contents of the recipe meet the requirements.</p>
<p>user: The /mob that initated the crafting.
recipe: The /datum/crafting_recipe being attempted.
contents: List of items to search for the recipe's reqs.</p><h3 id="proc/check_tools"><aside class="declaration">proc </aside>check_tools<aside>(/<a href="atom.html">atom</a>/source, /<a href="datum.html">datum</a>/<a href="datum/crafting_recipe.html">crafting_recipe</a>/recipe, /list/surroundings, final_check)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L184"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 184"></a></aside></h3><p>Returns a boolean on whether the tool requirements of the input recipe are satisfied by the input source and surroundings.</p><h3 id="proc/get_used_reqs"><aside class="declaration">proc </aside>get_used_reqs<aside>(/<a href="datum.html">datum</a>/<a href="datum/crafting_recipe.html">crafting_recipe</a>/recipe, /<a href="atom.html">atom</a>/atom, /list/total_materials)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L363"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 363"></a></aside></h3><p>get_used_reqs works like this:
Loop over reqs var of the recipe
Set var amt to the value current cycle req is pointing to, its amount of type we need to delete
Get var/surroundings list of things accessable to crafting by get_environment()
Check the type of the current cycle req</p>
<ul>
<li>
<p>If its reagent then do a while loop, inside it try to locate() reagent containers, inside such containers try to locate needed reagent, if there isn't remove thing from surroundings</p>
</li>
<li>
<ul>
<li>Transfer a quantity (The required amount of the contained quantity, whichever is lower) of the reagent to the temporary reagents holder</li>
</ul>
</li>
<li>
<p>If it's a stack, create a tally stack and then transfer an amount of the stack to the stack until it reaches the required amount.</p>
</li>
<li>
<p>If it's anything else just locate() it in the list in a while loop, for each find reduce the amt var by 1 and put the found stuff in return list</p>
</li>
</ul>
<p>For stacks and items, the material composition is also tallied in total_materials, to be transferred to the result after that is spawned.</p>
<p>get_used_reqs returns the list of used required object the result will receive as argument of atom/CheckParts()
If one or some of the object types is in the 'parts' list of the recipe, they will be stored inside the contents of the result
The rest will instead be deleted by atom/CheckParts()</p><h3 id="proc/perform_all_checks"><aside class="declaration">proc </aside>perform_all_checks<aside>(/<a href="atom.html">atom</a>/crafter, /<a href="datum.html">datum</a>/<a href="datum/crafting_recipe.html">crafting_recipe</a>/recipe, /list/contents, check_tools_last)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/components/crafting/crafting.dm#L282"><img src="git.png" width="16" height="16" title="code/datums/components/crafting/crafting.dm 282"></a></aside></h3><p>This proc performs all the necessary conditional control statement to ensure that the object is allowed to be crafted by the crafter.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/c41b333c9bc46606d2c5d5b517f7836d5953fbfd">c41b333</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>