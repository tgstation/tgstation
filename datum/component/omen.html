<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/component/omen - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/component/omen.html#var">Var Details</a> - <a href="datum/component/omen.html#proc">Proc Details</a></header><main><h1>omen <aside>/<a href="datum.html">datum</a>/<a href="datum/component.html">component</a>/<a href="datum/component/omen.html">omen</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L9"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 9"></a></h1><p>omen.dm: For when you want someone to have a really bad day</p>
<p>When you attach an omen component to someone, they start running the risk of all sorts of bad environmental injuries, like nearby vending machines randomly falling on you,
or hitting your head really hard when you slip and fall, or you get shocked by the tram rails at an unfortunate moment.</p>
<p>Omens are removed once the victim is either maimed by one of the possible injuries, or if they receive a blessing (read: bashing with a bible) from the chaplain.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/component/omen.html#var/damage_mod">damage_mod</a></th><td>Base damage from negative events. Cursed take 25% of this damage.</td></tr><tr><th><a href="datum/component/omen.html#var/incidents_left">incidents_left</a></th><td>How many incidents are left. If 0 exactly, it will get deleted.</td></tr><tr><th><a href="datum/component/omen.html#var/luck_mod">luck_mod</a></th><td>Base probability of negative events. Cursed are half as unlucky.</td></tr><tr><th><a href="datum/component/omen.html#var/vessel">vessel</a></th><td>Whatever's causing the omen, if there is one. Destroying the vessel won't stop the omen, but we destroy the vessel (if one exists) upon the omen ending</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/component/omen.html#proc/InheritComponent">InheritComponent</a></th><td>This is a omen eat omen world! The stronger omen survives.</td></tr><tr><th><a href="datum/component/omen.html#proc/check_accident">check_accident</a></th><td>check_accident() is called each step we take</td></tr><tr><th><a href="datum/component/omen.html#proc/check_bless">check_bless</a></th><td>Hijack the mood system to see if we get the blessing mood event to cancel the omen</td></tr><tr><th><a href="datum/component/omen.html#proc/check_death">check_death</a></th><td>Severe deaths. Normally lifts the curse.</td></tr><tr><th><a href="datum/component/omen.html#proc/check_slip">check_slip</a></th><td>If we get knocked down, see if we have a really bad slip and bash our head hard</td></tr><tr><th><a href="datum/component/omen.html#proc/death_explode">death_explode</a></th><td>Creates a localized explosion that shakes the camera</td></tr><tr><th><a href="datum/component/omen.html#proc/vessel_qdeleting">vessel_qdeleting</a></th><td>Vessel got deleted, set it to null</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/damage_mod"><aside class="declaration">var </aside>damage_mod <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L18"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 18"></a></h3><p>Base damage from negative events. Cursed take 25% of this damage.</p><h3 id="var/incidents_left"><aside class="declaration">var </aside>incidents_left <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L14"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 14"></a></h3><p>How many incidents are left. If 0 exactly, it will get deleted.</p><h3 id="var/luck_mod"><aside class="declaration">var </aside>luck_mod <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L16"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 16"></a></h3><p>Base probability of negative events. Cursed are half as unlucky.</p><h3 id="var/vessel"><aside class="declaration">var </aside>vessel <aside>– /<a href="obj.html">obj</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L12"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 12"></a></h3><p>Whatever's causing the omen, if there is one. Destroying the vessel won't stop the omen, but we destroy the vessel (if one exists) upon the omen ending</p><h2 id="proc">Proc Details</h2><h3 id="proc/InheritComponent"><aside class="parent"><a title="/datum/component" href="datum/component.html#proc/InheritComponent">↑</a></aside>InheritComponent<aside>(/<a href="obj.html">obj</a>/vessel, incidents_left, luck_mod, damage_mod)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L39"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 39"></a></aside></h3><p>This is a omen eat omen world! The stronger omen survives.</p><h3 id="proc/check_accident"><aside class="declaration">proc </aside>check_accident<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/our_guy)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L86"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 86"></a></aside></h3><p>check_accident() is called each step we take</p>
<p>While we're walking around, roll to see if there's any environmental hazards on one of the adjacent tiles we can trigger.
We do the prob() at the beginning to A. add some tension for /when/ it will strike, and B. (more importantly) ameliorate the fact that we're checking up to 5 turfs's contents each time</p><h3 id="proc/check_bless"><aside class="declaration">proc </aside>check_bless<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/our_guy, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/priest, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/book.html">book</a>/<a href="obj/item/book/bible.html">bible</a>/bible, bless_result)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L221"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 221"></a></aside></h3><p>Hijack the mood system to see if we get the blessing mood event to cancel the omen</p><h3 id="proc/check_death"><aside class="declaration">proc </aside>check_death<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/our_guy)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L232"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 232"></a></aside></h3><p>Severe deaths. Normally lifts the curse.</p><h3 id="proc/check_slip"><aside class="declaration">proc </aside>check_slip<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/our_guy, amount)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L204"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 204"></a></aside></h3><p>If we get knocked down, see if we have a really bad slip and bash our head hard</p><h3 id="proc/death_explode"><aside class="declaration">proc </aside>death_explode<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/our_guy)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L241"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 241"></a></aside></h3><p>Creates a localized explosion that shakes the camera</p><h3 id="proc/vessel_qdeleting"><aside class="declaration">proc </aside>vessel_qdeleting<aside>(/<a href="atom.html">atom</a>/source)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/omen.dm#L248"><img src="git.png" width="16" height="16" title="code/datums/components/omen.dm 248"></a></aside></h3><p>Vessel got deleted, set it to null</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>