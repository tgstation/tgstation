<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/json_database - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/json_database.html#proc">Proc Details</a></header><main><h1>json_database <aside>/<a href="datum.html">datum</a>/<a href="datum/json_database.html">json_database</a></aside> <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L5"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 5"></a></h1><p>Represents a json file being used as a database in the data/ folder.
Changes made here will save back to the associated file, with recovery.
Will defer writes until later if multiple happen in the same tick.
Do not add an extra cache on top of this. This IS your cache.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/json_database.html#proc/get">get</a></th><td>Returns the cached data.
Be careful on holding onto this data for too long, as it can mutate when other stuff changes it.
Do not mutate it yourself.</td></tr><tr><th><a href="datum/json_database.html#proc/get_key">get_key</a></th><td>Returns the data with the given key.
For arrays, this is a number.
Be careful on holding onto this data for too long, as it can mutate when other stuff changes it.
Do not mutate it yourself.</td></tr><tr><th><a href="datum/json_database.html#proc/insert">insert</a></th><td>Inserts the data at the end of what is assumed to be an array, and queues a save.</td></tr><tr><th><a href="datum/json_database.html#proc/pick_and_take_key">pick_and_take_key</a></th><td>Picks the data of a random key and then removes that key from the database.
Since the list is no longer inside the database, you can mutate and use it as you like.</td></tr><tr><th><a href="datum/json_database.html#proc/remove">remove</a></th><td>Removes the data at the given item, and queues a save.
For dictionaries, this can be the key.
For arrays, this can be the value.</td></tr><tr><th><a href="datum/json_database.html#proc/replace">replace</a></th><td>Replaces the cache with the new data completely, and queues a save.
Do not touch the new data after passing it in.</td></tr><tr><th><a href="datum/json_database.html#proc/set_key">set_key</a></th><td>Sets the data at the key to the value, and queues a save.</td></tr></table><h2 id="proc">Proc Details</h2><h3 id="proc/get"><aside class="declaration">proc </aside>get<aside>()  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L54"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 54"></a></aside></h3><p>Returns the cached data.
Be careful on holding onto this data for too long, as it can mutate when other stuff changes it.
Do not mutate it yourself.</p><h3 id="proc/get_key"><aside class="declaration">proc </aside>get_key<aside>(key)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L61"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 61"></a></aside></h3><p>Returns the data with the given key.
For arrays, this is a number.
Be careful on holding onto this data for too long, as it can mutate when other stuff changes it.
Do not mutate it yourself.</p><h3 id="proc/insert"><aside class="declaration">proc </aside>insert<aside>(value)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L87"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 87"></a></aside></h3><p>Inserts the data at the end of what is assumed to be an array, and queues a save.</p><h3 id="proc/pick_and_take_key"><aside class="declaration">proc </aside>pick_and_take_key<aside>()  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L66"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 66"></a></aside></h3><p>Picks the data of a random key and then removes that key from the database.
Since the list is no longer inside the database, you can mutate and use it as you like.</p><h3 id="proc/remove"><aside class="declaration">proc </aside>remove<aside>(item)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L82"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 82"></a></aside></h3><p>Removes the data at the given item, and queues a save.
For dictionaries, this can be the key.
For arrays, this can be the value.</p><h3 id="proc/replace"><aside class="declaration">proc </aside>replace<aside>(/list/new_data)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L93"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 93"></a></aside></h3><p>Replaces the cache with the new data completely, and queues a save.
Do not touch the new data after passing it in.</p><h3 id="proc/set_key"><aside class="declaration">proc </aside>set_key<aside>(key, value)  <a href="https://github.com/tgstation/tgstation/blob/c41b333c9bc46606d2c5d5b517f7836d5953fbfd/code/datums/json_database.dm#L75"><img src="git.png" width="16" height="16" title="code/datums/json_database.dm 75"></a></aside></h3><p>Sets the data at the key to the value, and queues a save.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/c41b333c9bc46606d2c5d5b517f7836d5953fbfd">c41b333</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>