<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/pathfind/jps - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/pathfind/jps.html#var">Var Details</a> - <a href="datum/pathfind/jps.html#proc">Proc Details</a></header><main><h1>jps <aside>/<a href="datum.html">datum</a>/<a href="datum/pathfind.html">pathfind</a>/<a href="datum/pathfind/jps.html">jps</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L60"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 60"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/pathfind/jps.html#var/diagonal_handling">diagonal_handling</a></th><td>Defines how we handle diagonal moves. See __DEFINES/path.dm</td></tr><tr><th><a href="datum/pathfind/jps.html#var/end">end</a></th><td>The turf we're trying to path to (note that this won't track a moving target)</td></tr><tr><th><a href="datum/pathfind/jps.html#var/found_turfs">found_turfs</a></th><td>An assoc list that serves as the closed list. Key is the turf, points to true if we've seen it before</td></tr><tr><th><a href="datum/pathfind/jps.html#var/mintargetdist">mintargetdist</a></th><td>How far away we have to get to the end target before we can call it quits</td></tr><tr><th><a href="datum/pathfind/jps.html#var/open">open</a></th><td>The open list/stack we pop nodes out from (TODO: make this a normal list and macro-ize the heap operations to reduce proc overhead)</td></tr><tr><th><a href="datum/pathfind/jps.html#var/path">path</a></th><td>The list we compile at the end if successful to pass back</td></tr><tr><th><a href="datum/pathfind/jps.html#var/requester">requester</a></th><td>The movable we are pathing</td></tr><tr><th><a href="datum/pathfind/jps.html#var/skip_first">skip_first</a></th><td>If we should delete the first step in the path or not. Used often because it is just the starting tile</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/pathfind/jps.html#proc/diag_scan_spec">diag_scan_spec</a></th><td>For performing diagonal scans from a given starting turf.</td></tr><tr><th><a href="datum/pathfind/jps.html#proc/lateral_scan_spec">lateral_scan_spec</a></th><td>For performing lateral scans from a given starting turf.</td></tr><tr><th><a href="datum/pathfind/jps.html#proc/unwind_path">unwind_path</a></th><td>Called when we've hit the goal with the node that represents the last tile, then sets the path var to that path so it can be returned by [datum/pathfind/proc/search]</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/diagonal_handling"><aside class="declaration">var </aside>diagonal_handling <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L77"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 77"></a></h3><p>Defines how we handle diagonal moves. See __DEFINES/path.dm</p><h3 id="var/end"><aside class="declaration">var </aside>end <aside>– /<a href="turf.html">turf</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L64"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 64"></a></h3><p>The turf we're trying to path to (note that this won't track a moving target)</p><h3 id="var/found_turfs"><aside class="declaration">var </aside>found_turfs <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L70"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 70"></a></h3><p>An assoc list that serves as the closed list. Key is the turf, points to true if we've seen it before</p><h3 id="var/mintargetdist"><aside class="declaration">var </aside>mintargetdist <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L73"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 73"></a></h3><p>How far away we have to get to the end target before we can call it quits</p><h3 id="var/open"><aside class="declaration">var </aside>open <aside>– /<a href="datum.html">datum</a>/heap</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L66"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 66"></a></h3><p>The open list/stack we pop nodes out from (TODO: make this a normal list and macro-ize the heap operations to reduce proc overhead)</p><h3 id="var/path"><aside class="declaration">var </aside>path <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L68"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 68"></a></h3><p>The list we compile at the end if successful to pass back</p><h3 id="var/requester"><aside class="declaration">var </aside>requester <aside>– /<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L62"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 62"></a></h3><p>The movable we are pathing</p><h3 id="var/skip_first"><aside class="declaration">var </aside>skip_first <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L75"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 75"></a></h3><p>If we should delete the first step in the path or not. Used often because it is just the starting tile</p><h2 id="proc">Proc Details</h2><h3 id="proc/diag_scan_spec"><aside class="declaration">proc </aside>diag_scan_spec<aside>(/<a href="turf.html">turf</a>/original_turf, heading, /<a href="datum.html">datum</a>/<a href="datum/jps_node.html">jps_node</a>/parent_node)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L252"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 252"></a></aside></h3><p>For performing diagonal scans from a given starting turf.</p>
<p>Unlike lateral scans, these only are called from the main search loop, so we don't need to worry about returning anything,
though we do need to handle the return values of our lateral subscans of course.</p>
<p>Arguments:</p>
<ul>
<li>original_turf: What turf did we start this scan at?</li>
<li>heading: What direction are we going in? Obviously, should be diagonal</li>
<li>parent_node: We should always have a parent node for diagonals</li>
</ul><h3 id="proc/lateral_scan_spec"><aside class="declaration">proc </aside>lateral_scan_spec<aside>(/<a href="turf.html">turf</a>/original_turf, heading, /<a href="datum.html">datum</a>/<a href="datum/jps_node.html">jps_node</a>/parent_node)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L185"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 185"></a></aside></h3><p>For performing lateral scans from a given starting turf.</p>
<p>These scans are called from both the main search loop, as well as subscans for diagonal scans, and they treat finding interesting turfs slightly differently.
If we're doing a normal lateral scan, we already have a parent node supplied, so we just create the new node and immediately insert it into the heap, ezpz.
If we're part of a subscan, we still need for the diagonal scan to generate a parent node, so we return a node datum with just the turf and let the diag scan
proc handle transferring the values and inserting them into the heap.</p>
<p>Arguments:</p>
<ul>
<li>original_turf: What turf did we start this scan at?</li>
<li>heading: What direction are we going in? Obviously, should be cardinal</li>
<li>parent_node: Only given for normal lateral scans, if we don't have one, we're a diagonal subscan.</li>
</ul><h3 id="proc/unwind_path"><aside class="declaration">proc </aside>unwind_path<aside>(/<a href="datum.html">datum</a>/<a href="datum/jps_node.html">jps_node</a>/unwind_node)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/paths/jps.dm#L160"><img src="git.png" width="16" height="16" title="code/__HELPERS/paths/jps.dm 160"></a></aside></h3><p>Called when we've hit the goal with the node that represents the last tile, then sets the path var to that path so it can be returned by [datum/pathfind/proc/search]</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>