<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/component - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/component.html#var">Var Details</a> - <a href="datum/component.html#proc">Proc Details</a></header><main><h1>Component <aside>/<a href="datum.html">datum</a>/<a href="datum/component.html">component</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L12"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 12"></a></h1><p>The component datum</p>
<p>A component should be a single standalone unit
of functionality, that works by receiving signals from its parent
object to provide some single functionality (i.e a slippery component)
that makes the object it's attached to cause people to slip over.
Useful when you want shared behaviour independent of type inheritance</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/component.html#var/can_transfer">can_transfer</a></th><td>Only set to true if you are able to properly transfer this component</td></tr><tr><th><a href="datum/component.html#var/dupe_mode">dupe_mode</a></th><td>Defines how duplicate existing components are handled when added to a datum</td></tr><tr><th><a href="datum/component.html#var/parent">parent</a></th><td>The datum this components belongs to</td></tr><tr><th><a href="datum/component.html#var/sources">sources</a></th><td>A lazy list of the sources for this component</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/component.html#proc/CheckDupeComponent">CheckDupeComponent</a></th><td>Called on a component when a component of the same type was added to the same parent with <a href="code/__DEFINES/dcs/declarations.html#define/COMPONENT_DUPE_SELECTIVE" title="COMPONENT_DUPE_SELECTIVE">COMPONENT_DUPE_SELECTIVE</a></td></tr><tr><th><a href="datum/component.html#proc/ClearFromParent">ClearFromParent</a></th><td>Removes the component from parent, ends up with a null parent
Used as a helper proc by the component transfer proc, does not clean up the component like Destroy does</td></tr><tr><th><a href="datum/component.html#proc/Destroy">Destroy</a></th><td>Properly removes the component from <code>parent</code> and cleans up references</td></tr><tr><th><a href="datum/component.html#proc/InheritComponent">InheritComponent</a></th><td>Called on a component when a component of the same type was added to the same parent</td></tr><tr><th><a href="datum/component.html#proc/Initialize">Initialize</a></th><td>Called during component creation with the same arguments as in new excluding parent.</td></tr><tr><th><a href="datum/component.html#proc/New">New</a></th><td>Create a new component.</td></tr><tr><th><a href="datum/component.html#proc/PostTransfer">PostTransfer</a></th><td>Callback Just after a component is transferred</td></tr><tr><th><a href="datum/component.html#proc/PreTransfer">PreTransfer</a></th><td>Callback Just before this component is transferred</td></tr><tr><th><a href="datum/component.html#proc/RegisterWithParent">RegisterWithParent</a></th><td>Register the component with the parent object</td></tr><tr><th><a href="datum/component.html#proc/UnregisterFromParent">UnregisterFromParent</a></th><td>Unregister from our parent object</td></tr><tr><th><a href="datum/component.html#proc/_GetInverseTypeList">_GetInverseTypeList</a></th><td>Internal proc to create a list of our type and all parent types</td></tr><tr><th><a href="datum/component.html#proc/_JoinParent">_JoinParent</a></th><td>Internal proc to handle behaviour of components when joining a parent</td></tr><tr><th><a href="datum/component.html#proc/_RemoveFromParent">_RemoveFromParent</a></th><td>Internal proc to handle behaviour when being removed from a parent</td></tr><tr><th><a href="datum/component.html#proc/allow_source_update">allow_source_update</a></th><td>Whether the component is allowed to call on_source_add() on a source that's already present</td></tr><tr><th><a href="datum/component.html#proc/on_source_add">on_source_add</a></th><td>Called when the component has a new source registered.
Return COMPONENT_INCOMPATIBLE to signal that the source is incompatible and should not be added</td></tr><tr><th><a href="datum/component.html#proc/on_source_remove">on_source_remove</a></th><td>Called when the component has a source removed.
You probably want to call parent after you do your logic because at the end of this we qdel if we have no sources remaining!</td></tr><tr><th><a href="datum/component.html#proc/ui_host">ui_host</a></th><td>Return the object that is the host of any UI's that this component has</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/can_transfer"><aside class="declaration">var </aside>can_transfer <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L30"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 30"></a></h3><p>Only set to true if you are able to properly transfer this component</p>
<p>At a minimum <a href="datum/component.html#proc/RegisterWithParent" title="/datum/component">RegisterWithParent</a> and <a href="datum/component.html#proc/UnregisterFromParent" title="/datum/component">UnregisterFromParent</a> should be used</p>
<p>Make sure you also implement <a href="datum/component.html#proc/PostTransfer" title="/datum/component">PostTransfer</a> for any post transfer handling</p><h3 id="var/dupe_mode"><aside class="declaration">var </aside>dupe_mode <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L18"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 18"></a></h3><p>Defines how duplicate existing components are handled when added to a datum</p>
<p>See <a href="code/__DEFINES/dcs/declarations.html#define/COMPONENT_DUPE_ALLOWED" title="COMPONENT_DUPE_ALLOWED">COMPONENT_DUPE_*</a> definitions for available options</p><h3 id="var/parent"><aside class="declaration">var </aside>parent <aside>– /<a href="datum.html">datum</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L21"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 21"></a></h3><p>The datum this components belongs to</p><h3 id="var/sources"><aside class="declaration">var </aside>sources <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L33"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 33"></a></h3><p>A lazy list of the sources for this component</p><h2 id="proc">Proc Details</h2><h3 id="proc/CheckDupeComponent"><aside class="declaration">proc </aside>CheckDupeComponent<aside>(/<a href="datum.html">datum</a>/<a href="datum/component.html">component</a>/C, ...)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L212"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 212"></a></aside></h3><p>Called on a component when a component of the same type was added to the same parent with <a href="code/__DEFINES/dcs/declarations.html#define/COMPONENT_DUPE_SELECTIVE" title="COMPONENT_DUPE_SELECTIVE">COMPONENT_DUPE_SELECTIVE</a></p>
<p>See <a href="datum/component.html#var/dupe_mode" title="/datum/component">/datum/component/var/dupe_mode</a></p>
<p><code>C</code>'s type will always be the same of the called component</p>
<p>return TRUE if you are absorbing the component, otherwise FALSE if you are fine having it exist as a duplicate component</p><h3 id="proc/ClearFromParent"><aside class="declaration">proc </aside>ClearFromParent<aside>(/<a href="datum.html">datum</a>/new_parent)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L432"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 432"></a></aside></h3><p>Removes the component from parent, ends up with a null parent
Used as a helper proc by the component transfer proc, does not clean up the component like Destroy does</p><h3 id="proc/Destroy"><aside class="parent"><a title="/datum" href="datum.html#proc/Destroy">↑</a></aside>Destroy<aside>(force)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L77"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 77"></a></aside></h3><p>Properly removes the component from <code>parent</code> and cleans up references</p>
<p>Arguments:</p>
<ul>
<li>force - makes it not check for and remove the component from the parent</li>
</ul><h3 id="proc/InheritComponent"><aside class="declaration">proc </aside>InheritComponent<aside>(/<a href="datum.html">datum</a>/<a href="datum/component.html">component</a>/C, i_am_original)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L199"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 199"></a></aside></h3><p>Called on a component when a component of the same type was added to the same parent</p>
<p>See <a href="datum/component.html#var/dupe_mode" title="/datum/component">/datum/component/var/dupe_mode</a></p>
<p><code>C</code>'s type will always be the same of the called component</p><h3 id="proc/Initialize"><aside class="declaration">proc </aside>Initialize<aside>(...)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L68"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 68"></a></aside></h3><p>Called during component creation with the same arguments as in new excluding parent.</p>
<p>Do not call <code>qdel(src)</code> from this function, <code>return COMPONENT_INCOMPATIBLE</code> instead</p><h3 id="proc/New">New<aside>(/list/raw_args)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L43"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 43"></a></aside></h3><p>Create a new component.</p>
<p>Additional arguments are passed to <a href="datum/component.html#proc/Initialize" title="/datum/component">Initialize()</a></p>
<p>Arguments:</p>
<ul>
<li>datum/P the parent datum this component reacts to signals from</li>
</ul><h3 id="proc/PostTransfer"><aside class="declaration">proc </aside>PostTransfer<aside>(/<a href="datum.html">datum</a>/new_parent)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L231"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 231"></a></aside></h3><p>Callback Just after a component is transferred</p>
<p>Use this to do any special setup you need to do after being moved to a new object</p>
<p>Do not call <code>qdel(src)</code> from this function, <code>return COMPONENT_INCOMPATIBLE</code> instead</p><h3 id="proc/PreTransfer"><aside class="declaration">proc </aside>PreTransfer<aside>(/<a href="datum.html">datum</a>/new_parent)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L221"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 221"></a></aside></h3><p>Callback Just before this component is transferred</p>
<p>Use this to do any special cleanup you might need to do before being deregged from an object</p><h3 id="proc/RegisterWithParent"><aside class="declaration">proc </aside>RegisterWithParent<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L156"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 156"></a></aside></h3><p>Register the component with the parent object</p>
<p>Use this proc to register with your parent object</p>
<p>Overridable proc that's called when added to a new parent</p><h3 id="proc/UnregisterFromParent"><aside class="declaration">proc </aside>UnregisterFromParent<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L167"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 167"></a></aside></h3><p>Unregister from our parent object</p>
<p>Use this proc to unregister from your parent object</p>
<p>Overridable proc that's called when removed from a parent</p><h3 id="proc/_GetInverseTypeList"><aside class="declaration">proc </aside>_GetInverseTypeList<aside>(our_type)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L237"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 237"></a></aside></h3><p>Internal proc to create a list of our type and all parent types</p><h3 id="proc/_JoinParent"><aside class="declaration">proc </aside>_JoinParent<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L89"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 89"></a></aside></h3><p>Internal proc to handle behaviour of components when joining a parent</p><h3 id="proc/_RemoveFromParent"><aside class="declaration">proc </aside>_RemoveFromParent<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L127"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 127"></a></aside></h3><p>Internal proc to handle behaviour when being removed from a parent</p><h3 id="proc/allow_source_update"><aside class="declaration">proc </aside>allow_source_update<aside>(source)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L499"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 499"></a></aside></h3><p>Whether the component is allowed to call on_source_add() on a source that's already present</p><h3 id="proc/on_source_add"><aside class="declaration">proc </aside>on_source_add<aside>(source, ...)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L174"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 174"></a></aside></h3><p>Called when the component has a new source registered.
Return COMPONENT_INCOMPATIBLE to signal that the source is incompatible and should not be added</p><h3 id="proc/on_source_remove"><aside class="declaration">proc </aside>on_source_remove<aside>(source)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L184"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 184"></a></aside></h3><p>Called when the component has a source removed.
You probably want to call parent after you do your logic because at the end of this we qdel if we have no sources remaining!</p><h3 id="proc/ui_host"><aside class="parent"><a title="/datum" href="datum.html#proc/ui_host">↑</a></aside>ui_host<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/components/_component.dm#L495"><img src="git.png" width="16" height="16" title="code/datums/components/_component.dm 495"></a></aside></h3><p>Return the object that is the host of any UI's that this component has</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>