<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/weather - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/weather.html#var">Var Details</a> - <a href="datum/weather.html#proc">Proc Details</a></header><main><h1>weather <aside>/<a href="datum.html">datum</a>/<a href="datum/weather.html">weather</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L15"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 15"></a></h1><p>Causes weather to occur on a z level in certain area types</p>
<p>The effects of weather occur across an entire z-level. For instance, lavaland has periodic ash storms that scorch most unprotected creatures.
Weather always occurs on different z levels at different times, regardless of weather type.
Can have custom durations, targets, and can automatically protect indoor areas.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/weather.html#var/area_type">area_type</a></th><td>Types of area to affect</td></tr><tr><th><a href="datum/weather.html#var/blacklist_weather_reagents">blacklist_weather_reagents</a></th><td>A list of reagents that are forbidden from being selected when there is no
whitelist and the reagents are randomized</td></tr><tr><th><a href="datum/weather.html#var/current_mobs">current_mobs</a></th><td>List of current mobs being processed by weather</td></tr><tr><th><a href="datum/weather.html#var/desc">desc</a></th><td>description of weather</td></tr><tr><th><a href="datum/weather.html#var/end_duration">end_duration</a></th><td>How long the &quot;wind-down&quot; graphic will appear before vanishing entirely</td></tr><tr><th><a href="datum/weather.html#var/end_message">end_message</a></th><td>Displayed once the weather is over</td></tr><tr><th><a href="datum/weather.html#var/end_overlay">end_overlay</a></th><td>Area overlay while weather is ending</td></tr><tr><th><a href="datum/weather.html#var/end_sound">end_sound</a></th><td>Sound that plays while weather is ending</td></tr><tr><th><a href="datum/weather.html#var/end_sound_vol">end_sound_vol</a></th><td>Volume of the sound that plays while weather is ending</td></tr><tr><th><a href="datum/weather.html#var/immunity_type">immunity_type</a></th><td>Used by mobs (or movables containing mobs, such as enviro bags) to prevent them from being affected by the weather.</td></tr><tr><th><a href="datum/weather.html#var/impacted_areas">impacted_areas</a></th><td>Areas to be affected by the weather, calculated when the weather begins</td></tr><tr><th><a href="datum/weather.html#var/impacted_areas_blend_modes">impacted_areas_blend_modes</a></th><td>Areas affected by weather have their blend modes changed</td></tr><tr><th><a href="datum/weather.html#var/impacted_areas_weighted">impacted_areas_weighted</a></th><td>A weighted list of areas impacted by weather, where weights reflect the total turf count in each area.</td></tr><tr><th><a href="datum/weather.html#var/impacted_z_levels">impacted_z_levels</a></th><td>The list of z-levels that this weather is actively affecting</td></tr><tr><th><a href="datum/weather.html#var/impacted_z_levels_weighted">impacted_z_levels_weighted</a></th><td>A weighted list of z-levels impacted by weather, where weights reflect the total turf count on each level</td></tr><tr><th><a href="datum/weather.html#var/name">name</a></th><td>name of weather</td></tr><tr><th><a href="datum/weather.html#var/next_hit_time">next_hit_time</a></th><td>For barometers to know when the next storm will hit</td></tr><tr><th><a href="datum/weather.html#var/overlay_cache">overlay_cache</a></th><td>List of all overlays to apply to our turfs</td></tr><tr><th><a href="datum/weather.html#var/overlay_layer">overlay_layer</a></th><td>Since it's above everything else, this is the layer used by default.</td></tr><tr><th><a href="datum/weather.html#var/overlay_plane">overlay_plane</a></th><td>Plane for the overlay</td></tr><tr><th><a href="datum/weather.html#var/probability">probability</a></th><td>Weight amongst other eligible weather. If zero, will never happen randomly.</td></tr><tr><th><a href="datum/weather.html#var/protected_areas">protected_areas</a></th><td>Areas that are protected and excluded from the affected areas.</td></tr><tr><th><a href="datum/weather.html#var/stage">stage</a></th><td>The stage of the weather, from 1-4</td></tr><tr><th><a href="datum/weather.html#var/subsystem_tasks">subsystem_tasks</a></th><td>The list of allowed tasks our weather subsystem is allowed to process (determined by weather_flags)</td></tr><tr><th><a href="datum/weather.html#var/target_trait">target_trait</a></th><td>The z-level trait to affect when run randomly or when not overridden.</td></tr><tr><th><a href="datum/weather.html#var/task_index">task_index</a></th><td>Index of the current section our weather subsystem is processing from our subsystem_tasks</td></tr><tr><th><a href="datum/weather.html#var/telegraph_duration">telegraph_duration</a></th><td>How long from the beginning of the telegraph until the weather begins</td></tr><tr><th><a href="datum/weather.html#var/telegraph_message">telegraph_message</a></th><td>The message displayed in chat to foreshadow the weather's beginning</td></tr><tr><th><a href="datum/weather.html#var/telegraph_overlay">telegraph_overlay</a></th><td>The overlay applied to all tiles on the z-level</td></tr><tr><th><a href="datum/weather.html#var/telegraph_sound">telegraph_sound</a></th><td>The sound file played to everyone on an affected z-level</td></tr><tr><th><a href="datum/weather.html#var/telegraph_sound_vol">telegraph_sound_vol</a></th><td>Volume of the telegraph sound</td></tr><tr><th><a href="datum/weather.html#var/thunder_color">thunder_color</a></th><td>Color to apply to thunder while weather is occuring</td></tr><tr><th><a href="datum/weather.html#var/thunder_iteration">thunder_iteration</a></th><td>The weather thunder counter to keep track of how much thunder we have processed so far</td></tr><tr><th><a href="datum/weather.html#var/thunder_turfs_per_tick">thunder_turfs_per_tick</a></th><td>The calculated amount of turfs that get thunder effects processed each tick (this gets calculated do not manually set this var)</td></tr><tr><th><a href="datum/weather.html#var/total_impacted_turfs">total_impacted_turfs</a></th><td>The total number of turfs impacted by weather across all z-levels and areas.</td></tr><tr><th><a href="datum/weather.html#var/turf_iteration">turf_iteration</a></th><td>The weather turf counter to keep track of how many turfs we have processed so far</td></tr><tr><th><a href="datum/weather.html#var/turf_thunder_chance">turf_thunder_chance</a></th><td>The chance, per tick, a turf will have a thunder strike applied to it. This is a decimal value, 1.00 = 100%, 0.50 = 50%, etc.
Recommend setting this really low near 0.001 (results in 1 in 1000 affected turfs having thunder strikes applied per tick)</td></tr><tr><th><a href="datum/weather.html#var/turf_weather_chance">turf_weather_chance</a></th><td>The chance, per tick, a turf will have weather effects applied to it. This is a decimal value, 1.00 = 100%, 0.50 = 50%, etc.
Recommend setting this low near 0.01 (results in 1 in 100 affected turfs having weather reagents applied per tick)</td></tr><tr><th><a href="datum/weather.html#var/use_glow">use_glow</a></th><td>If this bit of weather should also draw an overlay that's uneffected by lighting onto the area
Taken from weather_glow.dmi</td></tr><tr><th><a href="datum/weather.html#var/weather_color">weather_color</a></th><td>Color to apply to the area while weather is occuring</td></tr><tr><th><a href="datum/weather.html#var/weather_duration">weather_duration</a></th><td>How long the weather lasts once it begins</td></tr><tr><th><a href="datum/weather.html#var/weather_duration_lower">weather_duration_lower</a></th><td>See above - this is the lowest possible duration</td></tr><tr><th><a href="datum/weather.html#var/weather_duration_upper">weather_duration_upper</a></th><td>See above - this is the highest possible duration</td></tr><tr><th><a href="datum/weather.html#var/weather_flags">weather_flags</a></th><td>List of weather bitflags that determines effects (see \code__DEFINES\weather.dm)</td></tr><tr><th><a href="datum/weather.html#var/weather_message">weather_message</a></th><td>Displayed in chat once the weather begins in earnest</td></tr><tr><th><a href="datum/weather.html#var/weather_overlay">weather_overlay</a></th><td>Area overlay while the weather is occuring</td></tr><tr><th><a href="datum/weather.html#var/weather_reagent">weather_reagent</a></th><td>The selected reagent that will be rained down</td></tr><tr><th><a href="datum/weather.html#var/weather_reagent_holder">weather_reagent_holder</a></th><td>The actual atom that holds our reagents that is held in nullspace</td></tr><tr><th><a href="datum/weather.html#var/weather_sound">weather_sound</a></th><td>The sound played to everyone on an affected z-level when weather is occuring (does not loop)</td></tr><tr><th><a href="datum/weather.html#var/weather_temperature">weather_temperature</a></th><td>The temperature of our weather that is applied to weather reagents and mobs using adjust_bodytemperature()</td></tr><tr><th><a href="datum/weather.html#var/weather_turfs_per_tick">weather_turfs_per_tick</a></th><td>The calculated amount of turfs that get weather effects processed each tick (this gets calculated do not manually set this var)</td></tr><tr><th><a href="datum/weather.html#var/whitelist_weather_reagents">whitelist_weather_reagents</a></th><td>A list (supports regular, nested, and weighted) of possible reagents that will rain down from the sky.
Only one of these will be selected to be used as the reagent</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/weather.html#proc/can_see_weather">can_see_weather</a></th><td>Checks if the player is in or can see an area affected by the weather</td></tr><tr><th><a href="datum/weather.html#proc/can_weather_act_mob">can_weather_act_mob</a></th><td>Returns TRUE if the living mob can be affected by the weather</td></tr><tr><th><a href="datum/weather.html#proc/can_weather_act_turf">can_weather_act_turf</a></th><td>Returns TRUE if the turf can be affected by the weather</td></tr><tr><th><a href="datum/weather.html#proc/end">end</a></th><td>Fully ends the weather</td></tr><tr><th><a href="datum/weather.html#proc/generate_overlay_cache">generate_overlay_cache</a></th><td>Returns a list of visual offset -&gt; overlays to use</td></tr><tr><th><a href="datum/weather.html#proc/get_impacted_zs_without_trait">get_impacted_zs_without_trait</a></th><td>Returns a list of z-levels impacted that do not have the target trait</td></tr><tr><th><a href="datum/weather.html#proc/get_playlist_ref">get_playlist_ref</a></th><td>Returns a reference to the &quot;sound playlist&quot; for this weather type</td></tr><tr><th><a href="datum/weather.html#proc/manually_setup_sound_manager">manually_setup_sound_manager</a></th><td>Manually add a sound manager to all mobs</td></tr><tr><th><a href="datum/weather.html#proc/pick_turf">pick_turf</a></th><td>Selects a turf impacted by weather, if available, otherwise returns null</td></tr><tr><th><a href="datum/weather.html#proc/recursive_weather_protection_check">recursive_weather_protection_check</a></th><td>Returns TRUE if the atom should protect itself or its contents from weather</td></tr><tr><th><a href="datum/weather.html#proc/start">start</a></th><td>Starts the actual weather and effects from it</td></tr><tr><th><a href="datum/weather.html#proc/telegraph">telegraph</a></th><td>Telegraphs the beginning of the weather on the impacted z levels</td></tr><tr><th><a href="datum/weather.html#proc/thunder_act_turf">thunder_act_turf</a></th><td>Affects the turf with thunder</td></tr><tr><th><a href="datum/weather.html#proc/update_areas">update_areas</a></th><td>Updates the overlays on impacted areas</td></tr><tr><th><a href="datum/weather.html#proc/weather_act_mob">weather_act_mob</a></th><td>Affects the mob with whatever the weather does</td></tr><tr><th><a href="datum/weather.html#proc/weather_act_turf">weather_act_turf</a></th><td>Affects the turf with whatever the weather does</td></tr><tr><th><a href="datum/weather.html#proc/wind_down">wind_down</a></th><td>Weather enters the winding down phase, stops effects</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/area_type"><aside class="declaration">var </aside>area_type <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L58"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 58"></a></h3><p>Types of area to affect</p><h3 id="var/blacklist_weather_reagents"><aside class="declaration">var </aside>blacklist_weather_reagents <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L130"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 130"></a></h3><p>A list of reagents that are forbidden from being selected when there is no
whitelist and the reagents are randomized</p><h3 id="var/current_mobs"><aside class="declaration">var </aside>current_mobs <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L112"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 112"></a></h3><p>List of current mobs being processed by weather</p><h3 id="var/desc"><aside class="declaration">var </aside>desc <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L19"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 19"></a></h3><p>description of weather</p><h3 id="var/end_duration"><aside class="declaration">var </aside>end_duration <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L49"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 49"></a></h3><p>How long the &quot;wind-down&quot; graphic will appear before vanishing entirely</p><h3 id="var/end_message"><aside class="declaration">var </aside>end_message <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L47"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 47"></a></h3><p>Displayed once the weather is over</p><h3 id="var/end_overlay"><aside class="declaration">var </aside>end_overlay <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L55"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 55"></a></h3><p>Area overlay while weather is ending</p><h3 id="var/end_sound"><aside class="declaration">var </aside>end_sound <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L51"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 51"></a></h3><p>Sound that plays while weather is ending</p><h3 id="var/end_sound_vol"><aside class="declaration">var </aside>end_sound_vol <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L53"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 53"></a></h3><p>Volume of the sound that plays while weather is ending</p><h3 id="var/immunity_type"><aside class="declaration">var </aside>immunity_type <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L79"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 79"></a></h3><p>Used by mobs (or movables containing mobs, such as enviro bags) to prevent them from being affected by the weather.</p><h3 id="var/impacted_areas"><aside class="declaration">var </aside>impacted_areas <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L60"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 60"></a></h3><p>Areas to be affected by the weather, calculated when the weather begins</p><h3 id="var/impacted_areas_blend_modes"><aside class="declaration">var </aside>impacted_areas_blend_modes <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L66"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 66"></a></h3><p>Areas affected by weather have their blend modes changed</p><h3 id="var/impacted_areas_weighted"><aside class="declaration">var </aside>impacted_areas_weighted <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L62"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 62"></a></h3><p>A weighted list of areas impacted by weather, where weights reflect the total turf count in each area.</p><h3 id="var/impacted_z_levels"><aside class="declaration">var </aside>impacted_z_levels <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L70"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 70"></a></h3><p>The list of z-levels that this weather is actively affecting</p><h3 id="var/impacted_z_levels_weighted"><aside class="declaration">var </aside>impacted_z_levels_weighted <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L72"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 72"></a></h3><p>A weighted list of z-levels impacted by weather, where weights reflect the total turf count on each level</p><h3 id="var/name"><aside class="declaration">var </aside>name <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L17"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 17"></a></h3><p>name of weather</p><h3 id="var/next_hit_time"><aside class="declaration">var </aside>next_hit_time <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L94"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 94"></a></h3><p>For barometers to know when the next storm will hit</p><h3 id="var/overlay_cache"><aside class="declaration">var </aside>overlay_cache <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L84"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 84"></a></h3><p>List of all overlays to apply to our turfs</p><h3 id="var/overlay_layer"><aside class="declaration">var </aside>overlay_layer <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L75"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 75"></a></h3><p>Since it's above everything else, this is the layer used by default.</p><h3 id="var/overlay_plane"><aside class="declaration">var </aside>overlay_plane <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L77"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 77"></a></h3><p>Plane for the overlay</p><h3 id="var/probability"><aside class="declaration">var </aside>probability <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L90"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 90"></a></h3><p>Weight amongst other eligible weather. If zero, will never happen randomly.</p><h3 id="var/protected_areas"><aside class="declaration">var </aside>protected_areas <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L68"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 68"></a></h3><p>Areas that are protected and excluded from the affected areas.</p><h3 id="var/stage"><aside class="declaration">var </aside>stage <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L87"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 87"></a></h3><p>The stage of the weather, from 1-4</p><h3 id="var/subsystem_tasks"><aside class="declaration">var </aside>subsystem_tasks <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L120"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 120"></a></h3><p>The list of allowed tasks our weather subsystem is allowed to process (determined by weather_flags)</p><h3 id="var/target_trait"><aside class="declaration">var </aside>target_trait <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L92"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 92"></a></h3><p>The z-level trait to affect when run randomly or when not overridden.</p><h3 id="var/task_index"><aside class="declaration">var </aside>task_index <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L118"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 118"></a></h3><p>Index of the current section our weather subsystem is processing from our subsystem_tasks</p><h3 id="var/telegraph_duration"><aside class="declaration">var </aside>telegraph_duration <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L23"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 23"></a></h3><p>How long from the beginning of the telegraph until the weather begins</p><h3 id="var/telegraph_message"><aside class="declaration">var </aside>telegraph_message <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L21"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 21"></a></h3><p>The message displayed in chat to foreshadow the weather's beginning</p><h3 id="var/telegraph_overlay"><aside class="declaration">var </aside>telegraph_overlay <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L29"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 29"></a></h3><p>The overlay applied to all tiles on the z-level</p><h3 id="var/telegraph_sound"><aside class="declaration">var </aside>telegraph_sound <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L25"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 25"></a></h3><p>The sound file played to everyone on an affected z-level</p><h3 id="var/telegraph_sound_vol"><aside class="declaration">var </aside>telegraph_sound_vol <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L27"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 27"></a></h3><p>Volume of the telegraph sound</p><h3 id="var/thunder_color"><aside class="declaration">var </aside>thunder_color <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L106"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 106"></a></h3><p>Color to apply to thunder while weather is occuring</p><h3 id="var/thunder_iteration"><aside class="declaration">var </aside>thunder_iteration <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L116"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 116"></a></h3><p>The weather thunder counter to keep track of how much thunder we have processed so far</p><h3 id="var/thunder_turfs_per_tick"><aside class="declaration">var </aside>thunder_turfs_per_tick <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L104"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 104"></a></h3><p>The calculated amount of turfs that get thunder effects processed each tick (this gets calculated do not manually set this var)</p><h3 id="var/total_impacted_turfs"><aside class="declaration">var </aside>total_impacted_turfs <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L64"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 64"></a></h3><p>The total number of turfs impacted by weather across all z-levels and areas.</p><h3 id="var/turf_iteration"><aside class="declaration">var </aside>turf_iteration <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L114"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 114"></a></h3><p>The weather turf counter to keep track of how many turfs we have processed so far</p><h3 id="var/turf_thunder_chance"><aside class="declaration">var </aside>turf_thunder_chance <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L100"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 100"></a></h3><p>The chance, per tick, a turf will have a thunder strike applied to it. This is a decimal value, 1.00 = 100%, 0.50 = 50%, etc.
Recommend setting this really low near 0.001 (results in 1 in 1000 affected turfs having thunder strikes applied per tick)</p><h3 id="var/turf_weather_chance"><aside class="declaration">var </aside>turf_weather_chance <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L97"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 97"></a></h3><p>The chance, per tick, a turf will have weather effects applied to it. This is a decimal value, 1.00 = 100%, 0.50 = 50%, etc.
Recommend setting this low near 0.01 (results in 1 in 100 affected turfs having weather reagents applied per tick)</p><h3 id="var/use_glow"><aside class="declaration">var </aside>use_glow <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L82"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 82"></a></h3><p>If this bit of weather should also draw an overlay that's uneffected by lighting onto the area
Taken from weather_glow.dmi</p><h3 id="var/weather_color"><aside class="declaration">var </aside>weather_color <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L44"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 44"></a></h3><p>Color to apply to the area while weather is occuring</p><h3 id="var/weather_duration"><aside class="declaration">var </aside>weather_duration <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L34"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 34"></a></h3><p>How long the weather lasts once it begins</p><h3 id="var/weather_duration_lower"><aside class="declaration">var </aside>weather_duration_lower <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L36"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 36"></a></h3><p>See above - this is the lowest possible duration</p><h3 id="var/weather_duration_upper"><aside class="declaration">var </aside>weather_duration_upper <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L38"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 38"></a></h3><p>See above - this is the highest possible duration</p><h3 id="var/weather_flags"><aside class="declaration">var </aside>weather_flags <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L109"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 109"></a></h3><p>List of weather bitflags that determines effects (see \code__DEFINES\weather.dm)</p><h3 id="var/weather_message"><aside class="declaration">var </aside>weather_message <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L32"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 32"></a></h3><p>Displayed in chat once the weather begins in earnest</p><h3 id="var/weather_overlay"><aside class="declaration">var </aside>weather_overlay <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L42"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 42"></a></h3><p>Area overlay while the weather is occuring</p><h3 id="var/weather_reagent"><aside class="declaration">var </aside>weather_reagent <aside>– /<a href="datum.html">datum</a>/<a href="datum/reagent.html">reagent</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L132"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 132"></a></h3><p>The selected reagent that will be rained down</p><h3 id="var/weather_reagent_holder"><aside class="declaration">var </aside>weather_reagent_holder <aside>– /<a href="obj.html">obj</a>/effect/abstract</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L134"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 134"></a></h3><p>The actual atom that holds our reagents that is held in nullspace</p><h3 id="var/weather_sound"><aside class="declaration">var </aside>weather_sound <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L40"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 40"></a></h3><p>The sound played to everyone on an affected z-level when weather is occuring (does not loop)</p><h3 id="var/weather_temperature"><aside class="declaration">var </aside>weather_temperature <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L123"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 123"></a></h3><p>The temperature of our weather that is applied to weather reagents and mobs using adjust_bodytemperature()</p><h3 id="var/weather_turfs_per_tick"><aside class="declaration">var </aside>weather_turfs_per_tick <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L102"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 102"></a></h3><p>The calculated amount of turfs that get weather effects processed each tick (this gets calculated do not manually set this var)</p><h3 id="var/whitelist_weather_reagents"><aside class="declaration">var </aside>whitelist_weather_reagents <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L127"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 127"></a></h3><p>A list (supports regular, nested, and weighted) of possible reagents that will rain down from the sky.
Only one of these will be selected to be used as the reagent</p><h2 id="proc">Proc Details</h2><h3 id="proc/can_see_weather"><aside class="declaration">proc </aside>can_see_weather<aside>(/<a href="mob.html">mob</a>/player)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L401"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 401"></a></aside></h3><p>Checks if the player is in or can see an area affected by the weather</p><h3 id="proc/can_weather_act_mob"><aside class="declaration">proc </aside>can_weather_act_mob<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/mob_to_check)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L414"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 414"></a></aside></h3><p>Returns TRUE if the living mob can be affected by the weather</p><h3 id="proc/can_weather_act_turf"><aside class="declaration">proc </aside>can_weather_act_turf<aside>(/<a href="turf.html">turf</a>/valid_weather_turf)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L442"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 442"></a></aside></h3><p>Returns TRUE if the turf can be affected by the weather</p><h3 id="proc/end"><aside class="declaration">proc </aside>end<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L362"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 362"></a></aside></h3><p>Fully ends the weather</p>
<p>Effects no longer occur and area overlays are removed
Removes weather from processing completely</p><h3 id="proc/generate_overlay_cache"><aside class="declaration">proc </aside>generate_overlay_cache<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L555"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 555"></a></aside></h3><p>Returns a list of visual offset -&gt; overlays to use</p><h3 id="proc/get_impacted_zs_without_trait"><aside class="declaration">proc </aside>get_impacted_zs_without_trait<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L224"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 224"></a></aside></h3><p>Returns a list of z-levels impacted that do not have the target trait</p><h3 id="proc/get_playlist_ref"><aside class="declaration">proc </aside>get_playlist_ref<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L220"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 220"></a></aside></h3><p>Returns a reference to the &quot;sound playlist&quot; for this weather type</p><h3 id="proc/manually_setup_sound_manager"><aside class="declaration">proc </aside>manually_setup_sound_manager<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L201"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 201"></a></aside></h3><p>Manually add a sound manager to all mobs</p><h3 id="proc/pick_turf"><aside class="declaration">proc </aside>pick_turf<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L295"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 295"></a></aside></h3><p>Selects a turf impacted by weather, if available, otherwise returns null</p><h3 id="proc/recursive_weather_protection_check"><aside class="declaration">proc </aside>recursive_weather_protection_check<aside>(/<a href="atom.html">atom</a>/to_check)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L436"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 436"></a></aside></h3><p>Returns TRUE if the atom should protect itself or its contents from weather</p><h3 id="proc/start"><aside class="declaration">proc </aside>start<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L327"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 327"></a></aside></h3><p>Starts the actual weather and effects from it</p>
<p>Updates area overlays and sends sounds and messages to mobs to notify them
Begins dealing effects from weather to mobs in the area</p><h3 id="proc/telegraph"><aside class="declaration">proc </aside>telegraph<aside>(/list/weather_data)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L183"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 183"></a></aside></h3><p>Telegraphs the beginning of the weather on the impacted z levels</p>
<p>Sends sounds and details to mobs in the area
Calculates duration and hit areas, and makes a callback for the actual weather to start</p><h3 id="proc/thunder_act_turf"><aside class="declaration">proc </aside>thunder_act_turf<aside>(/<a href="turf.html">turf</a>/<a href="turf/open.html">open</a>/weather_turf)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L510"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 510"></a></aside></h3><p>Affects the turf with thunder</p><h3 id="proc/update_areas"><aside class="declaration">proc </aside>update_areas<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L535"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 535"></a></aside></h3><p>Updates the overlays on impacted areas</p><h3 id="proc/weather_act_mob"><aside class="declaration">proc </aside>weather_act_mob<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/living)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L459"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 459"></a></aside></h3><p>Affects the mob with whatever the weather does</p><h3 id="proc/weather_act_turf"><aside class="declaration">proc </aside>weather_act_turf<aside>(/<a href="turf.html">turf</a>/<a href="turf/open.html">open</a>/weather_turf)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L483"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 483"></a></aside></h3><p>Affects the turf with whatever the weather does</p><h3 id="proc/wind_down"><aside class="declaration">proc </aside>wind_down<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/weather/weather.dm#L346"><img src="git.png" width="16" height="16" title="code/datums/weather/weather.dm 346"></a></aside></h3><p>Weather enters the winding down phase, stops effects</p>
<p>Updates areas to be in the winding down phase
Sends sounds and messages to mobs to notify them</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>