<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/greyscale_config - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/greyscale_config.html#var">Var Details</a> - <a href="datum/greyscale_config.html#proc">Proc Details</a></header><main><h1>greyscale_config <aside>/<a href="datum.html">datum</a>/<a href="datum/greyscale_config.html">greyscale_config</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L4"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 4"></a></h1><p>A datum tying together a greyscale configuration and dmi file. Required for using GAGS and handles the code interactions.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/greyscale_config.html#var/expected_colors">expected_colors</a></th><td>How many colors are expected to be given when building the sprite</td></tr><tr><th><a href="datum/greyscale_config.html#var/flat_all_layers">flat_all_layers</a></th><td>A list of all layers irrespective of nesting</td></tr><tr><th><a href="datum/greyscale_config.html#var/height">height</a></th><td>Spritesheet height of the icon_file</td></tr><tr><th><a href="datum/greyscale_config.html#var/icon_cache">icon_cache</a></th><td>Generated icons keyed by their color arguments</td></tr><tr><th><a href="datum/greyscale_config.html#var/icon_file">icon_file</a></th><td>Reference to the dmi file for this config</td></tr><tr><th><a href="datum/greyscale_config.html#var/icon_file_hash">icon_file_hash</a></th><td>The md5 file hash for the icon file. Used to check if the file has changed</td></tr><tr><th><a href="datum/greyscale_config.html#var/icon_states">icon_states</a></th><td>A list of icon states and their layers</td></tr><tr><th><a href="datum/greyscale_config.html#var/json_config">json_config</a></th><td>Reference to the json config file</td></tr><tr><th><a href="datum/greyscale_config.html#var/json_config_hash">json_config_hash</a></th><td>The md5 file hash for the json configuration. Used to check if the file has changed</td></tr><tr><th><a href="datum/greyscale_config.html#var/live_edit_types">live_edit_types</a></th><td>A list of types to update in the world whenever a config changes</td></tr><tr><th><a href="datum/greyscale_config.html#var/material_skin">material_skin</a></th><td>An optional var to set that tells the material system what material this configuration is for.
Use a typepath here, not an instance.</td></tr><tr><th><a href="datum/greyscale_config.html#var/name">name</a></th><td>User friendly name used in the debug menu</td></tr><tr><th><a href="datum/greyscale_config.html#var/raw_json_string">raw_json_string</a></th><td>The raw string contents of the JSON config file.</td></tr><tr><th><a href="datum/greyscale_config.html#var/string_icon_file">string_icon_file</a></th><td>String path to the icon file, used for reloading</td></tr><tr><th><a href="datum/greyscale_config.html#var/string_json_config">string_json_config</a></th><td>String path to the json file, used for reloading</td></tr><tr><th><a href="datum/greyscale_config.html#var/width">width</a></th><td>Spritesheet width of the icon_file</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/greyscale_config.html#proc/CrossVerify">CrossVerify</a></th><td>Called after every config has refreshed, this proc handles data verification that depends on multiple entwined configurations.</td></tr><tr><th><a href="datum/greyscale_config.html#proc/DebugName">DebugName</a></th><td>Gets the name used for debug purposes</td></tr><tr><th><a href="datum/greyscale_config.html#proc/Generate">Generate</a></th><td>Actually create the icon and color it in, handles caching</td></tr><tr><th><a href="datum/greyscale_config.html#proc/GenerateBundle">GenerateBundle</a></th><td>Handles the actual icon manipulation to create the spritesheet</td></tr><tr><th><a href="datum/greyscale_config.html#proc/GenerateBundleUniversalIcon">GenerateBundleUniversalIcon</a></th><td>Handles the actual icon manipulation to create the spritesheet</td></tr><tr><th><a href="datum/greyscale_config.html#proc/GenerateLayerGroup">GenerateLayerGroup</a></th><td>Internal recursive proc to handle nested layer groups</td></tr><tr><th><a href="datum/greyscale_config.html#proc/GenerateLayerGroupUniversalIcon">GenerateLayerGroupUniversalIcon</a></th><td>Internal recursive proc to handle nested layer groups</td></tr><tr><th><a href="datum/greyscale_config.html#proc/ReadIconStateConfiguration">ReadIconStateConfiguration</a></th><td>Takes the json icon state configuration and puts it into a more processed format.</td></tr><tr><th><a href="datum/greyscale_config.html#proc/ReadLayersFromJson">ReadLayersFromJson</a></th><td>Takes the json layers configuration and puts it into a more processed format</td></tr><tr><th><a href="datum/greyscale_config.html#proc/ReadMetadata">ReadMetadata</a></th><td>Reads layer configurations to take out some useful overall information</td></tr><tr><th><a href="datum/greyscale_config.html#proc/Refresh">Refresh</a></th><td>Call this proc to handle all the data extraction from the json configuration. Can be forced to load values from disk instead of memory.</td></tr><tr><th><a href="datum/greyscale_config.html#proc/SaveOutput">SaveOutput</a></th><td>For saving a dmi to disk, useful for debug mainly</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/expected_colors"><aside class="declaration">var </aside>expected_colors <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L52"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 52"></a></h3><p>How many colors are expected to be given when building the sprite</p><h3 id="var/flat_all_layers"><aside class="declaration">var </aside>flat_all_layers <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L46"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 46"></a></h3><p>A list of all layers irrespective of nesting</p><h3 id="var/height"><aside class="declaration">var </aside>height <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L25"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 25"></a></h3><p>Spritesheet height of the icon_file</p><h3 id="var/icon_cache"><aside class="declaration">var </aside>icon_cache <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L55"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 55"></a></h3><p>Generated icons keyed by their color arguments</p><h3 id="var/icon_file"><aside class="declaration">var </aside>icon_file <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L12"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 12"></a></h3><p>Reference to the dmi file for this config</p><h3 id="var/icon_file_hash"><aside class="declaration">var </aside>icon_file_hash <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L40"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 40"></a></h3><p>The md5 file hash for the icon file. Used to check if the file has changed</p><h3 id="var/icon_states"><aside class="declaration">var </aside>icon_states <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L43"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 43"></a></h3><p>A list of icon states and their layers</p><h3 id="var/json_config"><aside class="declaration">var </aside>json_config <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L9"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 9"></a></h3><p>Reference to the json config file</p><h3 id="var/json_config_hash"><aside class="declaration">var </aside>json_config_hash <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L31"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 31"></a></h3><p>The md5 file hash for the json configuration. Used to check if the file has changed</p><h3 id="var/live_edit_types"><aside class="declaration">var </aside>live_edit_types <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L49"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 49"></a></h3><p>A list of types to update in the world whenever a config changes</p><h3 id="var/material_skin"><aside class="declaration">var </aside>material_skin <aside>– /<a href="datum.html">datum</a>/<a href="datum/material.html">material</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L16"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 16"></a></h3><p>An optional var to set that tells the material system what material this configuration is for.
Use a typepath here, not an instance.</p><h3 id="var/name"><aside class="declaration">var </aside>name <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L6"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 6"></a></h3><p>User friendly name used in the debug menu</p><h3 id="var/raw_json_string"><aside class="declaration">var </aside>raw_json_string <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L34"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 34"></a></h3><p>The raw string contents of the JSON config file.</p><h3 id="var/string_icon_file"><aside class="declaration">var </aside>string_icon_file <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L37"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 37"></a></h3><p>String path to the icon file, used for reloading</p><h3 id="var/string_json_config"><aside class="declaration">var </aside>string_json_config <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L28"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 28"></a></h3><p>String path to the json file, used for reloading</p><h3 id="var/width"><aside class="declaration">var </aside>width <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L22"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 22"></a></h3><p>Spritesheet width of the icon_file</p><h2 id="proc">Proc Details</h2><h3 id="proc/CrossVerify"><aside class="declaration">proc </aside>CrossVerify<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L145"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 145"></a></aside></h3><p>Called after every config has refreshed, this proc handles data verification that depends on multiple entwined configurations.</p><h3 id="proc/DebugName"><aside class="declaration">proc </aside>DebugName<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L158"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 158"></a></aside></h3><p>Gets the name used for debug purposes</p><h3 id="proc/Generate"><aside class="declaration">proc </aside>Generate<aside>(color_string, /icon/last_external_icon)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L240"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 240"></a></aside></h3><p>Actually create the icon and color it in, handles caching</p><h3 id="proc/GenerateBundle"><aside class="declaration">proc </aside>GenerateBundle<aside>(/list/colors, /list/render_steps, /icon/last_external_icon)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L253"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 253"></a></aside></h3><p>Handles the actual icon manipulation to create the spritesheet</p><h3 id="proc/GenerateBundleUniversalIcon"><aside class="declaration">proc </aside>GenerateBundleUniversalIcon<aside>(/list/colors, target_bundle_state, /<a href="datum.html">datum</a>/<a href="datum/universal_icon.html">universal_icon</a>/last_external_icon)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L321"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 321"></a></aside></h3><p>Handles the actual icon manipulation to create the spritesheet</p><h3 id="proc/GenerateLayerGroup"><aside class="declaration">proc </aside>GenerateLayerGroup<aside>(/list/colors, /list/group, /list/render_steps, /icon/last_external_icon)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L280"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 280"></a></aside></h3><p>Internal recursive proc to handle nested layer groups</p><h3 id="proc/GenerateLayerGroupUniversalIcon"><aside class="declaration">proc </aside>GenerateLayerGroupUniversalIcon<aside>(/list/colors, /list/group, /<a href="datum.html">datum</a>/<a href="datum/universal_icon.html">universal_icon</a>/last_external_icon)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L335"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 335"></a></aside></h3><p>Internal recursive proc to handle nested layer groups</p><h3 id="proc/ReadIconStateConfiguration"><aside class="declaration">proc </aside>ReadIconStateConfiguration<aside>(/list/data)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L163"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 163"></a></aside></h3><p>Takes the json icon state configuration and puts it into a more processed format.</p><h3 id="proc/ReadLayersFromJson"><aside class="declaration">proc </aside>ReadLayersFromJson<aside>(/list/data)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L175"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 175"></a></aside></h3><p>Takes the json layers configuration and puts it into a more processed format</p><h3 id="proc/ReadMetadata"><aside class="declaration">proc </aside>ReadMetadata<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L193"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 193"></a></aside></h3><p>Reads layer configurations to take out some useful overall information</p><h3 id="proc/Refresh"><aside class="declaration">proc </aside>Refresh<aside>(loadFromDisk)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L106"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 106"></a></aside></h3><p>Call this proc to handle all the data extraction from the json configuration. Can be forced to load values from disk instead of memory.</p><h3 id="proc/SaveOutput"><aside class="declaration">proc </aside>SaveOutput<aside>(color_string)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/greyscale/_greyscale_config.dm#L235"><img src="git.png" width="16" height="16" title="code/datums/greyscale/_greyscale_config.dm 235"></a></aside></h3><p>For saving a dmi to disk, useful for debug mainly</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>