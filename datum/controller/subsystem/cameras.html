<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/controller/subsystem/cameras - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/controller/subsystem/cameras.html#var">Var Details</a> - <a href="datum/controller/subsystem/cameras.html#proc">Proc Details</a></header><main><h1>cameras <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/cameras.html">cameras</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L2"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 2"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#var/cameras">cameras</a></th><td>The cameras on the map, no matter if they work or not.
Updated in obj/machinery/camera.dm in Initialize() and Destroy().</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#var/chunks">chunks</a></th><td>The chunks of the map, mapping the areas that the cameras can see.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#var/chunks_to_update">chunks_to_update</a></th><td>Chunks that must be updated</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#var/current_run">current_run</a></th><td>Tracks current subsystem run</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#var/disable_camera_updates">disable_camera_updates</a></th><td>Primarily for debugging, outright prevents all camera chunk updates</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#var/obscured_images">obscured_images</a></th><td>List of images cloned by all chunk static images put onto turfs cameras cant see
Indexed by the plane offset to use</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/add_camera_to_chunk">add_camera_to_chunk</a></th><td>Add a camera to a chunk.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/bare_major_chunk_change">bare_major_chunk_change</a></th><td>A faster, turf only version of <a href="datum/controller/subsystem/cameras.html#proc/major_chunk_change" title="/datum/controller/subsystem/cameras">/datum/controller/subsystem/cameras/proc/major_chunk_change</a>
For use in sensitive code, be careful with it</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/camera_moved">camera_moved</a></th><td>Used to update cameras that are movin, since most everything in the game can.
update_delay_buffer is passed to allow variable update delays. useful so one
camera'd guy moving doesn't absolutely spam updates to watching ais (laggin the server)</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/get_available_camera_by_tag_list">get_available_camera_by_tag_list</a></th><td>get_available_camera_by_tag_list</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/get_available_cameras_data">get_available_cameras_data</a></th><td>Returns list of available cameras, ready to use for UIs displaying list of them
The format is: list(&quot;name&quot; = &quot;camera.c_tag&quot;, ref = REF(camera))</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/get_camera_chunk">get_camera_chunk</a></th><td>Checks if a chunk has been generated in x, y, z.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/get_filtered_and_sorted_cameras">get_filtered_and_sorted_cameras</a></th><td>Returns list of all cameras that passed <code>is_camera_available</code> filter and sorted by <code>cmp_camera_ctag_asc</code></td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/get_turf_camera_chunk">get_turf_camera_chunk</a></th><td>Gets the camera chunk the passed turf is in.
Returns the chunk if it exists and is visible, null otherwise.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/is_camera_available">is_camera_available</a></th><td>Checks if the <code>camera_to_check</code> meets the requirements of availability.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/is_visible_by_cameras">is_visible_by_cameras</a></th><td>Will check if an atom is on a viewable turf.
Returns TRUE if the atom is visible by any camera, FALSE otherwise.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/major_chunk_change">major_chunk_change</a></th><td>Never access this proc directly!!!!
This will update the chunk and all the surrounding chunks.
It will also add the atom to the cameras list if you set the choice to 1.
Setting the choice to 0 will remove the camera from the chunks.
If you want to update the chunks around an object, without adding/removing a camera, use choice 2.
update_delay_buffer is passed all the way to queue_update() from portable camera updates on movement
to change the time between static updates.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/remove_camera_from_chunk">remove_camera_from_chunk</a></th><td>Removes a camera from a chunk.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/turf_visible_by_cameras">turf_visible_by_cameras</a></th><td>Checks if the passed turf is visible by any camera.
Returns TRUE if the turf is visible by any camera, FALSE otherwise.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/update_eye_chunk">update_eye_chunk</a></th><td>Updates what the camera eye can see.
It is recommended you use this when a camera eye moves or its location is set.</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/update_offsets">update_offsets</a></th><td>Updates the images for new plane offsets</td></tr><tr><th><a href="datum/controller/subsystem/cameras.html#proc/update_visibility">update_visibility</a></th><td>Updates the chunks that the turf is located in. Use this when obstacles are destroyed or when doors open.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/cameras"><aside class="declaration">var </aside>cameras <aside>– /list/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/camera.html">camera</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L15"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 15"></a></h3><p>The cameras on the map, no matter if they work or not.
Updated in obj/machinery/camera.dm in Initialize() and Destroy().</p><h3 id="var/chunks"><aside class="declaration">var </aside>chunks <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L17"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 17"></a></h3><p>The chunks of the map, mapping the areas that the cameras can see.</p><h3 id="var/chunks_to_update"><aside class="declaration">var </aside>chunks_to_update <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L19"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 19"></a></h3><p>Chunks that must be updated</p><h3 id="var/current_run"><aside class="declaration">var </aside>current_run <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L26"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 26"></a></h3><p>Tracks current subsystem run</p><h3 id="var/disable_camera_updates"><aside class="declaration">var </aside>disable_camera_updates <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L24"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 24"></a></h3><p>Primarily for debugging, outright prevents all camera chunk updates</p><h3 id="var/obscured_images"><aside class="declaration">var </aside>obscured_images <aside>– /list/<a href="image.html">image</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L22"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 22"></a></h3><p>List of images cloned by all chunk static images put onto turfs cameras cant see
Indexed by the plane offset to use</p><h2 id="proc">Proc Details</h2><h3 id="proc/add_camera_to_chunk"><aside class="declaration">proc </aside>add_camera_to_chunk<aside>(/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/camera.html">camera</a>/new_cam)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L129"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 129"></a></aside></h3><p>Add a camera to a chunk.</p><h3 id="proc/bare_major_chunk_change"><aside class="declaration">proc </aside>bare_major_chunk_change<aside>(/<a href="turf.html">turf</a>/changed)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L223"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 223"></a></aside></h3><p>A faster, turf only version of <a href="datum/controller/subsystem/cameras.html#proc/major_chunk_change" title="/datum/controller/subsystem/cameras">/datum/controller/subsystem/cameras/proc/major_chunk_change</a>
For use in sensitive code, be careful with it</p><h3 id="proc/camera_moved"><aside class="declaration">proc </aside>camera_moved<aside>(/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/camera.html">camera</a>/updating_camera, /<a href="turf.html">turf</a>/old_turf, /<a href="turf.html">turf</a>/new_turf, update_delay_buffer)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L138"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 138"></a></aside></h3><p>Used to update cameras that are movin, since most everything in the game can.
update_delay_buffer is passed to allow variable update delays. useful so one
camera'd guy moving doesn't absolutely spam updates to watching ais (laggin the server)</p><h3 id="proc/get_available_camera_by_tag_list"><aside class="declaration">proc </aside>get_available_camera_by_tag_list<aside>(/list/networks_available, /list/z_levels_available)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L287"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 287"></a></aside></h3><p>get_available_camera_by_tag_list</p>
<p>Builds a list of all available cameras that can be seen to networks_available and in z_levels_available.
Entries are stored in <code>c_tag[camera.can_use() ? null : &quot; (Deactivated)&quot;]</code> =&gt; <code>camera</code> format
Args:
networks_available - List of networks that we use to see which cameras are visible to it.
z_levels_available - List of z levels to filter camera by. If empty, all z levels are considered valid.
sort_by_ctag - If the resulting list should be sorted by <code>c_tag</code>.</p><h3 id="proc/get_available_cameras_data"><aside class="declaration">proc </aside>get_available_cameras_data<aside>(/list/networks_available, /list/z_levels_available)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L267"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 267"></a></aside></h3><p>Returns list of available cameras, ready to use for UIs displaying list of them
The format is: list(&quot;name&quot; = &quot;camera.c_tag&quot;, ref = REF(camera))</p><h3 id="proc/get_camera_chunk"><aside class="declaration">proc </aside>get_camera_chunk<aside>(x, y, z)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L64"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 64"></a></aside></h3><p>Checks if a chunk has been generated in x, y, z.</p><h3 id="proc/get_filtered_and_sorted_cameras"><aside class="declaration">proc </aside>get_filtered_and_sorted_cameras<aside>(/list/networks_available, /list/z_levels_available)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L295"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 295"></a></aside></h3><p>Returns list of all cameras that passed <code>is_camera_available</code> filter and sorted by <code>cmp_camera_ctag_asc</code></p><h3 id="proc/get_turf_camera_chunk"><aside class="declaration">proc </aside>get_turf_camera_chunk<aside>(/<a href="turf.html">turf</a>/position) <span class="as"> as </span>/<a href="datum.html">datum</a>/<a href="datum/camerachunk.html">camerachunk</a> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L255"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 255"></a></aside></h3><p>Gets the camera chunk the passed turf is in.
Returns the chunk if it exists and is visible, null otherwise.</p><h3 id="proc/is_camera_available"><aside class="declaration">proc </aside>is_camera_available<aside>(/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/camera.html">camera</a>/camera_to_check, /list/networks_available, /list/z_levels_available)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L308"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 308"></a></aside></h3><p>Checks if the <code>camera_to_check</code> meets the requirements of availability.</p><h3 id="proc/is_visible_by_cameras"><aside class="declaration">proc </aside>is_visible_by_cameras<aside>(/<a href="atom.html">atom</a>/target)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L236"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 236"></a></aside></h3><p>Will check if an atom is on a viewable turf.
Returns TRUE if the atom is visible by any camera, FALSE otherwise.</p><h3 id="proc/major_chunk_change"><aside class="declaration">proc </aside>major_chunk_change<aside>(/<a href="atom.html">atom</a>/center_or_camera, choice, update_delay_buffer)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L193"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 193"></a></aside></h3><p>Never access this proc directly!!!!
This will update the chunk and all the surrounding chunks.
It will also add the atom to the cameras list if you set the choice to 1.
Setting the choice to 0 will remove the camera from the chunks.
If you want to update the chunks around an object, without adding/removing a camera, use choice 2.
update_delay_buffer is passed all the way to queue_update() from portable camera updates on movement
to change the time between static updates.</p><h3 id="proc/remove_camera_from_chunk"><aside class="declaration">proc </aside>remove_camera_from_chunk<aside>(/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/camera.html">camera</a>/old_cam)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L125"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 125"></a></aside></h3><p>Removes a camera from a chunk.</p><h3 id="proc/turf_visible_by_cameras"><aside class="declaration">proc </aside>turf_visible_by_cameras<aside>(/<a href="turf.html">turf</a>/position)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L241"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 241"></a></aside></h3><p>Checks if the passed turf is visible by any camera.
Returns TRUE if the turf is visible by any camera, FALSE otherwise.</p><h3 id="proc/update_eye_chunk"><aside class="declaration">proc </aside>update_eye_chunk<aside>(/<a href="mob.html">mob</a>/<a href="mob/eye.html">eye</a>/<a href="mob/eye/camera.html">camera</a>/eye)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L87"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 87"></a></aside></h3><p>Updates what the camera eye can see.
It is recommended you use this when a camera eye moves or its location is set.</p><h3 id="proc/update_offsets"><aside class="declaration">proc </aside>update_offsets<aside>(new_offset)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L51"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 51"></a></aside></h3><p>Updates the images for new plane offsets</p><h3 id="proc/update_visibility"><aside class="declaration">proc </aside>update_visibility<aside>(/<a href="atom.html">atom</a>/relevant_atom)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/controllers/subsystem/cameras.dm#L119"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/cameras.dm 119"></a></aside></h3><p>Updates the chunks that the turf is located in. Use this when obstacles are destroyed or when doors open.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>