<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/vote - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/vote.html#var">Var Details</a> - <a href="datum/vote.html#proc">Proc Details</a></header><main><h1>Vote Singleton <aside>/<a href="datum.html">datum</a>/<a href="datum/vote.html">vote</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L7"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 7"></a></h1><p>A singleton datum that represents a type of vote for the voting subsystem.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/vote.html#var/choices">choices</a></th><td>An assoc list of [all choices] to [number of votes in the current running vote].</td></tr><tr><th><a href="datum/vote.html#var/choices_by_ckey">choices_by_ckey</a></th><td>A assoc list of [ckey] to [what they voted for in the current running vote].</td></tr><tr><th><a href="datum/vote.html#var/contains_vote_in_name">contains_vote_in_name</a></th><td>Does the name of this vote contain the word &quot;vote&quot;?</td></tr><tr><th><a href="datum/vote.html#var/count_method">count_method</a></th><td>The counting method we use for votes.</td></tr><tr><th><a href="datum/vote.html#var/default_choices">default_choices</a></th><td>A list of default choices we have for this vote.</td></tr><tr><th><a href="datum/vote.html#var/default_message">default_message</a></th><td>What message do we show as the tooltip of this vote if the vote can be initiated?</td></tr><tr><th><a href="datum/vote.html#var/display_statistics">display_statistics</a></th><td>Should we show details about the number of votes submitted for each option?</td></tr><tr><th><a href="datum/vote.html#var/name">name</a></th><td>The name of the vote.</td></tr><tr><th><a href="datum/vote.html#var/override_question">override_question</a></th><td>If supplied, an override question will be displayed instead of the name of the vote.</td></tr><tr><th><a href="datum/vote.html#var/started_time">started_time</a></th><td>The world time this vote was started.</td></tr><tr><th><a href="datum/vote.html#var/time_remaining">time_remaining</a></th><td>The time remaining in this vote's run.</td></tr><tr><th><a href="datum/vote.html#var/vote_sound">vote_sound</a></th><td>The sound effect played to everyone when this vote is initiated.</td></tr><tr><th><a href="datum/vote.html#var/winner_method">winner_method</a></th><td>The method for selecting a winner.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/vote.html#proc/can_be_initiated">can_be_initiated</a></th><td>Checks if the passed mob can initiate this vote.</td></tr><tr><th><a href="datum/vote.html#proc/create_vote">create_vote</a></th><td>Called prior to the vote being initiated.</td></tr><tr><th><a href="datum/vote.html#proc/finalize_vote">finalize_vote</a></th><td>Called when a vote is actually all said and done.
Apply actual vote effects here.</td></tr><tr><th><a href="datum/vote.html#proc/get_random_winner">get_random_winner</a></th><td>Gets the winner of the vote, selecting a random choice from all choices based on their vote count.</td></tr><tr><th><a href="datum/vote.html#proc/get_result_text">get_result_text</a></th><td>Gets the resulting text displayed when the vote is completed.</td></tr><tr><th><a href="datum/vote.html#proc/get_simple_winner">get_simple_winner</a></th><td>Gets the winner of the vote, selecting the choice with the most votes.</td></tr><tr><th><a href="datum/vote.html#proc/get_vote_result">get_vote_result</a></th><td>Gets the result of the vote.</td></tr><tr><th><a href="datum/vote.html#proc/get_winner_text">get_winner_text</a></th><td>Gets the text that displays the winning options within the result text.</td></tr><tr><th><a href="datum/vote.html#proc/initiate_vote">initiate_vote</a></th><td>Called when this vote is actually initiated.</td></tr><tr><th><a href="datum/vote.html#proc/is_accessible_vote">is_accessible_vote</a></th><td>Used to determine if this vote is a possible
vote type for the vote subsystem.</td></tr><tr><th><a href="datum/vote.html#proc/is_config_enabled">is_config_enabled</a></th><td>If this vote has a config associated, returns its value (True or False, usually).
If it has no config, returns -1.</td></tr><tr><th><a href="datum/vote.html#proc/reset">reset</a></th><td>Resets our vote to its default state.</td></tr><tr><th><a href="datum/vote.html#proc/tiebreaker">tiebreaker</a></th><td>How this vote handles a tiebreaker between multiple winners.</td></tr><tr><th><a href="datum/vote.html#proc/toggle_votable">toggle_votable</a></th><td>If this vote has a config associated, toggles it between enabled and disabled.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/choices"><aside class="declaration">var </aside>choices <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L30"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 30"></a></h3><p>An assoc list of [all choices] to [number of votes in the current running vote].</p><h3 id="var/choices_by_ckey"><aside class="declaration">var </aside>choices_by_ckey <aside>– /final/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L32"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 32"></a></h3><p>A assoc list of [ckey] to [what they voted for in the current running vote].</p><h3 id="var/contains_vote_in_name"><aside class="declaration">var </aside>contains_vote_in_name <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L17"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 17"></a></h3><p>Does the name of this vote contain the word &quot;vote&quot;?</p><h3 id="var/count_method"><aside class="declaration">var </aside>count_method <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L21"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 21"></a></h3><p>The counting method we use for votes.</p><h3 id="var/default_choices"><aside class="declaration">var </aside>default_choices <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L15"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 15"></a></h3><p>A list of default choices we have for this vote.</p><h3 id="var/default_message"><aside class="declaration">var </aside>default_message <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L19"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 19"></a></h3><p>What message do we show as the tooltip of this vote if the vote can be initiated?</p><h3 id="var/display_statistics"><aside class="declaration">var </aside>display_statistics <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L25"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 25"></a></h3><p>Should we show details about the number of votes submitted for each option?</p><h3 id="var/name"><aside class="declaration">var </aside>name <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L9"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 9"></a></h3><p>The name of the vote.</p><h3 id="var/override_question"><aside class="declaration">var </aside>override_question <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L11"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 11"></a></h3><p>If supplied, an override question will be displayed instead of the name of the vote.</p><h3 id="var/started_time"><aside class="declaration">var </aside>started_time <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L34"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 34"></a></h3><p>The world time this vote was started.</p><h3 id="var/time_remaining"><aside class="declaration">var </aside>time_remaining <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L36"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 36"></a></h3><p>The time remaining in this vote's run.</p><h3 id="var/vote_sound"><aside class="declaration">var </aside>vote_sound <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L13"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 13"></a></h3><p>The sound effect played to everyone when this vote is initiated.</p><h3 id="var/winner_method"><aside class="declaration">var </aside>winner_method <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L23"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 23"></a></h3><p>The method for selecting a winner.</p><h2 id="proc">Proc Details</h2><h3 id="proc/can_be_initiated"><aside class="declaration">proc </aside>can_be_initiated<aside>(forced)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L81"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 81"></a></aside></h3><p>Checks if the passed mob can initiate this vote.</p>
<ul>
<li>forced - if being invoked by someone who is an admin</li>
</ul>
<p>Return VOTE_AVAILABLE if the mob can initiate the vote.
Return a string with the reason why the mob can't initiate the vote.</p><h3 id="proc/create_vote"><aside class="declaration">proc </aside>create_vote<aside>(/<a href="mob.html">mob</a>/vote_creator)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L94"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 94"></a></aside></h3><p>Called prior to the vote being initiated.</p>
<p>Return FALSE to prevent the vote from being initiated.</p><h3 id="proc/finalize_vote"><aside class="declaration">proc </aside>finalize_vote<aside>(winning_option)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L250"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 250"></a></aside></h3><p>Called when a vote is actually all said and done.
Apply actual vote effects here.</p><h3 id="proc/get_random_winner"><aside class="declaration">proc </aside>get_random_winner<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L159"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 159"></a></aside></h3><p>Gets the winner of the vote, selecting a random choice from all choices based on their vote count.</p><h3 id="proc/get_result_text"><aside class="declaration">proc </aside>get_result_text<aside>(/list/all_winners, real_winner, /list/non_voters)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L172"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 172"></a></aside></h3><p>Gets the resulting text displayed when the vote is completed.</p>
<p>all_winners - list of all options that won. Can be multiple, in the event of ties.
real_winner - the option that actually won.
non_voters - a list of all ckeys who didn't vote in the vote.</p>
<p>Return a formatted string of text to be displayed to everyone.</p><h3 id="proc/get_simple_winner"><aside class="declaration">proc </aside>get_simple_winner<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L141"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 141"></a></aside></h3><p>Gets the winner of the vote, selecting the choice with the most votes.</p><h3 id="proc/get_vote_result"><aside class="declaration">proc </aside>get_vote_result<aside>(/list/non_voters) <span class="as"> as </span>/list <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L125"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 125"></a></aside></h3><p>Gets the result of the vote.</p>
<p>non_voters - a list of all ckeys who didn't vote in the vote.</p>
<p>Returns a list of all options that won.
If there were no votes at all, the list will be length = 0, non-null.
If only one option one, the list will be length = 1.
If there was a tie, the list will be length &gt; 1.</p><h3 id="proc/get_winner_text"><aside class="declaration">proc </aside>get_winner_text<aside>(/list/all_winners, real_winner, /list/non_voters)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L230"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 230"></a></aside></h3><p>Gets the text that displays the winning options within the result text.</p>
<p>all_winners - list of all options that won. Can be multiple, in the event of ties.
real_winner - the option that actually won.
non_voters - a list of all ckeys who didn't vote in the vote.</p>
<p>Return a formatted string of text to be displayed to everyone.</p><h3 id="proc/initiate_vote"><aside class="declaration">proc </aside>initiate_vote<aside>(initiator, duration)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L107"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 107"></a></aside></h3><p>Called when this vote is actually initiated.</p>
<p>Return a string - the text displayed to the world when the vote is initiated.</p><h3 id="proc/is_accessible_vote"><aside class="declaration">proc </aside>is_accessible_vote<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L46"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 46"></a></aside></h3><p>Used to determine if this vote is a possible
vote type for the vote subsystem.</p>
<p>If FALSE is returned, this vote singleton
will not be created when the vote subsystem initializes,
meaning no one will be able to hold this vote.</p><h3 id="proc/is_config_enabled"><aside class="declaration">proc </aside>is_config_enabled<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L70"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 70"></a></aside></h3><p>If this vote has a config associated, returns its value (True or False, usually).
If it has no config, returns -1.</p><h3 id="proc/reset"><aside class="declaration">proc </aside>reset<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L52"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 52"></a></aside></h3><p>Resets our vote to its default state.</p><h3 id="proc/tiebreaker"><aside class="declaration">proc </aside>tiebreaker<aside>(/list/winners)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L243"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 243"></a></aside></h3><p>How this vote handles a tiebreaker between multiple winners.</p><h3 id="proc/toggle_votable"><aside class="declaration">proc </aside>toggle_votable<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/datums/votes/_vote_datum.dm#L63"><img src="git.png" width="16" height="16" title="code/datums/votes/_vote_datum.dm 63"></a></aside></h3><p>If this vote has a config associated, toggles it between enabled and disabled.</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>