<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/spy_bounty - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/spy_bounty.html#var">Var Details</a> - <a href="datum/spy_bounty.html#proc">Proc Details</a></header><main><h1>spy_bounty <aside>/<a href="datum.html">datum</a>/<a href="datum/spy_bounty.html">spy_bounty</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L9"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 9"></a></h1><h2 id="spy-bounty">Spy Bounty</h2>
<p>A datum used to track a single spy bounty.
Not a singleton - whenever bounties are re-rolled, the entire list is deleted and new bounty datums are instantiated.</p>
<p>When bounties are completed, they are also not deleted, but instead marked as claimed.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/spy_bounty.html#var/black_market_prob">black_market_prob</a></th><td>Probability that the stolen item will be sent to the black market instead of destroyed.
Guaranteed if the item is indestructible.</td></tr><tr><th><a href="datum/spy_bounty.html#var/claimed">claimed</a></th><td>Whether the bounty has been completed.</td></tr><tr><th><a href="datum/spy_bounty.html#var/difficulty">difficulty</a></th><td>Difficult of the bounty, one of <a href="code/__DEFINES/antagonists.html#define/SPY_DIFFICULTY_EASY" title="SPY_DIFFICULTY_EASY">SPY_DIFFICULTY_EASY</a>, <a href="code/__DEFINES/antagonists.html#define/SPY_DIFFICULTY_MEDIUM" title="SPY_DIFFICULTY_MEDIUM">SPY_DIFFICULTY_MEDIUM</a>, <a href="code/__DEFINES/antagonists.html#define/SPY_DIFFICULTY_HARD" title="SPY_DIFFICULTY_HARD">SPY_DIFFICULTY_HARD</a>.
Must be set to one of the possible bounties to be picked.</td></tr><tr><th><a href="datum/spy_bounty.html#var/help">help</a></th><td>Help text for the bounty.
Should include additional information about the bounty to assist the spy in figuring out what to do.
Should be punctuated.
IE: &quot;Steal the captain's ID. It was last seen in the captain's office.&quot;</td></tr><tr><th><a href="datum/spy_bounty.html#var/initalized">initalized</a></th><td>Whether the bounty's been fully initialized. If this is not set, the bounty will be rerolled.</td></tr><tr><th><a href="datum/spy_bounty.html#var/loot_difficulty">loot_difficulty</a></th><td>What pool we picked the loot from.</td></tr><tr><th><a href="datum/spy_bounty.html#var/name">name</a></th><td>The name of the bounty.
Should be a short description without punctuation.
IE: &quot;Steal the captain's ID&quot;</td></tr><tr><th><a href="datum/spy_bounty.html#var/reward_item">reward_item</a></th><td>What uplink item the bounty will reward on completion.</td></tr><tr><th><a href="datum/spy_bounty.html#var/theft_time">theft_time</a></th><td>How long of a do-after must be completed by the Spy to turn in the bounty.</td></tr><tr><th><a href="datum/spy_bounty.html#var/weight">weight</a></th><td>Weight that the bounty will be selected.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/spy_bounty.html#proc/can_claim">can_claim</a></th><td>Check if the passed mob can claim this bounty.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/check_dupe">check_dupe</a></th><td>Checks if the passed dupe key is a duplicate of an previously claimed bounty.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/clean_up_stolen_item">clean_up_stolen_item</a></th><td>Called when the bounty is completed, to handle how the stolen item is &quot;stolen&quot;.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/clear_bounty">clear_bounty</a></th><td>Called when the bounty gets cleared after the end of a bounty period</td></tr><tr><th><a href="datum/spy_bounty.html#proc/finish_cleanup">finish_cleanup</a></th><td>Called when cleaning up a stolen atom that was NOT sent to the black market.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/get_dupe_protection_key">get_dupe_protection_key</a></th><td>What is this bounty's &quot;dupe protection key&quot;?
This is used to determine if a duplicate of this bounty has been rolled before / in the last refresh.
You can check if a bounty has been duped by accessing the handler's claimed_bounties_from_last_pool or all_claimed_bounty_types list.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/init_bounty">init_bounty</a></th><td>Initializes the bounty, setting up targets and etc.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/is_stealable">is_stealable</a></th><td>Checks if the passed movable is a valid target for this bounty.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/select_reward">select_reward</a></th><td>Selects what uplink item the bounty will reward on completion.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/send_to_black_market">send_to_black_market</a></th><td>Handles putting the passed movable up on the black market.</td></tr><tr><th><a href="datum/spy_bounty.html#proc/to_ui_data">to_ui_data</a></th><td>Helper that translates the bounty into UI data for TGUI</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/black_market_prob"><aside class="declaration">var </aside>black_market_prob <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L26"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 26"></a></h3><p>Probability that the stolen item will be sent to the black market instead of destroyed.
Guaranteed if the item is indestructible.</p><h3 id="var/claimed"><aside class="declaration">var </aside>claimed <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L33"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 33"></a></h3><p>Whether the bounty has been completed.</p><h3 id="var/difficulty"><aside class="declaration">var </aside>difficulty <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L21"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 21"></a></h3><p>Difficult of the bounty, one of <a href="code/__DEFINES/antagonists.html#define/SPY_DIFFICULTY_EASY" title="SPY_DIFFICULTY_EASY">SPY_DIFFICULTY_EASY</a>, <a href="code/__DEFINES/antagonists.html#define/SPY_DIFFICULTY_MEDIUM" title="SPY_DIFFICULTY_MEDIUM">SPY_DIFFICULTY_MEDIUM</a>, <a href="code/__DEFINES/antagonists.html#define/SPY_DIFFICULTY_HARD" title="SPY_DIFFICULTY_HARD">SPY_DIFFICULTY_HARD</a>.
Must be set to one of the possible bounties to be picked.</p><h3 id="var/help"><aside class="declaration">var </aside>help <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L18"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 18"></a></h3><p>Help text for the bounty.
Should include additional information about the bounty to assist the spy in figuring out what to do.
Should be punctuated.
IE: &quot;Steal the captain's ID. It was last seen in the captain's office.&quot;</p><h3 id="var/initalized"><aside class="declaration">var </aside>initalized <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L31"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 31"></a></h3><p>Whether the bounty's been fully initialized. If this is not set, the bounty will be rerolled.</p><h3 id="var/loot_difficulty"><aside class="declaration">var </aside>loot_difficulty <aside>– /final</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L35"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 35"></a></h3><p>What pool we picked the loot from.</p><h3 id="var/name"><aside class="declaration">var </aside>name <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L13"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 13"></a></h3><p>The name of the bounty.
Should be a short description without punctuation.
IE: &quot;Steal the captain's ID&quot;</p><h3 id="var/reward_item"><aside class="declaration">var </aside>reward_item <aside>– /final/<a href="datum.html">datum</a>/<a href="datum/uplink_item.html">uplink_item</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L37"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 37"></a></h3><p>What uplink item the bounty will reward on completion.</p><h3 id="var/theft_time"><aside class="declaration">var </aside>theft_time <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L23"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 23"></a></h3><p>How long of a do-after must be completed by the Spy to turn in the bounty.</p><h3 id="var/weight"><aside class="declaration">var </aside>weight <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L28"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 28"></a></h3><p>Weight that the bounty will be selected.</p><h2 id="proc">Proc Details</h2><h3 id="proc/can_claim"><aside class="declaration">proc </aside>can_claim<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L59"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 59"></a></aside></h3><p>Check if the passed mob can claim this bounty.</p><h3 id="proc/check_dupe"><aside class="declaration">proc </aside>check_dupe<aside>(/<a href="datum.html">datum</a>/<a href="datum/spy_bounty_handler.html">spy_bounty_handler</a>/handler, dupe_key, dupe_prob)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L150"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 150"></a></aside></h3><p>Checks if the passed dupe key is a duplicate of an previously claimed bounty.</p>
<ul>
<li>handler - The handler that is handling the bounty.</li>
<li>dupe_key - The key to check for dupes</li>
<li>dupe_prob - The probability of a dupe being allowed when checking all_claimed_bounty_types.
This allows you to have a chance that distant dupes allowed depending on how many times they've been done.</li>
</ul>
<p>Returns TRUE if the bounty is a dupe, FALSE if it is not.</p><h3 id="proc/clean_up_stolen_item"><aside class="declaration">proc </aside>clean_up_stolen_item<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/stealing, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/spy)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L165"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 165"></a></aside></h3><p>Called when the bounty is completed, to handle how the stolen item is &quot;stolen&quot;.</p>
<p>By default, stolen items are simply deleted.</p>
<ul>
<li>stealing - The item that was stolen.</li>
<li>spy - The spy that stole the item.</li>
</ul><h3 id="proc/clear_bounty"><aside class="declaration">proc </aside>clear_bounty<aside>(/<a href="datum.html">datum</a>/<a href="datum/spy_bounty_handler.html">spy_bounty_handler</a>/handler)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L107"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 107"></a></aside></h3><p>Called when the bounty gets cleared after the end of a bounty period</p>
<ul>
<li>handler - The bounty handler that is handling this bounty.</li>
</ul><h3 id="proc/finish_cleanup"><aside class="declaration">proc </aside>finish_cleanup<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/stealing)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L194"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 194"></a></aside></h3><p>Called when cleaning up a stolen atom that was NOT sent to the black market.</p>
<ul>
<li>stealing - The item that was stolen.</li>
</ul><h3 id="proc/get_dupe_protection_key"><aside class="declaration">proc </aside>get_dupe_protection_key<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/stealing)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L137"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 137"></a></aside></h3><p>What is this bounty's &quot;dupe protection key&quot;?
This is used to determine if a duplicate of this bounty has been rolled before / in the last refresh.
You can check if a bounty has been duped by accessing the handler's claimed_bounties_from_last_pool or all_claimed_bounty_types list.</p>
<ul>
<li>stealing - The item that was stolen.</li>
<li>handler - The handler that is handling the bounty.</li>
</ul>
<p>Return a string key, what this uses for dupe protection.</p><h3 id="proc/init_bounty"><aside class="declaration">proc </aside>init_bounty<aside>(/<a href="datum.html">datum</a>/<a href="datum/spy_bounty_handler.html">spy_bounty_handler</a>/handler)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L70"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 70"></a></aside></h3><p>Initializes the bounty, setting up targets and etc.</p>
<ul>
<li>handler - The bounty handler that is creating this bounty.</li>
</ul>
<p>Returning FALSE will cancel initialization and force it to reroll the bounty.</p><h3 id="proc/is_stealable"><aside class="declaration">proc </aside>is_stealable<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/stealing)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L123"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 123"></a></aside></h3><p>Checks if the passed movable is a valid target for this bounty.</p>
<ul>
<li>stealing - The movable to check.</li>
</ul>
<p>Returning FALSE simply means that the passed movable is not valid for this bounty.</p><h3 id="proc/select_reward"><aside class="declaration">proc </aside>select_reward<aside>(/<a href="datum.html">datum</a>/<a href="datum/spy_bounty_handler.html">spy_bounty_handler</a>/handler)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L74"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 74"></a></aside></h3><p>Selects what uplink item the bounty will reward on completion.</p><h3 id="proc/send_to_black_market"><aside class="declaration">proc </aside>send_to_black_market<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/thing, had_attack_hand_interaction, was_anchored)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L204"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 204"></a></aside></h3><p>Handles putting the passed movable up on the black market.</p>
<p>By the end of this proc, the item should either be deleted (if failure) or in nullspace (on the black market).</p>
<ul>
<li>thing - The item to put up on the black market.</li>
</ul><h3 id="proc/to_ui_data"><aside class="declaration">proc </aside>to_ui_data<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty.dm#L47"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty.dm 47"></a></aside></h3><p>Helper that translates the bounty into UI data for TGUI</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>