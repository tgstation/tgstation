<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/spy_bounty_handler - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/spy_bounty_handler.html#var">Var Details</a> - <a href="datum/spy_bounty_handler.html#proc">Proc Details</a></header><main><h1>spy_bounty_handler <aside>/<a href="datum.html">datum</a>/<a href="datum/spy_bounty_handler.html">spy_bounty_handler</a></aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L53"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 53"></a></h1><h2 id="spy-bounty-handler">Spy bounty handler</h2>
<p>Singleton datum that handles determining active bounties for spies.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/all_claimed_bounty_types">all_claimed_bounty_types</a></th><td>Assoc list of items stolen in the past to how many times they have been stolen
Sometimes item typepaths, sometimes REFs, in general just strings that represent stolen items</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/base_bounties_to_give">base_bounties_to_give</a></th><td>Assoc list that dictates how much of each bounty difficulty to give out at once.
Modified by the number of times we have refreshed bounties.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/bounties">bounties</a></th><td>Assoc list of all active bounties.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/bounty_types">bounty_types</a></th><td>Assoc list of all possible bounties for each difficulty, weighted.
This is static, no bounty types are removed from this list.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/claimed_bounties_from_last_pool">claimed_bounties_from_last_pool</a></th><td>List of all items stolen in the last pool of bounties.
Same as above - strings that represent stolen items.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/num_attempts_override">num_attempts_override</a></th><td>When rolling for bounties, the number of attempts is calculated based on the number of bounties to give out.
This number will override that calculation with a set value - used for testing and debugging.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/num_refreshes">num_refreshes</a></th><td>Number of times we have refreshed bounties</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/possible_uplink_items">possible_uplink_items</a></th><td>Assoc list of all uplink items possible to be given as bounties for each difficulty.
This is not static, as bounties are complete uplink items will be removed from this list.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/refresh_time">refresh_time</a></th><td>Timer between when all bounties are refreshed.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#var/refresh_timer">refresh_timer</a></th><td>timerID of the active refresh timer.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/spy_bounty_handler.html#proc/force_refresh">force_refresh</a></th><td>Forces a refresh of the bounty list.
Counts towards [num_refreshes].</td></tr><tr><th><a href="datum/spy_bounty_handler.html#proc/get_all_bounties">get_all_bounties</a></th><td>Helper that returns a list of all active bounties in a single list, regardless of difficulty.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#proc/refresh_bounty_list">refresh_bounty_list</a></th><td>Refreshes all active bounties for each difficulty, no matter if they were complete or not.
Then recursively calls itself via a timer.</td></tr><tr><th><a href="datum/spy_bounty_handler.html#proc/try_add_to_loot_pool">try_add_to_loot_pool</a></th><td>Helper to attempt to add the passed uplink item datum to the possible bounty pool(s).</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/all_claimed_bounty_types"><aside class="declaration">var </aside>all_claimed_bounty_types <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L62"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 62"></a></h3><p>Assoc list of items stolen in the past to how many times they have been stolen
Sometimes item typepaths, sometimes REFs, in general just strings that represent stolen items</p><h3 id="var/base_bounties_to_give"><aside class="declaration">var </aside>base_bounties_to_give <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L72"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 72"></a></h3><p>Assoc list that dictates how much of each bounty difficulty to give out at once.
Modified by the number of times we have refreshed bounties.</p><h3 id="var/bounties"><aside class="declaration">var </aside>bounties <aside>– /list/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L79"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 79"></a></h3><p>Assoc list of all active bounties.</p><h3 id="var/bounty_types"><aside class="declaration">var </aside>bounty_types <aside>– /list/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L87"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 87"></a></h3><p>Assoc list of all possible bounties for each difficulty, weighted.
This is static, no bounty types are removed from this list.</p><h3 id="var/claimed_bounties_from_last_pool"><aside class="declaration">var </aside>claimed_bounties_from_last_pool <aside>– /list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L65"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 65"></a></h3><p>List of all items stolen in the last pool of bounties.
Same as above - strings that represent stolen items.</p><h3 id="var/num_attempts_override"><aside class="declaration">var </aside>num_attempts_override <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L68"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 68"></a></h3><p>When rolling for bounties, the number of attempts is calculated based on the number of bounties to give out.
This number will override that calculation with a set value - used for testing and debugging.</p><h3 id="var/num_refreshes"><aside class="declaration">var </aside>num_refreshes <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L59"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 59"></a></h3><p>Number of times we have refreshed bounties</p><h3 id="var/possible_uplink_items"><aside class="declaration">var </aside>possible_uplink_items <aside>– /list/list</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L95"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 95"></a></h3><p>Assoc list of all uplink items possible to be given as bounties for each difficulty.
This is not static, as bounties are complete uplink items will be removed from this list.</p><h3 id="var/refresh_time"><aside class="declaration">var </aside>refresh_time <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L55"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 55"></a></h3><p>Timer between when all bounties are refreshed.</p><h3 id="var/refresh_timer"><aside class="declaration">var </aside>refresh_timer <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L57"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 57"></a></h3><p>timerID of the active refresh timer.</p><h2 id="proc">Proc Details</h2><h3 id="proc/force_refresh"><aside class="declaration">proc </aside>force_refresh<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L200"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 200"></a></aside></h3><p>Forces a refresh of the bounty list.
Counts towards [num_refreshes].</p><h3 id="proc/get_all_bounties"><aside class="declaration">proc </aside>get_all_bounties<aside>() <span class="as"> as </span>/list <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L154"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 154"></a></aside></h3><p>Helper that returns a list of all active bounties in a single list, regardless of difficulty.</p><h3 id="proc/refresh_bounty_list"><aside class="declaration">proc </aside>refresh_bounty_list<aside>()  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L163"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 163"></a></aside></h3><p>Refreshes all active bounties for each difficulty, no matter if they were complete or not.
Then recursively calls itself via a timer.</p><h3 id="proc/try_add_to_loot_pool"><aside class="declaration">proc </aside>try_add_to_loot_pool<aside>(/<a href="datum.html">datum</a>/<a href="datum/uplink_item.html">uplink_item</a>/item)  <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/modules/antagonists/spy/spy_bounty_handler.dm#L139"><img src="git.png" width="16" height="16" title="code/modules/antagonists/spy/spy_bounty_handler.dm 139"></a></aside></h3><p>Helper to attempt to add the passed uplink item datum to the possible bounty pool(s).</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>