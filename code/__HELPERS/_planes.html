<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>code/__HELPERS/_planes.dm - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="code/__HELPERS/_planes.html#define">Define Details</a></header><main><h1>code/__HELPERS/_planes.dm <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm"></a></h1><table class="summary" cellspacing="0"><tr><th><a href="code/__HELPERS/_planes.html#define/SET_PLANE">SET_PLANE</a></th><td>Takes an atom to change the plane of, a new plane value, and something that can be used as a reference to a z level as input
Modifies the new value to match the plane we actually want. Note, if you pass in an already offset plane the offsets will add up
Use PLANE_TO_TRUE() to avoid this</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/MUTATE_PLANE">MUTATE_PLANE</a></th><td>Takes a plane and a z reference, and offsets the plane by the mutation
The SSmapping.max_plane_offset bit here is technically redundant, but saves a bit of work in the base case
And the base case is important to me. Non multiz shouldn't get hit too bad by this code</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/GET_TURF_PLANE_OFFSET">GET_TURF_PLANE_OFFSET</a></th><td>Takes a z reference that we are unsure of, sanity checks it
Returns either its offset, or 0 if it's not a valid ref
Will return the reference's PLANE'S offset if we can't get anything out of the z level. We do our best</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/GET_Z_PLANE_OFFSET">GET_Z_PLANE_OFFSET</a></th><td>Essentially just an unsafe version of GET_TURF_PLANE_OFFSET()
Takes a z value we returns its offset with a list lookup
Will runtime during parts of init. Be careful :)</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/GET_NEW_PLANE">GET_NEW_PLANE</a></th><td>Takes a plane to offset, and the multiplier to use, and well, does the offsetting
Respects a blacklist we use to remove redundant plane masters, such as hud objects</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/SET_PLANE_W_SCALAR">SET_PLANE_W_SCALAR</a></th><td>Takes an object, new plane, and multiplier, and offsets the plane
This is for cases where you have a multiplier precalculated, and just want to use it
Often an optimization, sometimes a necessity</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/SET_PLANE_IMPLICIT">SET_PLANE_IMPLICIT</a></th><td>Implicit plane set. We take the turf from the object we're changing the plane of, and use ITS z as a spokesperson for our plane value</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/GET_LOWEST_STACK_OFFSET">GET_LOWEST_STACK_OFFSET</a></th><td>Takes a z level, gets the lowest plane offset in its &quot;stack&quot;</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/PLANE_TO_TRUE">PLANE_TO_TRUE</a></th><td>Takes a plane, returns the canonical, unoffset plane it represents</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/PLANE_TO_OFFSET">PLANE_TO_OFFSET</a></th><td>Takes a plane, returns the offset it uses</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/PLANE_IS_CRITICAL">PLANE_IS_CRITICAL</a></th><td>Takes a plane, returns TRUE if it is of critical priority, FALSE otherwise</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/TRUE_PLANE_TO_OFFSETS">TRUE_PLANE_TO_OFFSETS</a></th><td>Takes a true plane, returns the offset planes that would canonically represent it</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/OFFSET_RENDER_TARGET">OFFSET_RENDER_TARGET</a></th><td>Takes a render target and an offset, returns a canonical render target string for it</td></tr><tr><th><a href="code/__HELPERS/_planes.html#define/_OFFSET_RENDER_TARGET">_OFFSET_RENDER_TARGET</a></th><td>Helper macro for the above
Honestly just exists to make the pattern of render target strings more readable</td></tr><tr><th>/proc/<a href="global.html#proc/check_topdown_validity">check_topdown_validity</a></th><td>Checks if a passed in MA or atom is allowed to have its current plane/layer matchup</td></tr></table><h2 id="define">Define Details</h2><h3 id="define/GET_LOWEST_STACK_OFFSET"><aside class="declaration">#define </aside>GET_LOWEST_STACK_OFFSET<aside>(z)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L69"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 69"></a></h3><p>Takes a z level, gets the lowest plane offset in its &quot;stack&quot;</p><h3 id="define/GET_NEW_PLANE"><aside class="declaration">#define </aside>GET_NEW_PLANE<aside>(new_value, multiplier)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L28"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 28"></a></h3><p>Takes a plane to offset, and the multiplier to use, and well, does the offsetting
Respects a blacklist we use to remove redundant plane masters, such as hud objects</p><h3 id="define/GET_TURF_PLANE_OFFSET"><aside class="declaration">#define </aside>GET_TURF_PLANE_OFFSET<aside>(z_reference)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L20"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 20"></a></h3><p>Takes a z reference that we are unsure of, sanity checks it
Returns either its offset, or 0 if it's not a valid ref
Will return the reference's PLANE'S offset if we can't get anything out of the z level. We do our best</p><h3 id="define/GET_Z_PLANE_OFFSET"><aside class="declaration">#define </aside>GET_Z_PLANE_OFFSET<aside>(z)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L24"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 24"></a></h3><p>Essentially just an unsafe version of GET_TURF_PLANE_OFFSET()
Takes a z value we returns its offset with a list lookup
Will runtime during parts of init. Be careful :)</p><h3 id="define/MUTATE_PLANE"><aside class="declaration">#define </aside>MUTATE_PLANE<aside>(new_value, z_reference)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L15"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 15"></a></h3><p>Takes a plane and a z reference, and offsets the plane by the mutation
The SSmapping.max_plane_offset bit here is technically redundant, but saves a bit of work in the base case
And the base case is important to me. Non multiz shouldn't get hit too bad by this code</p><h3 id="define/OFFSET_RENDER_TARGET"><aside class="declaration">#define </aside>OFFSET_RENDER_TARGET<aside>(render_target, offset)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L79"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 79"></a></h3><p>Takes a render target and an offset, returns a canonical render target string for it</p><h3 id="define/PLANE_IS_CRITICAL"><aside class="declaration">#define </aside>PLANE_IS_CRITICAL<aside>(plane)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L75"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 75"></a></h3><p>Takes a plane, returns TRUE if it is of critical priority, FALSE otherwise</p><h3 id="define/PLANE_TO_OFFSET"><aside class="declaration">#define </aside>PLANE_TO_OFFSET<aside>(plane)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L73"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 73"></a></h3><p>Takes a plane, returns the offset it uses</p><h3 id="define/PLANE_TO_TRUE"><aside class="declaration">#define </aside>PLANE_TO_TRUE<aside>(plane)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L71"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 71"></a></h3><p>Takes a plane, returns the canonical, unoffset plane it represents</p><h3 id="define/SET_PLANE"><aside class="declaration">#define </aside>SET_PLANE<aside>(thing, new_value, z_reference)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L10"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 10"></a></h3><p>Takes an atom to change the plane of, a new plane value, and something that can be used as a reference to a z level as input
Modifies the new value to match the plane we actually want. Note, if you pass in an already offset plane the offsets will add up
Use PLANE_TO_TRUE() to avoid this</p><h3 id="define/SET_PLANE_IMPLICIT"><aside class="declaration">#define </aside>SET_PLANE_IMPLICIT<aside>(thing, new_value)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L39"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 39"></a></h3><p>Implicit plane set. We take the turf from the object we're changing the plane of, and use ITS z as a spokesperson for our plane value</p><h3 id="define/SET_PLANE_W_SCALAR"><aside class="declaration">#define </aside>SET_PLANE_W_SCALAR<aside>(thing, new_value, multiplier)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L35"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 35"></a></h3><p>Takes an object, new plane, and multiplier, and offsets the plane
This is for cases where you have a multiplier precalculated, and just want to use it
Often an optimization, sometimes a necessity</p><h3 id="define/TRUE_PLANE_TO_OFFSETS"><aside class="declaration">#define </aside>TRUE_PLANE_TO_OFFSETS<aside>(plane)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L77"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 77"></a></h3><p>Takes a true plane, returns the offset planes that would canonically represent it</p><h3 id="define/_OFFSET_RENDER_TARGET"><aside class="declaration">#define </aside>_OFFSET_RENDER_TARGET<aside>(render_target, offset)</aside> <a href="https://github.com/tgstation/tgstation/blob/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f/code/__HELPERS/_planes.dm#L82"><img src="git.png" width="16" height="16" title="code/__HELPERS/_planes.dm 82"></a></h3><p>Helper macro for the above
Honestly just exists to make the pattern of render target strings more readable</p></main><footer>tgstation.dme <a href="https://github.com/tgstation/tgstation/tree/cd8d3cfc6452876b3929e640c2fd6fdbfee7f93f">cd8d3cf</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>